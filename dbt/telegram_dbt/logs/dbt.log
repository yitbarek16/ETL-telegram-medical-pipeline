[0m17:45:59.685305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB3A46A0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB3A46A150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB3A8CBCE0>]}


============================== 17:45:59.703647 | e10f31d9-9d81-4e0c-8a9c-a94439e966f1 ==============================
[0m17:45:59.703647 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:45:59.704311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\user\\.dbt', 'log_path': 'C:\\Users\\user\\Desktop\\ETL-telegram-medical-pipeline\\dbt\\telegram_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:45:59.813429 [info ] [MainThread]: dbt version: 1.10.4
[0m17:45:59.813429 [info ] [MainThread]: python version: 3.12.4
[0m17:45:59.820089 [info ] [MainThread]: python path: C:\Users\user\anaconda3\python.exe
[0m17:45:59.822068 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m17:45:59.825073 [info ] [MainThread]: Using profiles dir at C:\Users\user\.dbt
[0m17:45:59.827073 [info ] [MainThread]: Using profiles.yml file at C:\Users\user\.dbt\profiles.yml
[0m17:45:59.834079 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\dbt_project.yml
[0m17:46:00.429580 [info ] [MainThread]: Configuration:
[0m17:46:00.429580 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m17:46:00.429580 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:46:00.429580 [info ] [MainThread]: Required dependencies:
[0m17:46:00.449831 [debug] [MainThread]: Executing "git --help"
[0m17:46:00.574683 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:46:00.576687 [debug] [MainThread]: STDERR: "b''"
[0m17:46:00.578304 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:46:00.581302 [info ] [MainThread]: Connection test skipped since no profile was found
[0m17:46:00.583302 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:46:00.586302 [info ] [MainThread]: dbt looked for a profiles.yml file in C:\Users\user\.dbt\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m17:46:00.595020 [debug] [MainThread]: Command `dbt debug` failed at 17:46:00.594007 after 1.47 seconds
[0m17:46:00.599021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB3A3A0080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB37A54DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB3AA44E60>]}
[0m17:46:00.602022 [debug] [MainThread]: Flushing usage events
[0m17:46:01.492493 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:47:50.060574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBE5253D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EC0B53D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EC0B532F0>]}


============================== 17:47:50.060574 | f32e8685-06a2-4bf6-bf84-f279e0b9f494 ==============================
[0m17:47:50.060574 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:47:50.071296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\user\\Desktop\\ETL-telegram-medical-pipeline\\dbt\\telegram_dbt\\logs', 'profiles_dir': 'C:\\Users\\user\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:47:50.128278 [info ] [MainThread]: dbt version: 1.10.4
[0m17:47:50.144826 [info ] [MainThread]: python version: 3.12.4
[0m17:47:50.144826 [info ] [MainThread]: python path: C:\Users\user\anaconda3\python.exe
[0m17:47:50.144826 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m17:47:50.154077 [info ] [MainThread]: Using profiles dir at C:\Users\user\.dbt
[0m17:47:50.156073 [info ] [MainThread]: Using profiles.yml file at C:\Users\user\.dbt\profiles.yml
[0m17:47:50.157136 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\dbt_project.yml
[0m17:47:50.513551 [info ] [MainThread]: Configuration:
[0m17:47:50.513551 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m17:47:50.513551 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:47:50.513551 [info ] [MainThread]: Required dependencies:
[0m17:47:50.513551 [debug] [MainThread]: Executing "git --help"
[0m17:47:50.586235 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:47:50.589235 [debug] [MainThread]: STDERR: "b''"
[0m17:47:50.591237 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:47:50.594236 [info ] [MainThread]: Connection test skipped since no profile was found
[0m17:47:50.597238 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:47:50.599237 [info ] [MainThread]: dbt looked for a profiles.yml file in C:\Users\user\.dbt\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m17:47:50.608183 [debug] [MainThread]: Command `dbt debug` failed at 17:47:50.607237 after 1.12 seconds
[0m17:47:50.610536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBE5253D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EC2791A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBFFCE570>]}
[0m17:47:50.612551 [debug] [MainThread]: Flushing usage events
[0m17:47:51.480783 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:50:00.487443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F488B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F59C8920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F59CAD50>]}


============================== 17:50:00.487443 | fa466b51-5ff3-4c6e-ae51-b7066d771a79 ==============================
[0m17:50:00.487443 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:50:00.503056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\user\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\user\\Desktop\\ETL-telegram-medical-pipeline\\dbt\\telegram_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:50:00.574671 [info ] [MainThread]: dbt version: 1.10.4
[0m17:50:00.574671 [info ] [MainThread]: python version: 3.12.4
[0m17:50:00.574671 [info ] [MainThread]: python path: C:\Users\user\anaconda3\python.exe
[0m17:50:00.592278 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m17:50:00.982594 [info ] [MainThread]: Using profiles dir at C:\Users\user\.dbt
[0m17:50:00.983596 [info ] [MainThread]: Using profiles.yml file at C:\Users\user\.dbt\profiles.yml
[0m17:50:00.985597 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\dbt_project.yml
[0m17:50:00.988594 [info ] [MainThread]: adapter type: postgres
[0m17:50:00.989597 [info ] [MainThread]: adapter version: 1.9.0
[0m17:50:01.323085 [info ] [MainThread]: Configuration:
[0m17:50:01.323085 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:50:01.323085 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:50:01.323085 [info ] [MainThread]: Required dependencies:
[0m17:50:01.335188 [debug] [MainThread]: Executing "git --help"
[0m17:50:01.411237 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:50:01.414235 [debug] [MainThread]: STDERR: "b''"
[0m17:50:01.416241 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:50:01.419242 [info ] [MainThread]: Connection:
[0m17:50:01.424289 [info ] [MainThread]:   host: localhost
[0m17:50:01.427976 [info ] [MainThread]:   port: 5432
[0m17:50:01.432049 [info ] [MainThread]:   user: postgres
[0m17:50:01.432049 [info ] [MainThread]:   database: telegram_db
[0m17:50:01.436616 [info ] [MainThread]:   schema: raw
[0m17:50:01.438616 [info ] [MainThread]:   connect_timeout: 10
[0m17:50:01.441616 [info ] [MainThread]:   role: None
[0m17:50:01.442667 [info ] [MainThread]:   search_path: None
[0m17:50:01.448734 [info ] [MainThread]:   keepalives_idle: 0
[0m17:50:01.451733 [info ] [MainThread]:   sslmode: None
[0m17:50:01.454995 [info ] [MainThread]:   sslcert: None
[0m17:50:01.457984 [info ] [MainThread]:   sslkey: None
[0m17:50:01.462803 [info ] [MainThread]:   sslrootcert: None
[0m17:50:01.464801 [info ] [MainThread]:   application_name: dbt
[0m17:50:01.466800 [info ] [MainThread]:   retries: 1
[0m17:50:01.470553 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:50:02.656125 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:50:03.348395 [debug] [MainThread]: Using postgres connection "debug"
[0m17:50:03.350398 [debug] [MainThread]: On debug: select 1 as id
[0m17:50:03.351435 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:03.658742 [debug] [MainThread]: SQL status: SELECT 1 in 0.307 seconds
[0m17:50:03.662740 [debug] [MainThread]: On debug: Close
[0m17:50:03.664749 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:50:03.666744 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:50:03.672742 [debug] [MainThread]: Command `dbt debug` succeeded at 17:50:03.672742 after 3.58 seconds
[0m17:50:03.673743 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:50:03.676743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F488B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F7018320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F5DB1430>]}
[0m17:50:03.678743 [debug] [MainThread]: Flushing usage events
[0m17:50:04.502205 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:54:37.668108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEE2848AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEE2A78BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEE284AA50>]}


============================== 17:54:37.678087 | 65214e29-7dba-45c3-b8f2-2e10a7d78eb8 ==============================
[0m17:54:37.678087 [info ] [MainThread]: Running with dbt=1.10.4
[0m17:54:37.681085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\user\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\user\\Desktop\\ETL-telegram-medical-pipeline\\dbt\\telegram_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_telegram_messages', 'send_anonymous_usage_stats': 'True'}
[0m17:54:40.525709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65214e29-7dba-45c3-b8f2-2e10a7d78eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEE2EA1190>]}
[0m17:54:40.727535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65214e29-7dba-45c3-b8f2-2e10a7d78eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEE2103740>]}
[0m17:54:40.730509 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:54:41.337091 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m17:54:41.337091 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:54:41.337091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '65214e29-7dba-45c3-b8f2-2e10a7d78eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEE42BBC80>]}
[0m17:54:44.945314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65214e29-7dba-45c3-b8f2-2e10a7d78eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEE46169F0>]}
[0m17:54:45.173118 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\manifest.json
[0m17:54:45.243023 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\semantic_manifest.json
[0m17:54:45.430233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65214e29-7dba-45c3-b8f2-2e10a7d78eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEE47EBAD0>]}
[0m17:54:45.446135 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m17:54:45.448138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65214e29-7dba-45c3-b8f2-2e10a7d78eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEE462F620>]}
[0m17:54:45.570456 [info ] [MainThread]: 
[0m17:54:45.580796 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:45.580796 [info ] [MainThread]: 
[0m17:54:45.580796 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:54:45.593551 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m17:54:46.097746 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m17:54:46.097746 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m17:54:46.097746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:46.734028 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.637 seconds
[0m17:54:46.749653 [debug] [ThreadPool]: On list_telegram_db: Close
[0m17:54:46.749653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db, now create_telegram_db_raw_staging)
[0m17:54:46.757887 [debug] [ThreadPool]: Creating schema "database: "telegram_db"
schema: "raw_staging"
"
[0m17:54:46.774038 [debug] [ThreadPool]: Using postgres connection "create_telegram_db_raw_staging"
[0m17:54:46.774038 [debug] [ThreadPool]: On create_telegram_db_raw_staging: BEGIN
[0m17:54:46.774038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:46.913825 [debug] [ThreadPool]: SQL status: BEGIN in 0.147 seconds
[0m17:54:46.913825 [debug] [ThreadPool]: Using postgres connection "create_telegram_db_raw_staging"
[0m17:54:46.913825 [debug] [ThreadPool]: On create_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "create_telegram_db_raw_staging"} */
create schema if not exists "raw_staging"
[0m17:54:46.966526 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.036 seconds
[0m17:54:46.971529 [debug] [ThreadPool]: On create_telegram_db_raw_staging: COMMIT
[0m17:54:46.972537 [debug] [ThreadPool]: Using postgres connection "create_telegram_db_raw_staging"
[0m17:54:46.973540 [debug] [ThreadPool]: On create_telegram_db_raw_staging: COMMIT
[0m17:54:46.980529 [debug] [ThreadPool]: SQL status: COMMIT in 0.004 seconds
[0m17:54:46.981534 [debug] [ThreadPool]: On create_telegram_db_raw_staging: Close
[0m17:54:46.987707 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_raw_staging'
[0m17:54:46.998492 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m17:54:46.998492 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m17:54:46.998492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:47.100558 [debug] [ThreadPool]: SQL status: BEGIN in 0.094 seconds
[0m17:54:47.101554 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m17:54:47.102557 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m17:54:47.193408 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.102 seconds
[0m17:54:47.209049 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m17:54:47.209049 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m17:54:47.224683 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:47.224683 [debug] [MainThread]: On master: BEGIN
[0m17:54:47.224683 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:47.358773 [debug] [MainThread]: SQL status: BEGIN in 0.126 seconds
[0m17:54:47.358773 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:47.358773 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:54:47.455295 [debug] [MainThread]: SQL status: SELECT 0 in 0.090 seconds
[0m17:54:47.461301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65214e29-7dba-45c3-b8f2-2e10a7d78eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEE4646F30>]}
[0m17:54:47.463295 [debug] [MainThread]: On master: ROLLBACK
[0m17:54:47.466299 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:47.467370 [debug] [MainThread]: On master: BEGIN
[0m17:54:47.467370 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:54:47.467370 [debug] [MainThread]: On master: COMMIT
[0m17:54:47.467370 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:47.467370 [debug] [MainThread]: On master: COMMIT
[0m17:54:47.467370 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:54:47.467370 [debug] [MainThread]: On master: Close
[0m17:54:47.483000 [debug] [Thread-1 (]: Began running node model.telegram_dbt.stg_telegram_messages
[0m17:54:47.483000 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_staging.stg_telegram_messages .................. [RUN]
[0m17:54:47.483000 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_dbt.stg_telegram_messages'
[0m17:54:47.498623 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.stg_telegram_messages
[0m17:54:47.519748 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.stg_telegram_messages"
[0m17:54:47.531232 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.stg_telegram_messages
[0m17:54:47.624817 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.stg_telegram_messages"
[0m17:54:47.676468 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m17:54:47.693569 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: BEGIN
[0m17:54:47.695211 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:54:47.905068 [debug] [Thread-1 (]: SQL status: BEGIN in 0.211 seconds
[0m17:54:47.905068 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m17:54:47.905068 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */

  create view "telegram_db"."raw_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    -- models/staging/stg_telegram_messages.sql

with source as (
    select * from "telegram_db"."raw"."telegram_messages"
),

renamed as (
    select
        id::bigint as message_id,
        channel::text as channel_name,
        date::timestamp as message_date,
        message::text as message_text,
        has_media::boolean,
        media_type::text,
        image_path::text
    from source
)

select * from renamed
  );
[0m17:54:48.082671 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.171 seconds
[0m17:54:48.103605 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m17:54:48.104603 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */
alter table "telegram_db"."raw_staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m17:54:48.248271 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.150 seconds
[0m17:54:48.279527 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: COMMIT
[0m17:54:48.279527 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m17:54:48.279527 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: COMMIT
[0m17:54:48.402610 [debug] [Thread-1 (]: SQL status: COMMIT in 0.113 seconds
[0m17:54:48.428744 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_staging"."stg_telegram_messages__dbt_backup"
[0m17:54:48.450213 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m17:54:48.452213 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */
drop view if exists "telegram_db"."raw_staging"."stg_telegram_messages__dbt_backup" cascade
[0m17:54:48.543993 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.089 seconds
[0m17:54:48.550991 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: Close
[0m17:54:48.558995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65214e29-7dba-45c3-b8f2-2e10a7d78eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEE21E2C00>]}
[0m17:54:48.560997 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw_staging.stg_telegram_messages ............. [[32mCREATE VIEW[0m in 1.07s]
[0m17:54:48.564213 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.stg_telegram_messages
[0m17:54:48.567212 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:48.568246 [debug] [MainThread]: On master: BEGIN
[0m17:54:48.569215 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:48.684011 [debug] [MainThread]: SQL status: BEGIN in 0.115 seconds
[0m17:54:48.685039 [debug] [MainThread]: On master: COMMIT
[0m17:54:48.686039 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:48.687013 [debug] [MainThread]: On master: COMMIT
[0m17:54:48.689014 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:54:48.690039 [debug] [MainThread]: On master: Close
[0m17:54:48.691013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:48.694390 [debug] [MainThread]: Connection 'create_telegram_db_raw_staging' was properly closed.
[0m17:54:48.695400 [debug] [MainThread]: Connection 'list_telegram_db_raw_staging' was properly closed.
[0m17:54:48.696395 [debug] [MainThread]: Connection 'model.telegram_dbt.stg_telegram_messages' was properly closed.
[0m17:54:48.698391 [info ] [MainThread]: 
[0m17:54:48.699392 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.12 seconds (3.12s).
[0m17:54:48.702391 [debug] [MainThread]: Command end result
[0m17:54:48.746423 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\manifest.json
[0m17:54:48.761344 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\semantic_manifest.json
[0m17:54:48.761344 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\run_results.json
[0m17:54:48.777145 [info ] [MainThread]: 
[0m17:54:48.778144 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:48.780145 [info ] [MainThread]: 
[0m17:54:48.781144 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:54:48.785148 [debug] [MainThread]: Command `dbt run` succeeded at 17:54:48.785148 after 11.46 seconds
[0m17:54:48.786145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEE2195BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEE42DE000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEE47A9AC0>]}
[0m17:54:48.787146 [debug] [MainThread]: Flushing usage events
[0m17:54:49.630340 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:00:05.497541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002769D42A8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A10AE1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A11E19A0>]}


============================== 18:00:05.497541 | 7161c104-40e7-4991-a579-98c590e306b5 ==============================
[0m18:00:05.497541 [info ] [MainThread]: Running with dbt=1.10.4
[0m18:00:05.513330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\user\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\user\\Desktop\\ETL-telegram-medical-pipeline\\dbt\\telegram_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select dim_channels dim_dates fct_messages', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:00:06.187706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7161c104-40e7-4991-a579-98c590e306b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A1905E50>]}
[0m18:00:06.373488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7161c104-40e7-4991-a579-98c590e306b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002769E7FC290>]}
[0m18:00:06.383254 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:00:06.954746 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m18:00:07.436597 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:00:07.436597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7161c104-40e7-4991-a579-98c590e306b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A12A8470>]}
[0m18:00:10.147031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7161c104-40e7-4991-a579-98c590e306b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A3226780>]}
[0m18:00:10.264540 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\manifest.json
[0m18:00:10.286766 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\semantic_manifest.json
[0m18:00:10.347474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7161c104-40e7-4991-a579-98c590e306b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A337E960>]}
[0m18:00:10.363117 [info ] [MainThread]: Found 4 models, 1 source, 433 macros
[0m18:00:10.364346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7161c104-40e7-4991-a579-98c590e306b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A2D19220>]}
[0m18:00:10.364346 [info ] [MainThread]: 
[0m18:00:10.364346 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:10.372311 [info ] [MainThread]: 
[0m18:00:10.374327 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:00:10.390555 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m18:00:10.807965 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m18:00:10.808965 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m18:00:10.809966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:10.904676 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.098 seconds
[0m18:00:10.904676 [debug] [ThreadPool]: On list_telegram_db: Close
[0m18:00:10.904676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db, now create_telegram_db_raw_analytics)
[0m18:00:10.904676 [debug] [ThreadPool]: Creating schema "database: "telegram_db"
schema: "raw_analytics"
"
[0m18:00:10.920352 [debug] [ThreadPool]: Using postgres connection "create_telegram_db_raw_analytics"
[0m18:00:10.920352 [debug] [ThreadPool]: On create_telegram_db_raw_analytics: BEGIN
[0m18:00:10.920352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:11.026861 [debug] [ThreadPool]: SQL status: BEGIN in 0.102 seconds
[0m18:00:11.026861 [debug] [ThreadPool]: Using postgres connection "create_telegram_db_raw_analytics"
[0m18:00:11.026861 [debug] [ThreadPool]: On create_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "create_telegram_db_raw_analytics"} */
create schema if not exists "raw_analytics"
[0m18:00:11.026861 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m18:00:11.035441 [debug] [ThreadPool]: On create_telegram_db_raw_analytics: COMMIT
[0m18:00:11.035441 [debug] [ThreadPool]: Using postgres connection "create_telegram_db_raw_analytics"
[0m18:00:11.035441 [debug] [ThreadPool]: On create_telegram_db_raw_analytics: COMMIT
[0m18:00:11.251751 [debug] [ThreadPool]: SQL status: COMMIT in 0.225 seconds
[0m18:00:11.251751 [debug] [ThreadPool]: On create_telegram_db_raw_analytics: Close
[0m18:00:11.267392 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_raw_analytics'
[0m18:00:11.267392 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m18:00:11.267392 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: BEGIN
[0m18:00:11.267392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:11.372244 [debug] [ThreadPool]: SQL status: BEGIN in 0.094 seconds
[0m18:00:11.372244 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m18:00:11.379009 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_analytics'
  
[0m18:00:11.393703 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m18:00:11.394534 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: ROLLBACK
[0m18:00:11.394534 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: Close
[0m18:00:11.394534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db_raw_analytics, now list_telegram_db_raw_staging)
[0m18:00:11.410157 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m18:00:11.410157 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m18:00:11.413671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:11.510914 [debug] [ThreadPool]: SQL status: BEGIN in 0.098 seconds
[0m18:00:11.511901 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m18:00:11.512899 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m18:00:11.766799 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.257 seconds
[0m18:00:11.773819 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m18:00:11.773819 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m18:00:11.790140 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:11.790140 [debug] [MainThread]: On master: BEGIN
[0m18:00:11.805838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:12.044774 [debug] [MainThread]: SQL status: BEGIN in 0.245 seconds
[0m18:00:12.044774 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:12.044774 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:00:12.108107 [debug] [MainThread]: SQL status: SELECT 1 in 0.059 seconds
[0m18:00:12.108107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7161c104-40e7-4991-a579-98c590e306b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A01D44A0>]}
[0m18:00:12.108107 [debug] [MainThread]: On master: ROLLBACK
[0m18:00:12.108107 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:12.123570 [debug] [MainThread]: On master: BEGIN
[0m18:00:12.123570 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:00:12.123570 [debug] [MainThread]: On master: COMMIT
[0m18:00:12.123570 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:12.123570 [debug] [MainThread]: On master: COMMIT
[0m18:00:12.123570 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:00:12.123570 [debug] [MainThread]: On master: Close
[0m18:00:12.147206 [debug] [Thread-1 (]: Began running node model.telegram_dbt.dim_channels
[0m18:00:12.148220 [info ] [Thread-1 (]: 1 of 3 START sql table model raw_analytics.dim_channels ........................ [RUN]
[0m18:00:12.150143 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_dbt.dim_channels'
[0m18:00:12.151172 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.dim_channels
[0m18:00:12.164552 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.dim_channels"
[0m18:00:12.175687 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.dim_channels
[0m18:00:12.243104 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.dim_channels"
[0m18:00:12.361961 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m18:00:12.368991 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: BEGIN
[0m18:00:12.373105 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:00:12.513784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.145 seconds
[0m18:00:12.513784 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m18:00:12.513784 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */

  
    

  create  table "telegram_db"."raw_analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_channels.sql

with messages as (
    select * from "telegram_db"."raw_staging"."stg_telegram_messages"
),

dim_channels as (
    select distinct
        channel_name as channel,
        md5(channel_name) as channel_id
    from messages
)

select * from dim_channels
  );
  
[0m18:00:12.553544 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.040 seconds
[0m18:00:12.576638 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m18:00:12.576638 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */
alter table "telegram_db"."raw_analytics"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m18:00:12.576638 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:00:12.607762 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: COMMIT
[0m18:00:12.607762 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m18:00:12.607762 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: COMMIT
[0m18:00:12.733271 [debug] [Thread-1 (]: SQL status: COMMIT in 0.122 seconds
[0m18:00:12.777213 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."dim_channels__dbt_backup"
[0m18:00:12.777213 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m18:00:12.793589 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */
drop table if exists "telegram_db"."raw_analytics"."dim_channels__dbt_backup" cascade
[0m18:00:12.793589 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m18:00:12.793589 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: Close
[0m18:00:12.793589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7161c104-40e7-4991-a579-98c590e306b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A3723620>]}
[0m18:00:12.793589 [info ] [Thread-1 (]: 1 of 3 OK created sql table model raw_analytics.dim_channels ................... [[32mSELECT 0[0m in 0.64s]
[0m18:00:12.886004 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.dim_channels
[0m18:00:12.888961 [debug] [Thread-1 (]: Began running node model.telegram_dbt.dim_dates
[0m18:00:12.891975 [info ] [Thread-1 (]: 2 of 3 START sql table model raw_analytics.dim_dates ........................... [RUN]
[0m18:00:12.894972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_dbt.dim_channels, now model.telegram_dbt.dim_dates)
[0m18:00:12.896971 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.dim_dates
[0m18:00:12.905969 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.dim_dates"
[0m18:00:12.911966 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.dim_dates
[0m18:00:12.926005 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.dim_dates"
[0m18:00:12.932963 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m18:00:12.936123 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: BEGIN
[0m18:00:12.936123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:13.021182 [debug] [Thread-1 (]: SQL status: BEGIN in 0.084 seconds
[0m18:00:13.021182 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m18:00:13.021182 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */

  
    

  create  table "telegram_db"."raw_analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql

with dates as (
    select
        generate_series(
            date '2022-01-01',
            current_date,
            interval '1 day'
        )::date as date_day
),

dim_dates as (
    select
        date_day,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day,
        to_char(date_day, 'Day') as weekday
    from dates
)

select * from dim_dates
  );
  
[0m18:00:13.178957 [debug] [Thread-1 (]: SQL status: SELECT 1290 in 0.165 seconds
[0m18:00:13.195700 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m18:00:13.195700 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */
alter table "telegram_db"."raw_analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m18:00:13.195700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:00:13.211350 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: COMMIT
[0m18:00:13.211350 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m18:00:13.211350 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: COMMIT
[0m18:00:13.222037 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m18:00:13.222037 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."dim_dates__dbt_backup"
[0m18:00:13.222037 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m18:00:13.222037 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */
drop table if exists "telegram_db"."raw_analytics"."dim_dates__dbt_backup" cascade
[0m18:00:13.222037 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m18:00:13.239124 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: Close
[0m18:00:13.241130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7161c104-40e7-4991-a579-98c590e306b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A3677E60>]}
[0m18:00:13.243125 [info ] [Thread-1 (]: 2 of 3 OK created sql table model raw_analytics.dim_dates ...................... [[32mSELECT 1290[0m in 0.35s]
[0m18:00:13.245122 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.dim_dates
[0m18:00:13.247127 [debug] [Thread-1 (]: Began running node model.telegram_dbt.fct_messages
[0m18:00:13.248122 [info ] [Thread-1 (]: 3 of 3 START sql table model raw_analytics.fct_messages ........................ [RUN]
[0m18:00:13.249210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_dbt.dim_dates, now model.telegram_dbt.fct_messages)
[0m18:00:13.252614 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.fct_messages
[0m18:00:13.260188 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.fct_messages"
[0m18:00:13.379598 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.fct_messages
[0m18:00:13.580463 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.fct_messages"
[0m18:00:13.686155 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m18:00:13.701793 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: BEGIN
[0m18:00:13.701793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:13.811274 [debug] [Thread-1 (]: SQL status: BEGIN in 0.115 seconds
[0m18:00:13.824292 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m18:00:13.824292 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */

  
    

  create  table "telegram_db"."raw_analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fct_messages.sql

with messages as (
    select * from "telegram_db"."raw_staging"."stg_telegram_messages"
),

fct as (
    select
        md5(channel_name) as channel_id,
        message_date::date as date_day,
        message_id,
        length(message_text) as message_length,
        has_media,
        media_type
    from messages
)

select * from fct
  );
  
[0m18:00:13.863693 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.041 seconds
[0m18:00:13.863693 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m18:00:13.863693 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
alter table "telegram_db"."raw_analytics"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m18:00:13.863693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:00:13.881619 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: COMMIT
[0m18:00:13.882622 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m18:00:13.883588 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: COMMIT
[0m18:00:14.027578 [debug] [Thread-1 (]: SQL status: COMMIT in 0.140 seconds
[0m18:00:14.047937 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."fct_messages__dbt_backup"
[0m18:00:14.047937 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m18:00:14.047937 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
drop table if exists "telegram_db"."raw_analytics"."fct_messages__dbt_backup" cascade
[0m18:00:14.064315 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:00:14.064315 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: Close
[0m18:00:14.064315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7161c104-40e7-4991-a579-98c590e306b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A379ABD0>]}
[0m18:00:14.064315 [info ] [Thread-1 (]: 3 of 3 OK created sql table model raw_analytics.fct_messages ................... [[32mSELECT 0[0m in 0.82s]
[0m18:00:14.160210 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.fct_messages
[0m18:00:14.175848 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:14.175848 [debug] [MainThread]: On master: BEGIN
[0m18:00:14.182886 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:00:14.429680 [debug] [MainThread]: SQL status: BEGIN in 0.247 seconds
[0m18:00:14.439679 [debug] [MainThread]: On master: COMMIT
[0m18:00:14.443678 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:14.446678 [debug] [MainThread]: On master: COMMIT
[0m18:00:14.448678 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:00:14.451677 [debug] [MainThread]: On master: Close
[0m18:00:14.457677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:14.460677 [debug] [MainThread]: Connection 'create_telegram_db_raw_analytics' was properly closed.
[0m18:00:14.462677 [debug] [MainThread]: Connection 'list_telegram_db_raw_staging' was properly closed.
[0m18:00:14.464678 [debug] [MainThread]: Connection 'model.telegram_dbt.fct_messages' was properly closed.
[0m18:00:14.467677 [info ] [MainThread]: 
[0m18:00:14.513392 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 4.09 seconds (4.09s).
[0m18:00:14.532387 [debug] [MainThread]: Command end result
[0m18:00:14.706217 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\manifest.json
[0m18:00:14.732136 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\semantic_manifest.json
[0m18:00:14.802029 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\run_results.json
[0m18:00:14.803558 [info ] [MainThread]: 
[0m18:00:14.807556 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:14.809562 [info ] [MainThread]: 
[0m18:00:14.811688 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m18:00:14.815683 [debug] [MainThread]: Command `dbt run` succeeded at 18:00:14.815683 after 9.69 seconds
[0m18:00:14.818683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002769D42A8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A34409E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276A0F20C20>]}
[0m18:00:14.823689 [debug] [MainThread]: Flushing usage events
[0m18:00:15.578735 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:00:15.751301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B56A865FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B56DE78A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B56DE7AA20>]}


============================== 11:00:15.853981 | 308b11e3-c6b2-4e8a-9ae8-72d30ba0989b ==============================
[0m11:00:15.853981 [info ] [MainThread]: Running with dbt=1.10.4
[0m11:00:15.856931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\user\\Desktop\\ETL-telegram-medical-pipeline\\dbt\\telegram_dbt\\logs', 'profiles_dir': 'C:\\Users\\user\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m11:00:18.034133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '308b11e3-c6b2-4e8a-9ae8-72d30ba0989b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B56F9F9AF0>]}
[0m11:00:18.227475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '308b11e3-c6b2-4e8a-9ae8-72d30ba0989b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B56FB341D0>]}
[0m11:00:18.227475 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:00:20.169485 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m11:00:22.408056 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:00:22.408056 [debug] [MainThread]: Partial parsing: updated file: telegram_dbt://models\marts\fct_messages.sql
[0m11:00:22.408056 [debug] [MainThread]: Partial parsing: updated file: telegram_dbt://models\marts\dim_dates.sql
[0m11:00:23.573724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '308b11e3-c6b2-4e8a-9ae8-72d30ba0989b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B56FF44920>]}
[0m11:00:23.679240 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\manifest.json
[0m11:00:23.720550 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\semantic_manifest.json
[0m11:00:23.920870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '308b11e3-c6b2-4e8a-9ae8-72d30ba0989b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B56FF71370>]}
[0m11:00:23.920870 [info ] [MainThread]: Found 4 models, 1 source, 433 macros
[0m11:00:23.920870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '308b11e3-c6b2-4e8a-9ae8-72d30ba0989b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B570034AD0>]}
[0m11:00:24.136928 [info ] [MainThread]: 
[0m11:00:24.136928 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:00:24.149046 [info ] [MainThread]: 
[0m11:00:24.164278 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:00:24.170086 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m11:00:24.969463 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m11:00:24.969463 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m11:00:24.969463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:25.530759 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.574 seconds
[0m11:00:25.546399 [debug] [ThreadPool]: On list_telegram_db: Close
[0m11:00:25.567158 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_raw_staging'
[0m11:00:25.586267 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m11:00:25.587929 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m11:00:25.589063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:25.698244 [debug] [ThreadPool]: SQL status: BEGIN in 0.117 seconds
[0m11:00:25.698244 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m11:00:25.698244 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m11:00:25.811923 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.102 seconds
[0m11:00:25.815290 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m11:00:25.816423 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m11:00:25.818655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db_raw_staging, now list_telegram_db_raw_analytics)
[0m11:00:25.820854 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m11:00:25.820854 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: BEGIN
[0m11:00:25.820854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:25.917346 [debug] [ThreadPool]: SQL status: BEGIN in 0.090 seconds
[0m11:00:25.917346 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m11:00:25.917346 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_analytics'
  
[0m11:00:25.932060 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.011 seconds
[0m11:00:25.935017 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: ROLLBACK
[0m11:00:25.936029 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: Close
[0m11:00:25.945591 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:25.945591 [debug] [MainThread]: On master: BEGIN
[0m11:00:25.945591 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:00:26.026606 [debug] [MainThread]: SQL status: BEGIN in 0.084 seconds
[0m11:00:26.026606 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:26.026606 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:00:26.099211 [debug] [MainThread]: SQL status: SELECT 1 in 0.072 seconds
[0m11:00:26.099211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '308b11e3-c6b2-4e8a-9ae8-72d30ba0989b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B56FE7F740>]}
[0m11:00:26.099211 [debug] [MainThread]: On master: ROLLBACK
[0m11:00:26.115496 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:26.115496 [debug] [MainThread]: On master: BEGIN
[0m11:00:26.115496 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:00:26.115496 [debug] [MainThread]: On master: COMMIT
[0m11:00:26.115496 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:26.115496 [debug] [MainThread]: On master: COMMIT
[0m11:00:26.115496 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:00:26.115496 [debug] [MainThread]: On master: Close
[0m11:00:26.131148 [debug] [Thread-1 (]: Began running node model.telegram_dbt.stg_telegram_messages
[0m11:00:26.131148 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_staging.stg_telegram_messages .................. [RUN]
[0m11:00:26.131148 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_dbt.stg_telegram_messages'
[0m11:00:26.146760 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.stg_telegram_messages
[0m11:00:26.152772 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.stg_telegram_messages"
[0m11:00:26.152772 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.stg_telegram_messages
[0m11:00:26.293054 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.stg_telegram_messages"
[0m11:00:26.299567 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m11:00:26.299567 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: BEGIN
[0m11:00:26.299567 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:00:26.381192 [debug] [Thread-1 (]: SQL status: BEGIN in 0.082 seconds
[0m11:00:26.381192 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m11:00:26.381192 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */

  create view "telegram_db"."raw_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    -- models/staging/stg_telegram_messages.sql

with source as (
    select * from "telegram_db"."raw"."telegram_messages"
),

renamed as (
    select
        id::bigint as message_id,
        channel::text as channel_name,
        date::timestamp as message_date,
        message::text as message_text,
        has_media::boolean,
        media_type::text,
        image_path::text
    from source
)

select * from renamed
  );
[0m11:00:26.489762 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.102 seconds
[0m11:00:26.500080 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m11:00:26.500080 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */
alter table "telegram_db"."raw_staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m11:00:26.516990 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m11:00:26.532678 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m11:00:26.532678 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */
alter table "telegram_db"."raw_staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m11:00:26.548303 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:00:26.581471 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: COMMIT
[0m11:00:26.581471 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m11:00:26.581471 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: COMMIT
[0m11:00:26.612877 [debug] [Thread-1 (]: SQL status: COMMIT in 0.025 seconds
[0m11:00:26.628362 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_staging"."stg_telegram_messages__dbt_backup"
[0m11:00:26.628362 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m11:00:26.628362 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */
drop view if exists "telegram_db"."raw_staging"."stg_telegram_messages__dbt_backup" cascade
[0m11:00:26.675234 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.038 seconds
[0m11:00:26.675234 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: Close
[0m11:00:26.690859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '308b11e3-c6b2-4e8a-9ae8-72d30ba0989b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B56B4958B0>]}
[0m11:00:26.690859 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw_staging.stg_telegram_messages ............. [[32mCREATE VIEW[0m in 0.54s]
[0m11:00:26.690859 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.stg_telegram_messages
[0m11:00:26.690859 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:26.690859 [debug] [MainThread]: On master: BEGIN
[0m11:00:26.690859 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:00:26.901003 [debug] [MainThread]: SQL status: BEGIN in 0.209 seconds
[0m11:00:26.901003 [debug] [MainThread]: On master: COMMIT
[0m11:00:26.901003 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:26.901003 [debug] [MainThread]: On master: COMMIT
[0m11:00:26.901003 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:00:26.901003 [debug] [MainThread]: On master: Close
[0m11:00:26.901003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:00:26.901003 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m11:00:26.917804 [debug] [MainThread]: Connection 'list_telegram_db_raw_analytics' was properly closed.
[0m11:00:26.917804 [debug] [MainThread]: Connection 'model.telegram_dbt.stg_telegram_messages' was properly closed.
[0m11:00:26.933445 [info ] [MainThread]: 
[0m11:00:26.933445 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.77 seconds (2.77s).
[0m11:00:26.933445 [debug] [MainThread]: Command end result
[0m11:00:26.982407 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\manifest.json
[0m11:00:26.982407 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\semantic_manifest.json
[0m11:00:27.026709 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\run_results.json
[0m11:00:27.027718 [info ] [MainThread]: 
[0m11:00:27.028817 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:00:27.028817 [info ] [MainThread]: 
[0m11:00:27.028817 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:00:27.037188 [debug] [MainThread]: Command `dbt run` succeeded at 11:00:27.036715 after 11.54 seconds
[0m11:00:27.037704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5703D4D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5703D6630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5703D5A30>]}
[0m11:00:27.040566 [debug] [MainThread]: Flushing usage events
[0m11:00:28.060284 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:00:35.112944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F73B365FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F73EE569C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F73E90E1B0>]}


============================== 11:00:35.128567 | 8127c94c-e9a1-448f-af0c-5f816aa149d4 ==============================
[0m11:00:35.128567 [info ] [MainThread]: Running with dbt=1.10.4
[0m11:00:35.128567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\user\\.dbt', 'log_path': 'C:\\Users\\user\\Desktop\\ETL-telegram-medical-pipeline\\dbt\\telegram_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select marts', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:00:35.730704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8127c94c-e9a1-448f-af0c-5f816aa149d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F7401FA630>]}
[0m11:00:35.877046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8127c94c-e9a1-448f-af0c-5f816aa149d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F73A69BEF0>]}
[0m11:00:35.877046 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:00:36.299897 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m11:00:36.762098 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:00:36.762098 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:00:36.819207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8127c94c-e9a1-448f-af0c-5f816aa149d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F74074F500>]}
[0m11:00:36.928626 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\manifest.json
[0m11:00:36.944216 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\semantic_manifest.json
[0m11:00:37.007139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8127c94c-e9a1-448f-af0c-5f816aa149d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F740A4D550>]}
[0m11:00:37.008219 [info ] [MainThread]: Found 4 models, 1 source, 433 macros
[0m11:00:37.008219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8127c94c-e9a1-448f-af0c-5f816aa149d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F74093CE60>]}
[0m11:00:37.008219 [info ] [MainThread]: 
[0m11:00:37.008219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:00:37.017227 [info ] [MainThread]: 
[0m11:00:37.019845 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:00:37.030358 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m11:00:37.496234 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m11:00:37.496234 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m11:00:37.496234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:37.601493 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.099 seconds
[0m11:00:37.608503 [debug] [ThreadPool]: On list_telegram_db: Close
[0m11:00:37.608503 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_raw_analytics'
[0m11:00:37.608503 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m11:00:37.624920 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: BEGIN
[0m11:00:37.624920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:37.856654 [debug] [ThreadPool]: SQL status: BEGIN in 0.232 seconds
[0m11:00:37.856654 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m11:00:37.856654 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_analytics'
  
[0m11:00:37.856654 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.010 seconds
[0m11:00:37.872283 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: ROLLBACK
[0m11:00:37.872283 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: Close
[0m11:00:37.872283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db_raw_analytics, now list_telegram_db_raw_staging)
[0m11:00:37.872283 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m11:00:37.872283 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m11:00:37.872283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:37.964915 [debug] [ThreadPool]: SQL status: BEGIN in 0.089 seconds
[0m11:00:37.964915 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m11:00:37.964915 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m11:00:37.986230 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m11:00:37.986230 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m11:00:37.986230 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m11:00:37.986230 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:37.986230 [debug] [MainThread]: On master: BEGIN
[0m11:00:38.001872 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:00:38.088516 [debug] [MainThread]: SQL status: BEGIN in 0.089 seconds
[0m11:00:38.088516 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:38.088516 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:00:38.105019 [debug] [MainThread]: SQL status: SELECT 1 in 0.013 seconds
[0m11:00:38.105019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8127c94c-e9a1-448f-af0c-5f816aa149d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F74074F8C0>]}
[0m11:00:38.105019 [debug] [MainThread]: On master: ROLLBACK
[0m11:00:38.105019 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:38.105019 [debug] [MainThread]: On master: BEGIN
[0m11:00:38.105019 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:00:38.105019 [debug] [MainThread]: On master: COMMIT
[0m11:00:38.105019 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:38.105019 [debug] [MainThread]: On master: COMMIT
[0m11:00:38.105019 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:00:38.117830 [debug] [MainThread]: On master: Close
[0m11:00:38.125829 [debug] [Thread-1 (]: Began running node model.telegram_dbt.dim_channels
[0m11:00:38.127832 [info ] [Thread-1 (]: 1 of 3 START sql table model raw_analytics.dim_channels ........................ [RUN]
[0m11:00:38.129828 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_dbt.dim_channels'
[0m11:00:38.130832 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.dim_channels
[0m11:00:38.141506 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.dim_channels"
[0m11:00:38.155450 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.dim_channels
[0m11:00:38.219021 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.dim_channels"
[0m11:00:38.219021 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m11:00:38.219021 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: BEGIN
[0m11:00:38.219021 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:00:38.313406 [debug] [Thread-1 (]: SQL status: BEGIN in 0.082 seconds
[0m11:00:38.313406 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m11:00:38.313406 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */

  
    

  create  table "telegram_db"."raw_analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_channels.sql

with messages as (
    select * from "telegram_db"."raw_staging"."stg_telegram_messages"
),

dim_channels as (
    select distinct
        channel_name as channel,
        md5(channel_name) as channel_id
    from messages
)

select * from dim_channels
  );
  
[0m11:00:38.344641 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.034 seconds
[0m11:00:38.365264 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m11:00:38.365264 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */
alter table "telegram_db"."raw_analytics"."dim_channels" rename to "dim_channels__dbt_backup"
[0m11:00:38.365264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:00:38.365264 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m11:00:38.365264 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */
alter table "telegram_db"."raw_analytics"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m11:00:38.504529 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.141 seconds
[0m11:00:38.553584 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: COMMIT
[0m11:00:38.565602 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m11:00:38.565602 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: COMMIT
[0m11:00:38.682776 [debug] [Thread-1 (]: SQL status: COMMIT in 0.126 seconds
[0m11:00:38.713963 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."dim_channels__dbt_backup"
[0m11:00:38.729570 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m11:00:38.729570 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */
drop table if exists "telegram_db"."raw_analytics"."dim_channels__dbt_backup" cascade
[0m11:00:38.874634 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.145 seconds
[0m11:00:38.905880 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: Close
[0m11:00:38.921440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8127c94c-e9a1-448f-af0c-5f816aa149d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F73BF957C0>]}
[0m11:00:38.921440 [info ] [Thread-1 (]: 1 of 3 OK created sql table model raw_analytics.dim_channels ................... [[32mSELECT 0[0m in 0.78s]
[0m11:00:38.921440 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.dim_channels
[0m11:00:38.940043 [debug] [Thread-1 (]: Began running node model.telegram_dbt.dim_dates
[0m11:00:38.943910 [info ] [Thread-1 (]: 2 of 3 START sql table model raw_analytics.dim_dates ........................... [RUN]
[0m11:00:38.948911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_dbt.dim_channels, now model.telegram_dbt.dim_dates)
[0m11:00:38.953501 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.dim_dates
[0m11:00:38.960658 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.dim_dates"
[0m11:00:39.067990 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.dim_dates
[0m11:00:39.083391 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.dim_dates"
[0m11:00:39.083391 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m11:00:39.083391 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: BEGIN
[0m11:00:39.083391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:39.176332 [debug] [Thread-1 (]: SQL status: BEGIN in 0.087 seconds
[0m11:00:39.177342 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m11:00:39.178937 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */

  
    

  create  table "telegram_db"."raw_analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql

with dates as (
    select
        generate_series(
            date '2022-01-01',
            current_date,
            interval '1 day'
        )::date as date_day
),

dim_dates as (
    select
        date_day,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day,
        to_char(date_day, 'Day') as weekday
    from dates
)
 
select * from dim_dates
  );
  
[0m11:00:39.506873 [debug] [Thread-1 (]: SQL status: SELECT 1292 in 0.328 seconds
[0m11:00:39.538099 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m11:00:39.538099 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */
alter table "telegram_db"."raw_analytics"."dim_dates" rename to "dim_dates__dbt_backup"
[0m11:00:39.538099 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:00:39.559114 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m11:00:39.560969 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */
alter table "telegram_db"."raw_analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m11:00:39.564719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:00:39.569027 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: COMMIT
[0m11:00:39.569027 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m11:00:39.569027 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: COMMIT
[0m11:00:39.732490 [debug] [Thread-1 (]: SQL status: COMMIT in 0.166 seconds
[0m11:00:39.748068 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."dim_dates__dbt_backup"
[0m11:00:39.763660 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m11:00:39.763660 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */
drop table if exists "telegram_db"."raw_analytics"."dim_dates__dbt_backup" cascade
[0m11:00:40.015608 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.261 seconds
[0m11:00:40.032093 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: Close
[0m11:00:40.032093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8127c94c-e9a1-448f-af0c-5f816aa149d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F741136A80>]}
[0m11:00:40.047756 [info ] [Thread-1 (]: 2 of 3 OK created sql table model raw_analytics.dim_dates ...................... [[32mSELECT 1292[0m in 1.08s]
[0m11:00:40.252132 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.dim_dates
[0m11:00:40.256137 [debug] [Thread-1 (]: Began running node model.telegram_dbt.fct_messages
[0m11:00:40.258136 [info ] [Thread-1 (]: 3 of 3 START sql table model raw_analytics.fct_messages ........................ [RUN]
[0m11:00:40.262128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_dbt.dim_dates, now model.telegram_dbt.fct_messages)
[0m11:00:40.267647 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.fct_messages
[0m11:00:40.272741 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.fct_messages"
[0m11:00:40.272741 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.fct_messages
[0m11:00:40.291157 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.fct_messages"
[0m11:00:40.299808 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m11:00:40.303763 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: BEGIN
[0m11:00:40.304901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:40.386817 [debug] [Thread-1 (]: SQL status: BEGIN in 0.086 seconds
[0m11:00:40.392354 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m11:00:40.392354 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */

  
    

  create  table "telegram_db"."raw_analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fct_messages.sql

with messages as (
    select * from "telegram_db"."raw_staging"."stg_telegram_messages"
),

fct as (
    select
        md5(channel_name) as channel_id,
        message_date::date as date_day,
        message_id,
        length(message_text) as message_length,
        has_media,
        media_type
    from messages
)
 
select * from fct
  );
  
[0m11:00:40.597143 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.211 seconds
[0m11:00:40.616853 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m11:00:40.616853 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
alter table "telegram_db"."raw_analytics"."fct_messages" rename to "fct_messages__dbt_backup"
[0m11:00:40.616853 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:00:40.633090 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m11:00:40.633090 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
alter table "telegram_db"."raw_analytics"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m11:00:40.633090 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:00:40.648734 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: COMMIT
[0m11:00:40.648734 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m11:00:40.648734 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: COMMIT
[0m11:00:40.866066 [debug] [Thread-1 (]: SQL status: COMMIT in 0.215 seconds
[0m11:00:40.881501 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."fct_messages__dbt_backup"
[0m11:00:40.881501 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m11:00:40.881501 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
drop table if exists "telegram_db"."raw_analytics"."fct_messages__dbt_backup" cascade
[0m11:00:41.129064 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.247 seconds
[0m11:00:41.129064 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: Close
[0m11:00:41.129064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8127c94c-e9a1-448f-af0c-5f816aa149d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F741162C60>]}
[0m11:00:41.144704 [info ] [Thread-1 (]: 3 of 3 OK created sql table model raw_analytics.fct_messages ................... [[32mSELECT 0[0m in 0.87s]
[0m11:00:41.144704 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.fct_messages
[0m11:00:41.144704 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:41.160292 [debug] [MainThread]: On master: BEGIN
[0m11:00:41.165192 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:00:41.264335 [debug] [MainThread]: SQL status: BEGIN in 0.103 seconds
[0m11:00:41.264335 [debug] [MainThread]: On master: COMMIT
[0m11:00:41.264335 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:41.264335 [debug] [MainThread]: On master: COMMIT
[0m11:00:41.264335 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:00:41.264335 [debug] [MainThread]: On master: Close
[0m11:00:41.264335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:00:41.264335 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m11:00:41.264335 [debug] [MainThread]: Connection 'list_telegram_db_raw_staging' was properly closed.
[0m11:00:41.264335 [debug] [MainThread]: Connection 'model.telegram_dbt.fct_messages' was properly closed.
[0m11:00:41.280452 [info ] [MainThread]: 
[0m11:00:41.282509 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m11:00:41.285533 [debug] [MainThread]: Command end result
[0m11:00:41.315239 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\manifest.json
[0m11:00:41.332069 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\semantic_manifest.json
[0m11:00:41.332069 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\run_results.json
[0m11:00:41.349263 [info ] [MainThread]: 
[0m11:00:41.349263 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:00:41.349263 [info ] [MainThread]: 
[0m11:00:41.349263 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m11:00:41.358293 [debug] [MainThread]: Command `dbt run` succeeded at 11:00:41.358293 after 6.46 seconds
[0m11:00:41.359325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F7401F89B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F73ED8FB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F73EADEAE0>]}
[0m11:00:41.361298 [debug] [MainThread]: Flushing usage events
[0m11:00:42.100100 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:06:12.374279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B2965D1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B2C723DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B2C722EA0>]}


============================== 11:06:12.384075 | 58fe732c-b528-4e56-b75b-5bc181b64ad9 ==============================
[0m11:06:12.384075 [info ] [MainThread]: Running with dbt=1.10.4
[0m11:06:12.386049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\user\\Desktop\\ETL-telegram-medical-pipeline\\dbt\\telegram_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\user\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:06:13.065498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58fe732c-b528-4e56-b75b-5bc181b64ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B2E76A0F0>]}
[0m11:06:13.255741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58fe732c-b528-4e56-b75b-5bc181b64ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B2D007470>]}
[0m11:06:13.258711 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:06:13.737803 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m11:06:14.218820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:06:14.219820 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:06:14.288726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58fe732c-b528-4e56-b75b-5bc181b64ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B2E9F84D0>]}
[0m11:06:14.445653 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\manifest.json
[0m11:06:14.449682 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\semantic_manifest.json
[0m11:06:14.513521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58fe732c-b528-4e56-b75b-5bc181b64ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B2EBA8650>]}
[0m11:06:14.514550 [info ] [MainThread]: Found 4 models, 1 source, 433 macros
[0m11:06:14.516551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58fe732c-b528-4e56-b75b-5bc181b64ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B2E854830>]}
[0m11:06:14.519552 [info ] [MainThread]: 
[0m11:06:14.521527 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:06:14.523523 [info ] [MainThread]: 
[0m11:06:14.525526 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:06:14.540550 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m11:06:15.011595 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m11:06:15.012591 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m11:06:15.015246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:15.196002 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.189 seconds
[0m11:06:15.208400 [debug] [ThreadPool]: On list_telegram_db: Close
[0m11:06:15.212908 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m11:06:15.212908 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m11:06:15.212908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:15.358283 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.137 seconds
[0m11:06:15.362262 [debug] [ThreadPool]: On list_telegram_db: Close
[0m11:06:15.364968 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_raw_staging'
[0m11:06:15.382139 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m11:06:15.382139 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m11:06:15.382139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:15.523798 [debug] [ThreadPool]: SQL status: BEGIN in 0.138 seconds
[0m11:06:15.526800 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m11:06:15.527794 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m11:06:15.542440 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.013 seconds
[0m11:06:15.547429 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m11:06:15.548438 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m11:06:15.549427 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db_raw_staging, now list_telegram_db_raw_analytics)
[0m11:06:15.554427 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m11:06:15.555428 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: BEGIN
[0m11:06:15.556429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:15.657791 [debug] [ThreadPool]: SQL status: BEGIN in 0.107 seconds
[0m11:06:15.657791 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m11:06:15.657791 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_analytics'
  
[0m11:06:15.674343 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.010 seconds
[0m11:06:15.674343 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: ROLLBACK
[0m11:06:15.674343 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: Close
[0m11:06:15.692843 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:15.692843 [debug] [MainThread]: On master: BEGIN
[0m11:06:15.692843 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:06:15.821980 [debug] [MainThread]: SQL status: BEGIN in 0.126 seconds
[0m11:06:15.823981 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:15.826982 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:06:15.844194 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m11:06:15.849625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58fe732c-b528-4e56-b75b-5bc181b64ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B2E7CBBF0>]}
[0m11:06:15.850623 [debug] [MainThread]: On master: ROLLBACK
[0m11:06:15.851624 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:15.852626 [debug] [MainThread]: On master: BEGIN
[0m11:06:15.854626 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:06:15.855627 [debug] [MainThread]: On master: COMMIT
[0m11:06:15.856625 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:15.858980 [debug] [MainThread]: On master: COMMIT
[0m11:06:15.861429 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:06:15.862434 [debug] [MainThread]: On master: Close
[0m11:06:15.869430 [debug] [Thread-1 (]: Began running node model.telegram_dbt.dim_dates
[0m11:06:15.870429 [info ] [Thread-1 (]: 1 of 4 START sql table model raw_analytics.dim_dates ........................... [RUN]
[0m11:06:15.875433 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_dbt.dim_dates'
[0m11:06:15.877432 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.dim_dates
[0m11:06:15.888456 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.dim_dates"
[0m11:06:15.892457 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.dim_dates
[0m11:06:16.006104 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.dim_dates"
[0m11:06:16.010105 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m11:06:16.012101 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: BEGIN
[0m11:06:16.015134 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:06:16.127389 [debug] [Thread-1 (]: SQL status: BEGIN in 0.113 seconds
[0m11:06:16.128388 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m11:06:16.130388 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */

  
    

  create  table "telegram_db"."raw_analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql

with dates as (
    select
        generate_series(
            date '2022-01-01',
            current_date,
            interval '1 day'
        )::date as date_day
),

dim_dates as (
    select
        date_day,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day,
        to_char(date_day, 'Day') as weekday
    from dates
)
 
select * from dim_dates
  );
  
[0m11:06:16.170478 [debug] [Thread-1 (]: SQL status: SELECT 1292 in 0.038 seconds
[0m11:06:16.173265 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m11:06:16.173265 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */
alter table "telegram_db"."raw_analytics"."dim_dates" rename to "dim_dates__dbt_backup"
[0m11:06:16.189567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:06:16.189567 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m11:06:16.189567 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */
alter table "telegram_db"."raw_analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m11:06:16.189567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:06:16.233487 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: COMMIT
[0m11:06:16.234491 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m11:06:16.235512 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: COMMIT
[0m11:06:16.261407 [debug] [Thread-1 (]: SQL status: COMMIT in 0.024 seconds
[0m11:06:16.274234 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."dim_dates__dbt_backup"
[0m11:06:16.283713 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m11:06:16.285685 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */
drop table if exists "telegram_db"."raw_analytics"."dim_dates__dbt_backup" cascade
[0m11:06:16.302837 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m11:06:16.308881 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: Close
[0m11:06:16.314851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58fe732c-b528-4e56-b75b-5bc181b64ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B2A1E98E0>]}
[0m11:06:16.315853 [info ] [Thread-1 (]: 1 of 4 OK created sql table model raw_analytics.dim_dates ...................... [[32mSELECT 1292[0m in 0.44s]
[0m11:06:16.335003 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.dim_dates
[0m11:06:16.336972 [debug] [Thread-1 (]: Began running node model.telegram_dbt.stg_telegram_messages
[0m11:06:16.338371 [info ] [Thread-1 (]: 2 of 4 START sql view model raw_staging.stg_telegram_messages .................. [RUN]
[0m11:06:16.342401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_dbt.dim_dates, now model.telegram_dbt.stg_telegram_messages)
[0m11:06:16.344660 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.stg_telegram_messages
[0m11:06:16.350691 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.stg_telegram_messages"
[0m11:06:16.352673 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.stg_telegram_messages
[0m11:06:16.393752 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.stg_telegram_messages"
[0m11:06:16.396727 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m11:06:16.397727 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: BEGIN
[0m11:06:16.399726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:16.505215 [debug] [Thread-1 (]: SQL status: BEGIN in 0.105 seconds
[0m11:06:16.506531 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m11:06:16.507551 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */

  create view "telegram_db"."raw_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    -- models/staging/stg_telegram_messages.sql

with source as (
    select * from "telegram_db"."raw"."telegram_messages"
),

renamed as (
    select
        id::bigint as message_id,
        channel::text as channel_name,
        date::timestamp as message_date,
        message::text as message_text,
        has_media::boolean,
        media_type::text,
        image_path::text
    from source
)

select * from renamed
  );
[0m11:06:16.542908 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.034 seconds
[0m11:06:16.549908 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m11:06:16.550906 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */
alter table "telegram_db"."raw_staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m11:06:16.552945 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:06:16.561380 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m11:06:16.562381 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */
alter table "telegram_db"."raw_staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m11:06:16.564382 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:06:16.568378 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: COMMIT
[0m11:06:16.569378 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m11:06:16.570385 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: COMMIT
[0m11:06:16.601024 [debug] [Thread-1 (]: SQL status: COMMIT in 0.030 seconds
[0m11:06:16.608347 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_staging"."stg_telegram_messages__dbt_backup"
[0m11:06:16.615306 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m11:06:16.616309 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */
drop view if exists "telegram_db"."raw_staging"."stg_telegram_messages__dbt_backup" cascade
[0m11:06:16.644566 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.027 seconds
[0m11:06:16.647564 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: Close
[0m11:06:16.648564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58fe732c-b528-4e56-b75b-5bc181b64ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B2EBD0E60>]}
[0m11:06:16.652105 [info ] [Thread-1 (]: 2 of 4 OK created sql view model raw_staging.stg_telegram_messages ............. [[32mCREATE VIEW[0m in 0.31s]
[0m11:06:16.654107 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.stg_telegram_messages
[0m11:06:16.657118 [debug] [Thread-1 (]: Began running node model.telegram_dbt.dim_channels
[0m11:06:16.658692 [info ] [Thread-1 (]: 3 of 4 START sql table model raw_analytics.dim_channels ........................ [RUN]
[0m11:06:16.660660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_dbt.stg_telegram_messages, now model.telegram_dbt.dim_channels)
[0m11:06:16.662661 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.dim_channels
[0m11:06:16.671664 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.dim_channels"
[0m11:06:16.675659 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.dim_channels
[0m11:06:16.683482 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.dim_channels"
[0m11:06:16.685480 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m11:06:16.687481 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: BEGIN
[0m11:06:16.690416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:16.795662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.105 seconds
[0m11:06:16.796662 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m11:06:16.797660 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */

  
    

  create  table "telegram_db"."raw_analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_channels.sql

with messages as (
    select * from "telegram_db"."raw_staging"."stg_telegram_messages"
),

dim_channels as (
    select distinct
        channel_name as channel,
        md5(channel_name) as channel_id
    from messages
)

select * from dim_channels
  );
  
[0m11:06:16.820699 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.021 seconds
[0m11:06:16.830292 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m11:06:16.832285 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */
alter table "telegram_db"."raw_analytics"."dim_channels" rename to "dim_channels__dbt_backup"
[0m11:06:16.834280 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:06:16.845982 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m11:06:16.848979 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */
alter table "telegram_db"."raw_analytics"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m11:06:16.850982 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:06:16.858305 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: COMMIT
[0m11:06:16.860304 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m11:06:16.863305 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: COMMIT
[0m11:06:16.874112 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m11:06:16.882677 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."dim_channels__dbt_backup"
[0m11:06:16.885673 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m11:06:16.886700 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */
drop table if exists "telegram_db"."raw_analytics"."dim_channels__dbt_backup" cascade
[0m11:06:16.916137 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.028 seconds
[0m11:06:16.919139 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: Close
[0m11:06:16.921139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58fe732c-b528-4e56-b75b-5bc181b64ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B2F3B2E70>]}
[0m11:06:16.923728 [info ] [Thread-1 (]: 3 of 4 OK created sql table model raw_analytics.dim_channels ................... [[32mSELECT 0[0m in 0.26s]
[0m11:06:16.961094 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.dim_channels
[0m11:06:16.961094 [debug] [Thread-1 (]: Began running node model.telegram_dbt.fct_messages
[0m11:06:16.961094 [info ] [Thread-1 (]: 4 of 4 START sql table model raw_analytics.fct_messages ........................ [RUN]
[0m11:06:16.961094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_dbt.dim_channels, now model.telegram_dbt.fct_messages)
[0m11:06:16.961094 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.fct_messages
[0m11:06:16.979507 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.fct_messages"
[0m11:06:16.980555 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.fct_messages
[0m11:06:16.992135 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.fct_messages"
[0m11:06:16.992135 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m11:06:16.992135 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: BEGIN
[0m11:06:16.992135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:17.096856 [debug] [Thread-1 (]: SQL status: BEGIN in 0.094 seconds
[0m11:06:17.096856 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m11:06:17.096856 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */

  
    

  create  table "telegram_db"."raw_analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fct_messages.sql

with messages as (
    select * from "telegram_db"."raw_staging"."stg_telegram_messages"
),

fct as (
    select
        md5(channel_name) as channel_id,
        message_date::date as date_day,
        message_id,
        length(message_text) as message_length,
        has_media,
        media_type
    from messages
)
 
select * from fct
  );
  
[0m11:06:17.129140 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.036 seconds
[0m11:06:17.129140 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m11:06:17.144769 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
alter table "telegram_db"."raw_analytics"."fct_messages" rename to "fct_messages__dbt_backup"
[0m11:06:17.144769 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:06:17.158628 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m11:06:17.162060 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
alter table "telegram_db"."raw_analytics"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m11:06:17.165428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:06:17.169992 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: COMMIT
[0m11:06:17.171124 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m11:06:17.173409 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: COMMIT
[0m11:06:17.173953 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m11:06:17.173953 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."fct_messages__dbt_backup"
[0m11:06:17.173953 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m11:06:17.189587 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
drop table if exists "telegram_db"."raw_analytics"."fct_messages__dbt_backup" cascade
[0m11:06:17.221670 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.036 seconds
[0m11:06:17.221670 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: Close
[0m11:06:17.221670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58fe732c-b528-4e56-b75b-5bc181b64ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B2F3C32F0>]}
[0m11:06:17.221670 [info ] [Thread-1 (]: 4 of 4 OK created sql table model raw_analytics.fct_messages ................... [[32mSELECT 0[0m in 0.26s]
[0m11:06:17.237328 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.fct_messages
[0m11:06:17.237328 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:17.237328 [debug] [MainThread]: On master: BEGIN
[0m11:06:17.237328 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:06:17.339529 [debug] [MainThread]: SQL status: BEGIN in 0.109 seconds
[0m11:06:17.339529 [debug] [MainThread]: On master: COMMIT
[0m11:06:17.355187 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:17.355187 [debug] [MainThread]: On master: COMMIT
[0m11:06:17.355187 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:06:17.355187 [debug] [MainThread]: On master: Close
[0m11:06:17.355187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:06:17.360704 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m11:06:17.360704 [debug] [MainThread]: Connection 'list_telegram_db_raw_analytics' was properly closed.
[0m11:06:17.360704 [debug] [MainThread]: Connection 'model.telegram_dbt.fct_messages' was properly closed.
[0m11:06:17.360704 [info ] [MainThread]: 
[0m11:06:17.360704 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m11:06:17.360704 [debug] [MainThread]: Command end result
[0m11:06:17.489903 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\manifest.json
[0m11:06:17.489903 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\semantic_manifest.json
[0m11:06:17.497914 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\run_results.json
[0m11:06:17.497914 [info ] [MainThread]: 
[0m11:06:17.497914 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:06:17.497914 [info ] [MainThread]: 
[0m11:06:17.517073 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m11:06:17.523450 [debug] [MainThread]: Command `dbt run` succeeded at 11:06:17.523450 after 5.42 seconds
[0m11:06:17.523450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B2C2D3AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B2CEA0E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B2A31EFC0>]}
[0m11:06:17.523450 [debug] [MainThread]: Flushing usage events
[0m11:06:28.736627 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:16:45.459865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024955C6D1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002495936A900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024959369880>]}


============================== 11:16:45.459865 | 21e4c8bd-08b3-478d-a6dc-619c96a6ba4b ==============================
[0m11:16:45.459865 [info ] [MainThread]: Running with dbt=1.10.4
[0m11:16:45.459865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\user\\.dbt', 'log_path': 'C:\\Users\\user\\Desktop\\ETL-telegram-medical-pipeline\\dbt\\telegram_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:16:45.542583 [info ] [MainThread]: dbt version: 1.10.4
[0m11:16:45.548746 [info ] [MainThread]: python version: 3.12.4
[0m11:16:45.550852 [info ] [MainThread]: python path: C:\Users\user\anaconda3\python.exe
[0m11:16:45.554836 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m11:16:45.742678 [info ] [MainThread]: Using profiles dir at C:\Users\user\.dbt
[0m11:16:45.742678 [info ] [MainThread]: Using profiles.yml file at C:\Users\user\.dbt\profiles.yml
[0m11:16:45.742678 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\dbt_project.yml
[0m11:16:45.760773 [info ] [MainThread]: adapter type: postgres
[0m11:16:45.763404 [info ] [MainThread]: adapter version: 1.9.0
[0m11:16:46.129315 [info ] [MainThread]: Configuration:
[0m11:16:46.129315 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:16:46.144935 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:16:46.144935 [info ] [MainThread]: Required dependencies:
[0m11:16:46.150669 [debug] [MainThread]: Executing "git --help"
[0m11:16:46.195069 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:16:46.195069 [debug] [MainThread]: STDERR: "b''"
[0m11:16:46.195069 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:16:46.195069 [info ] [MainThread]: Connection:
[0m11:16:46.195069 [info ] [MainThread]:   host: localhost
[0m11:16:46.195069 [info ] [MainThread]:   port: 5432
[0m11:16:46.195069 [info ] [MainThread]:   user: postgres
[0m11:16:46.207009 [info ] [MainThread]:   database: telegram_db
[0m11:16:46.208005 [info ] [MainThread]:   schema: raw
[0m11:16:46.210008 [info ] [MainThread]:   connect_timeout: 10
[0m11:16:46.213017 [info ] [MainThread]:   role: None
[0m11:16:46.215005 [info ] [MainThread]:   search_path: None
[0m11:16:46.216009 [info ] [MainThread]:   keepalives_idle: 0
[0m11:16:46.219802 [info ] [MainThread]:   sslmode: None
[0m11:16:46.221924 [info ] [MainThread]:   sslcert: None
[0m11:16:46.222923 [info ] [MainThread]:   sslkey: None
[0m11:16:46.223971 [info ] [MainThread]:   sslrootcert: None
[0m11:16:46.226581 [info ] [MainThread]:   application_name: dbt
[0m11:16:46.229582 [info ] [MainThread]:   retries: 1
[0m11:16:46.231580 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:16:46.786731 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:16:47.252833 [debug] [MainThread]: Using postgres connection "debug"
[0m11:16:47.252833 [debug] [MainThread]: On debug: select 1 as id
[0m11:16:47.252833 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:16:47.841947 [debug] [MainThread]: SQL status: SELECT 1 in 0.578 seconds
[0m11:16:47.841947 [debug] [MainThread]: On debug: Close
[0m11:16:47.841947 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:16:47.857574 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:16:47.871776 [debug] [MainThread]: Command `dbt debug` succeeded at 11:16:47.871225 after 2.71 seconds
[0m11:16:47.873524 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:16:47.875384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024955C6D1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002495936A900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249593686E0>]}
[0m11:16:47.875384 [debug] [MainThread]: Flushing usage events
[0m11:16:53.027311 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:15:39.896088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f1598880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f04e2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f04e29b0>]}


============================== 09:15:39.906964 | 0e091a25-faee-4b4e-9a43-608a9461b484 ==============================
[0m09:15:39.906964 [info ] [MainThread]: Running with dbt=1.10.4
[0m09:15:39.914211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/telegram_dbt/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:15:41.838439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e091a25-faee-4b4e-9a43-608a9461b484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51eff02590>]}
[0m09:15:42.100578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e091a25-faee-4b4e-9a43-608a9461b484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f0ec6b30>]}
[0m09:15:42.153765 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:15:43.461493 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m09:15:45.508985 [debug] [MainThread]: Partial parsing enabled: 131 files deleted, 131 files added, 0 files changed.
[0m09:15:45.512724 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/adapters.sql
[0m09:15:45.515877 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/create.sql
[0m09:15:45.518569 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/rename.sql
[0m09:15:45.520824 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_concat.sql
[0m09:15:45.523515 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/timestamps.sql
[0m09:15:45.526068 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/drop_backup.sql
[0m09:15:45.528556 [debug] [MainThread]: Partial parsing: added file: dbt://macros/etc/datetime.sql
[0m09:15:45.530977 [debug] [MainThread]: Partial parsing: added file: dbt://macros/etc/statement.sql
[0m09:15:45.533643 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/where_subquery.sql
[0m09:15:45.536867 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/helpers.sql
[0m09:15:45.539725 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date_trunc.sql
[0m09:15:45.542112 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations.sql
[0m09:15:45.545078 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/drop.sql
[0m09:15:45.547711 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/concat.sql
[0m09:15:45.552218 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/split_part.sql
[0m09:15:45.554369 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/except.sql
[0m09:15:45.556972 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/materialized_view.sql
[0m09:15:45.560084 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create_backup.sql
[0m09:15:45.562756 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/column_helpers.sql
[0m09:15:45.565130 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/replace.sql
[0m09:15:45.567333 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/cast.sql
[0m09:15:45.570020 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/last_day.sql
[0m09:15:45.572910 [debug] [MainThread]: Partial parsing: added file: telegram_dbt://models/marts/dim_channels.sql
[0m09:15:45.576134 [debug] [MainThread]: Partial parsing: added file: dbt://docs/overview.md
[0m09:15:45.578800 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/drop.sql
[0m09:15:45.582143 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/table.sql
[0m09:15:45.585270 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/replace.sql
[0m09:15:45.588596 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/freshness.sql
[0m09:15:45.591685 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/column/columns_spec_ddl.sql
[0m09:15:45.594591 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/create_or_replace_clone.sql
[0m09:15:45.598166 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/hash.sql
[0m09:15:45.601843 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/accepted_values.sql
[0m09:15:45.604642 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/snapshot_merge.sql
[0m09:15:45.607140 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/generate_series.sql
[0m09:15:45.609663 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/columns.sql
[0m09:15:45.612133 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/replace.sql
[0m09:15:45.614118 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date.sql
[0m09:15:45.616382 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/merge.sql
[0m09:15:45.618867 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/alter.sql
[0m09:15:45.621145 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_schema.sql
[0m09:15:45.623665 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/seeds/helpers.sql
[0m09:15:45.626511 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/persist_docs.sql
[0m09:15:45.629171 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/drop.sql
[0m09:15:45.631606 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/relation.sql
[0m09:15:45.634079 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/clone.sql
[0m09:15:45.637008 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/any_value.sql
[0m09:15:45.640030 [debug] [MainThread]: Partial parsing: added file: telegram_dbt://models/marts/fct_messages.sql
[0m09:15:45.642792 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/rename.sql
[0m09:15:45.645288 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/replace.sql
[0m09:15:45.647836 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/dateadd.sql
[0m09:15:45.650142 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date_spine.sql
[0m09:15:45.652566 [debug] [MainThread]: Partial parsing: added file: telegram_dbt://models/marts/dim_dates.sql
[0m09:15:45.655272 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/metadata.sql
[0m09:15:45.658108 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create_intermediate.sql
[0m09:15:45.660631 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/drop.sql
[0m09:15:45.663311 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/alter.sql
[0m09:15:45.665854 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/schema.sql
[0m09:15:45.668607 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/datediff.sql
[0m09:15:45.671123 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/position.sql
[0m09:15:45.673651 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/unique.sql
[0m09:15:45.675796 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/strategies.sql
[0m09:15:45.678128 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/validate_sql.sql
[0m09:15:45.680674 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/drop.sql
[0m09:15:45.682605 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/incremental.sql
[0m09:15:45.684491 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/dateadd.sql
[0m09:15:45.686371 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/drop.sql
[0m09:15:45.688283 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/rename.sql
[0m09:15:45.690268 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/escape_single_quotes.sql
[0m09:15:45.692208 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/is_incremental.sql
[0m09:15:45.694074 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/schema.sql
[0m09:15:45.695950 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/materializations/snapshot_merge.sql
[0m09:15:45.697854 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/refresh.sql
[0m09:15:45.700444 [debug] [MainThread]: Partial parsing: added file: telegram_dbt://models/staging/stg_telegram_messages.sql
[0m09:15:45.702318 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/unit.sql
[0m09:15:45.704202 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/right.sql
[0m09:15:45.706139 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/replace.sql
[0m09:15:45.708080 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/any_value.sql
[0m09:15:45.709963 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/datediff.sql
[0m09:15:45.711953 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/seeds/seed.sql
[0m09:15:45.713968 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/rename.sql
[0m09:15:45.716010 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/length.sql
[0m09:15:45.717848 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/rename.sql
[0m09:15:45.720264 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/split_part.sql
[0m09:15:45.722491 [debug] [MainThread]: Partial parsing: added file: telegram_dbt://models/raw_sources.yml
[0m09:15:45.724418 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/rename.sql
[0m09:15:45.726399 [debug] [MainThread]: Partial parsing: added file: dbt://macros/python_model/python.sql
[0m09:15:45.728482 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/indexes.sql
[0m09:15:45.733693 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/apply_grants.sql
[0m09:15:45.735480 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/data_types.sql
[0m09:15:45.737255 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/safe_cast.sql
[0m09:15:45.739226 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/create.sql
[0m09:15:45.741182 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/hooks.sql
[0m09:15:45.743133 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/cast_bool_to_text.sql
[0m09:15:45.745568 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/replace.sql
[0m09:15:45.748448 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/create.sql
[0m09:15:45.751153 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/last_day.sql
[0m09:15:45.753793 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/equals.sql
[0m09:15:45.756127 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/snapshot.sql
[0m09:15:45.758712 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/rename_intermediate.sql
[0m09:15:45.761784 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/refresh.sql
[0m09:15:45.764606 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/columns_spec_ddl.sql
[0m09:15:45.767270 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/helpers.sql
[0m09:15:45.773827 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/can_clone_table.sql
[0m09:15:45.776695 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/listagg.sql
[0m09:15:45.779490 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/configs.sql
[0m09:15:45.782383 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/intersect.sql
[0m09:15:45.785010 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_database.sql
[0m09:15:45.787844 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/strategies.sql
[0m09:15:45.796587 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_construct.sql
[0m09:15:45.799407 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/materializations/incremental_strategies.sql
[0m09:15:45.802303 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/create.sql
[0m09:15:45.808880 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/drop.sql
[0m09:15:45.813369 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/rename.sql
[0m09:15:45.816344 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/not_null.sql
[0m09:15:45.819246 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/relationships.sql
[0m09:15:45.822152 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/replace.sql
[0m09:15:45.825043 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/listagg.sql
[0m09:15:45.827988 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/show.sql
[0m09:15:45.831011 [debug] [MainThread]: Partial parsing: added file: dbt://macros/unit_test_sql/get_fixture_sql.sql
[0m09:15:45.833567 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/timestamps.sql
[0m09:15:45.836245 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/describe.sql
[0m09:15:45.838933 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_append.sql
[0m09:15:45.841424 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create.sql
[0m09:15:45.844891 [debug] [MainThread]: Partial parsing: added file: dbt://tests/generic/builtin.sql
[0m09:15:45.847705 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/view.sql
[0m09:15:45.850152 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/test.sql
[0m09:15:45.852368 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/literal.sql
[0m09:15:45.854766 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/catalog.sql
[0m09:15:45.857190 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/bool_or.sql
[0m09:15:45.859737 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_alias.sql
[0m09:15:45.862672 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/on_schema_change.sql
[0m09:15:45.865155 [debug] [MainThread]: Partial parsing: deleted file: telegram_dbt://models\marts\fct_messages.sql
[0m09:15:45.871451 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\create.sql
[0m09:15:45.874265 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\dateadd.sql
[0m09:15:45.876536 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\drop.sql
[0m09:15:45.878719 [debug] [MainThread]: Partial parsing: deleted file: telegram_dbt://models\marts\dim_channels.sql
[0m09:15:45.881490 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\etc\statement.sql
[0m09:15:45.883939 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\indexes.sql
[0m09:15:45.886252 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\is_incremental.sql
[0m09:15:45.888876 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\seeds\helpers.sql
[0m09:15:45.892915 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create.sql
[0m09:15:45.896103 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\equals.sql
[0m09:15:45.898487 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\relation.sql
[0m09:15:45.900787 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\describe.sql
[0m09:15:45.903025 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\schema.sql
[0m09:15:45.905122 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_concat.sql
[0m09:15:45.907354 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\dateadd.sql
[0m09:15:45.909647 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\freshness.sql
[0m09:15:45.913208 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\replace.sql
[0m09:15:45.915673 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\escape_single_quotes.sql
[0m09:15:45.918104 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date_trunc.sql
[0m09:15:45.920352 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\replace.sql
[0m09:15:45.922420 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\split_part.sql
[0m09:15:45.924472 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\create.sql
[0m09:15:45.927255 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\drop.sql
[0m09:15:45.929869 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\intersect.sql
[0m09:15:45.932086 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\rename.sql
[0m09:15:45.935865 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\columns_spec_ddl.sql
[0m09:15:45.943574 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\datediff.sql
[0m09:15:45.946673 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_construct.sql
[0m09:15:45.949895 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\column_helpers.sql
[0m09:15:45.953197 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\datediff.sql
[0m09:15:45.957142 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date.sql
[0m09:15:45.959933 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\safe_cast.sql
[0m09:15:45.964833 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\rename_intermediate.sql
[0m09:15:45.968029 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_alias.sql
[0m09:15:45.970373 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\cast_bool_to_text.sql
[0m09:15:45.972498 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\drop_backup.sql
[0m09:15:45.974721 [debug] [MainThread]: Partial parsing: deleted file: telegram_dbt://models\staging\stg_telegram_messages.sql
[0m09:15:45.976979 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\alter.sql
[0m09:15:45.979203 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\accepted_values.sql
[0m09:15:45.981331 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\replace.sql
[0m09:15:45.984417 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\adapters.sql
[0m09:15:45.987433 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\refresh.sql
[0m09:15:45.989953 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\helpers.sql
[0m09:15:45.992728 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\rename.sql
[0m09:15:45.994915 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\last_day.sql
[0m09:15:45.997109 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\show.sql
[0m09:15:45.999803 [debug] [MainThread]: Partial parsing: deleted file: dbt://tests\generic\builtin.sql
[0m09:15:46.002677 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\helpers.sql
[0m09:15:46.005871 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date_spine.sql
[0m09:15:46.008699 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\rename.sql
[0m09:15:46.012360 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\snapshot.sql
[0m09:15:46.015346 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\rename.sql
[0m09:15:46.018168 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\create.sql
[0m09:15:46.021431 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\unit.sql
[0m09:15:46.024425 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\timestamps.sql
[0m09:15:46.033957 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\python_model\python.sql
[0m09:15:46.037097 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\schema.sql
[0m09:15:46.039878 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\replace.sql
[0m09:15:46.042755 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_append.sql
[0m09:15:46.049822 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\cast.sql
[0m09:15:46.052680 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\right.sql
[0m09:15:46.056413 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\apply_grants.sql
[0m09:15:46.068231 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\data_types.sql
[0m09:15:46.071568 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\bool_or.sql
[0m09:15:46.075742 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\except.sql
[0m09:15:46.085673 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\rename.sql
[0m09:15:46.088767 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\replace.sql
[0m09:15:46.091620 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\where_subquery.sql
[0m09:15:46.100917 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\alter.sql
[0m09:15:46.104067 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\unit_test_sql\get_fixture_sql.sql
[0m09:15:46.106669 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\create_or_replace_clone.sql
[0m09:15:46.109879 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\persist_docs.sql
[0m09:15:46.116583 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\test.sql
[0m09:15:46.120065 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\drop.sql
[0m09:15:46.122937 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\materialized_view.sql
[0m09:15:46.125819 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\view.sql
[0m09:15:46.134039 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\columns.sql
[0m09:15:46.136972 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create_intermediate.sql
[0m09:15:46.147628 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\length.sql
[0m09:15:46.150441 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\replace.sql
[0m09:15:46.153614 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\strategies.sql
[0m09:15:46.156456 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\materializations\snapshot_merge.sql
[0m09:15:46.165051 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\drop.sql
[0m09:15:46.167894 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\not_null.sql
[0m09:15:46.171010 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\last_day.sql
[0m09:15:46.174159 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_database.sql
[0m09:15:46.178753 [debug] [MainThread]: Partial parsing: deleted file: telegram_dbt://models\marts\dim_dates.sql
[0m09:15:46.182792 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\merge.sql
[0m09:15:46.187799 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\etc\datetime.sql
[0m09:15:46.190566 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\hooks.sql
[0m09:15:46.192984 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\rename.sql
[0m09:15:46.194989 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\hash.sql
[0m09:15:46.198020 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\column\columns_spec_ddl.sql
[0m09:15:46.200071 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\configs.sql
[0m09:15:46.202057 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\create.sql
[0m09:15:46.204027 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\can_clone_table.sql
[0m09:15:46.206004 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\rename.sql
[0m09:15:46.207823 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\drop.sql
[0m09:15:46.209558 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\materializations\incremental_strategies.sql
[0m09:15:46.211708 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations.sql
[0m09:15:46.213833 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\any_value.sql
[0m09:15:46.215519 [debug] [MainThread]: Partial parsing: deleted file: dbt://docs\overview.md
[0m09:15:46.217184 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\drop.sql
[0m09:15:46.219707 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\validate_sql.sql
[0m09:15:46.221459 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\position.sql
[0m09:15:46.223264 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\relationships.sql
[0m09:15:46.225000 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\incremental.sql
[0m09:15:46.227407 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create_backup.sql
[0m09:15:46.229118 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\on_schema_change.sql
[0m09:15:46.231023 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\replace.sql
[0m09:15:46.232646 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\unique.sql
[0m09:15:46.234350 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\split_part.sql
[0m09:15:46.237428 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\table.sql
[0m09:15:46.239381 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\catalog.sql
[0m09:15:46.241070 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_schema.sql
[0m09:15:46.242900 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\metadata.sql
[0m09:15:46.244599 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\any_value.sql
[0m09:15:46.246331 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\concat.sql
[0m09:15:46.247940 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\listagg.sql
[0m09:15:46.249831 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\listagg.sql
[0m09:15:46.253027 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\generate_series.sql
[0m09:15:46.255174 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\seeds\seed.sql
[0m09:15:46.257565 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\drop.sql
[0m09:15:46.260037 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\snapshot_merge.sql
[0m09:15:46.262734 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\literal.sql
[0m09:15:46.264995 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\clone.sql
[0m09:15:46.267259 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\refresh.sql
[0m09:15:46.270079 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\timestamps.sql
[0m09:15:46.272277 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\strategies.sql
[0m09:15:46.274321 [error] [MainThread]: Encountered an error:
'dbt_postgres://macros/adapters.sql'
[0m09:15:46.278229 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 355, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 371, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 398, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
  File "/usr/local/lib/python3.10/site-packages/dbt/parser/manifest.py", line 2115, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "/usr/local/lib/python3.10/site-packages/dbt/parser/manifest.py", line 315, in get_full_manifest
    manifest = loader.load()
  File "/usr/local/lib/python3.10/site-packages/dbt/parser/manifest.py", line 384, in load
    self.load_and_parse_macros(project_parser_files)
  File "/usr/local/lib/python3.10/site-packages/dbt/parser/manifest.py", line 686, in load_and_parse_macros
    block = FileBlock(self.manifest.files[file_id])
KeyError: 'dbt_postgres://macros/adapters.sql'

[0m09:15:46.355547 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.7788525, "process_in_blocks": "87024", "process_kernel_time": 0.521494, "process_mem_max_rss": "107188", "process_out_blocks": "16", "process_user_time": 5.913748}
[0m09:15:46.358307 [debug] [MainThread]: Command `dbt run` failed at 09:15:46.357966 after 6.78 seconds
[0m09:15:46.360911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51f1598880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51eff01a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51eefa2f50>]}
[0m09:15:46.363526 [debug] [MainThread]: Flushing usage events
[0m09:15:54.383623 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:17:41.623651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251BE1FAC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251BE1FB6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251BE1F8D40>]}


============================== 12:17:41.648520 | e381e5df-ca61-4b00-a42f-93c7e424000c ==============================
[0m12:17:41.648520 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:17:41.651523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\user\\Desktop\\ETL-telegram-medical-pipeline\\dbt\\telegram_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\user\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:17:44.383100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e381e5df-ca61-4b00-a42f-93c7e424000c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251BE851D60>]}
[0m12:17:44.892132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e381e5df-ca61-4b00-a42f-93c7e424000c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251BDB6E9C0>]}
[0m12:17:44.916195 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:17:46.456370 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:17:47.882848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:47.883857 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:48.248668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e381e5df-ca61-4b00-a42f-93c7e424000c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251BFD2DDC0>]}
[0m12:17:48.446149 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\manifest.json
[0m12:17:48.493035 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\semantic_manifest.json
[0m12:17:48.647263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e381e5df-ca61-4b00-a42f-93c7e424000c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251BFD4F320>]}
[0m12:17:48.651276 [info ] [MainThread]: Found 4 models, 1 source, 433 macros
[0m12:17:48.651276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e381e5df-ca61-4b00-a42f-93c7e424000c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251BFD2CEF0>]}
[0m12:17:48.651276 [info ] [MainThread]: 
[0m12:17:48.651276 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:17:48.661705 [info ] [MainThread]: 
[0m12:17:48.664720 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:17:48.705970 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m12:17:49.838318 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m12:17:49.838318 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m12:17:49.838318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:50.632694 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.791 seconds
[0m12:17:50.632694 [debug] [ThreadPool]: On list_telegram_db: Close
[0m12:17:50.648320 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_raw_analytics'
[0m12:17:50.667589 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m12:17:50.667589 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: BEGIN
[0m12:17:50.667589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:51.106571 [debug] [ThreadPool]: SQL status: BEGIN in 0.432 seconds
[0m12:17:51.108573 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m12:17:51.110573 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_analytics'
  
[0m12:17:51.159839 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.047 seconds
[0m12:17:51.164965 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: ROLLBACK
[0m12:17:51.167066 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: Close
[0m12:17:51.169785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db_raw_analytics, now list_telegram_db_raw_staging)
[0m12:17:51.173348 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m12:17:51.173348 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m12:17:51.173348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:51.317433 [debug] [ThreadPool]: SQL status: BEGIN in 0.137 seconds
[0m12:17:51.317433 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m12:17:51.317433 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m12:17:51.333059 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m12:17:51.333059 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m12:17:51.333059 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m12:17:51.348684 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:51.348684 [debug] [MainThread]: On master: BEGIN
[0m12:17:51.348684 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:51.450219 [debug] [MainThread]: SQL status: BEGIN in 0.101 seconds
[0m12:17:51.450219 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:51.450219 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:17:51.904405 [debug] [MainThread]: SQL status: SELECT 1 in 0.451 seconds
[0m12:17:51.904405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e381e5df-ca61-4b00-a42f-93c7e424000c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251BFC8DD00>]}
[0m12:17:51.920259 [debug] [MainThread]: On master: ROLLBACK
[0m12:17:51.921033 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:51.921033 [debug] [MainThread]: On master: BEGIN
[0m12:17:51.921033 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:17:51.921033 [debug] [MainThread]: On master: COMMIT
[0m12:17:51.921033 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:51.921033 [debug] [MainThread]: On master: COMMIT
[0m12:17:51.921033 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:51.938246 [debug] [MainThread]: On master: Close
[0m12:17:51.954647 [debug] [Thread-1 (]: Began running node model.telegram_dbt.stg_telegram_messages
[0m12:17:51.955649 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_staging.stg_telegram_messages .................. [RUN]
[0m12:17:51.958655 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_dbt.stg_telegram_messages'
[0m12:17:51.960840 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.stg_telegram_messages
[0m12:17:51.979727 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.stg_telegram_messages"
[0m12:17:51.991218 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.stg_telegram_messages
[0m12:17:52.170270 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.stg_telegram_messages"
[0m12:17:52.175273 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m12:17:52.177271 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: BEGIN
[0m12:17:52.181401 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:17:52.452012 [debug] [Thread-1 (]: SQL status: BEGIN in 0.272 seconds
[0m12:17:52.452012 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m12:17:52.452012 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */

  create view "telegram_db"."raw_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    -- models/staging/stg_telegram_messages.sql

with source as (
    select * from "telegram_db"."raw"."telegram_messages"
),

renamed as (
    select
        id::bigint as message_id,
        channel::text as channel_name,
        date::timestamp as message_date,
        message::text as message_text,
        has_media::boolean,
        media_type::text,
        image_path::text
    from source
)

select * from renamed
  );
[0m12:17:52.505186 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.053 seconds
[0m12:17:52.519376 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m12:17:52.519376 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */
alter table "telegram_db"."raw_staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m12:17:52.536108 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m12:17:52.536108 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m12:17:52.536108 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */
alter table "telegram_db"."raw_staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m12:17:52.555203 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m12:17:52.602435 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: COMMIT
[0m12:17:52.620070 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m12:17:52.620070 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: COMMIT
[0m12:17:52.620070 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:17:52.652296 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_staging"."stg_telegram_messages__dbt_backup"
[0m12:17:52.668981 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m12:17:52.668981 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */
drop view if exists "telegram_db"."raw_staging"."stg_telegram_messages__dbt_backup" cascade
[0m12:17:52.852608 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.185 seconds
[0m12:17:52.868991 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: Close
[0m12:17:52.868991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e381e5df-ca61-4b00-a42f-93c7e424000c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251BB6857F0>]}
[0m12:17:52.868991 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw_staging.stg_telegram_messages ............. [[32mCREATE VIEW[0m in 0.91s]
[0m12:17:52.868991 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.stg_telegram_messages
[0m12:17:52.868991 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:52.884897 [debug] [MainThread]: On master: BEGIN
[0m12:17:52.885875 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:53.041203 [debug] [MainThread]: SQL status: BEGIN in 0.153 seconds
[0m12:17:53.043204 [debug] [MainThread]: On master: COMMIT
[0m12:17:53.044200 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:53.046213 [debug] [MainThread]: On master: COMMIT
[0m12:17:53.048199 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:53.050207 [debug] [MainThread]: On master: Close
[0m12:17:53.051311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:53.051311 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m12:17:53.051311 [debug] [MainThread]: Connection 'list_telegram_db_raw_staging' was properly closed.
[0m12:17:53.051311 [debug] [MainThread]: Connection 'model.telegram_dbt.stg_telegram_messages' was properly closed.
[0m12:17:53.051311 [info ] [MainThread]: 
[0m12:17:53.051311 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.39 seconds (4.39s).
[0m12:17:53.066936 [debug] [MainThread]: Command end result
[0m12:17:53.155230 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\manifest.json
[0m12:17:53.162232 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\semantic_manifest.json
[0m12:17:53.184533 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\run_results.json
[0m12:17:53.184533 [info ] [MainThread]: 
[0m12:17:53.184533 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:53.184533 [info ] [MainThread]: 
[0m12:17:53.184533 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:17:53.207450 [debug] [MainThread]: Command `dbt run` succeeded at 12:17:53.204917 after 12.23 seconds
[0m12:17:53.208447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251BDFA5BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251BFEACDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251BDBC0B60>]}
[0m12:17:53.211444 [debug] [MainThread]: Flushing usage events
[0m12:18:04.516890 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:22:37.396706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015387C456A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001538A849970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001538AB566F0>]}


============================== 12:22:37.480863 | a1c2cb12-e36f-4404-ab54-0d3d8a95e7d9 ==============================
[0m12:22:37.480863 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:22:37.481933 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\user\\Desktop\\ETL-telegram-medical-pipeline\\dbt\\telegram_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\user\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:22:39.649005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1c2cb12-e36f-4404-ab54-0d3d8a95e7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001538BF57CB0>]}
[0m12:22:39.958612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1c2cb12-e36f-4404-ab54-0d3d8a95e7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001538BF9A720>]}
[0m12:22:39.958612 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:22:41.027910 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:22:42.119912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:22:42.119912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:22:42.201793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1c2cb12-e36f-4404-ab54-0d3d8a95e7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001538C4844D0>]}
[0m12:22:42.352309 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\manifest.json
[0m12:22:42.457045 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\semantic_manifest.json
[0m12:22:42.537077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1c2cb12-e36f-4404-ab54-0d3d8a95e7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001538C7FAC90>]}
[0m12:22:42.537077 [info ] [MainThread]: Found 4 models, 1 source, 433 macros
[0m12:22:42.552685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1c2cb12-e36f-4404-ab54-0d3d8a95e7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001538A59C830>]}
[0m12:22:42.552685 [info ] [MainThread]: 
[0m12:22:42.558692 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:22:42.560053 [info ] [MainThread]: 
[0m12:22:42.562054 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:22:42.575342 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m12:22:43.479778 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m12:22:43.479778 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m12:22:43.479778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:43.989481 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.509 seconds
[0m12:22:43.989481 [debug] [ThreadPool]: On list_telegram_db: Close
[0m12:22:44.005127 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m12:22:44.005127 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m12:22:44.005127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:44.120051 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.110 seconds
[0m12:22:44.120051 [debug] [ThreadPool]: On list_telegram_db: Close
[0m12:22:44.126562 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_raw_staging'
[0m12:22:44.142889 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m12:22:44.142889 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m12:22:44.142889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:44.327168 [debug] [ThreadPool]: SQL status: BEGIN in 0.173 seconds
[0m12:22:44.327168 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m12:22:44.327168 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m12:22:44.428174 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.107 seconds
[0m12:22:44.443798 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m12:22:44.443798 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m12:22:44.443798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db_raw_staging, now list_telegram_db_raw_analytics)
[0m12:22:44.459319 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m12:22:44.464862 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: BEGIN
[0m12:22:44.464862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:44.598126 [debug] [ThreadPool]: SQL status: BEGIN in 0.143 seconds
[0m12:22:44.598126 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m12:22:44.598126 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_analytics'
  
[0m12:22:44.629377 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.015 seconds
[0m12:22:44.629377 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: ROLLBACK
[0m12:22:44.629377 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: Close
[0m12:22:44.645005 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:44.645005 [debug] [MainThread]: On master: BEGIN
[0m12:22:44.645005 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:22:44.747150 [debug] [MainThread]: SQL status: BEGIN in 0.110 seconds
[0m12:22:44.747150 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:44.747150 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:22:45.025103 [debug] [MainThread]: SQL status: SELECT 1 in 0.267 seconds
[0m12:22:45.025103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1c2cb12-e36f-4404-ab54-0d3d8a95e7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001538A2A1520>]}
[0m12:22:45.025103 [debug] [MainThread]: On master: ROLLBACK
[0m12:22:45.025103 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:45.040730 [debug] [MainThread]: On master: BEGIN
[0m12:22:45.040730 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:22:45.040730 [debug] [MainThread]: On master: COMMIT
[0m12:22:45.040730 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:45.040730 [debug] [MainThread]: On master: COMMIT
[0m12:22:45.040730 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:22:45.040730 [debug] [MainThread]: On master: Close
[0m12:22:45.228024 [debug] [Thread-1 (]: Began running node model.telegram_dbt.dim_dates
[0m12:22:45.228024 [info ] [Thread-1 (]: 1 of 4 START sql table model raw_analytics.dim_dates ........................... [RUN]
[0m12:22:45.228024 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_dbt.dim_dates'
[0m12:22:45.228024 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.dim_dates
[0m12:22:45.266381 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.dim_dates"
[0m12:22:45.266381 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.dim_dates
[0m12:22:45.377674 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.dim_dates"
[0m12:22:45.380681 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m12:22:45.382256 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: BEGIN
[0m12:22:45.382256 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:22:45.488234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.104 seconds
[0m12:22:45.489250 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m12:22:45.490231 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */

  
    

  create  table "telegram_db"."raw_analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql

with dates as (
    select
        generate_series(
            date '2022-01-01',
            current_date,
            interval '1 day'
        )::date as date_day
),

dim_dates as (
    select
        date_day,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day,
        to_char(date_day, 'Day') as weekday
    from dates
)
 
select * from dim_dates
  );
  
[0m12:22:45.590940 [debug] [Thread-1 (]: SQL status: SELECT 1292 in 0.110 seconds
[0m12:22:45.622185 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m12:22:45.622185 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */
alter table "telegram_db"."raw_analytics"."dim_dates" rename to "dim_dates__dbt_backup"
[0m12:22:45.763455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.135 seconds
[0m12:22:45.763455 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m12:22:45.763455 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */
alter table "telegram_db"."raw_analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m12:22:45.763455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:22:45.810325 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: COMMIT
[0m12:22:45.825952 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m12:22:45.825952 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: COMMIT
[0m12:22:45.947893 [debug] [Thread-1 (]: SQL status: COMMIT in 0.118 seconds
[0m12:22:45.948410 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."dim_dates__dbt_backup"
[0m12:22:45.964054 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m12:22:45.964054 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */
drop table if exists "telegram_db"."raw_analytics"."dim_dates__dbt_backup" cascade
[0m12:22:46.104674 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.142 seconds
[0m12:22:46.120306 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: Close
[0m12:22:46.120306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1c2cb12-e36f-4404-ab54-0d3d8a95e7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015387D358E0>]}
[0m12:22:46.132822 [info ] [Thread-1 (]: 1 of 4 OK created sql table model raw_analytics.dim_dates ...................... [[32mSELECT 1292[0m in 0.89s]
[0m12:22:46.132822 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.dim_dates
[0m12:22:46.132822 [debug] [Thread-1 (]: Began running node model.telegram_dbt.stg_telegram_messages
[0m12:22:46.132822 [info ] [Thread-1 (]: 2 of 4 START sql view model raw_staging.stg_telegram_messages .................. [RUN]
[0m12:22:46.132822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_dbt.dim_dates, now model.telegram_dbt.stg_telegram_messages)
[0m12:22:46.149006 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.stg_telegram_messages
[0m12:22:46.149521 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.stg_telegram_messages"
[0m12:22:46.149521 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.stg_telegram_messages
[0m12:22:46.180789 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.stg_telegram_messages"
[0m12:22:46.180789 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m12:22:46.180789 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: BEGIN
[0m12:22:46.180789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:46.300397 [debug] [Thread-1 (]: SQL status: BEGIN in 0.109 seconds
[0m12:22:46.300397 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m12:22:46.300397 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */

  create view "telegram_db"."raw_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    -- models/staging/stg_telegram_messages.sql

with source as (
    select * from "telegram_db"."raw"."telegram_messages"
),

renamed as (
    select
        id::bigint as message_id,
        channel::text as channel_name,
        date::timestamp as message_date,
        message::text as message_text,
        has_media::boolean,
        media_type::text,
        image_path::text
    from source
)

select * from renamed
  );
[0m12:22:46.467136 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.163 seconds
[0m12:22:46.478897 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m12:22:46.481130 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */
alter table "telegram_db"."raw_staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m12:22:46.485601 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:22:46.499942 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m12:22:46.502540 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */
alter table "telegram_db"."raw_staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m12:22:46.509459 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:22:46.514486 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: COMMIT
[0m12:22:46.514486 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m12:22:46.514486 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: COMMIT
[0m12:22:46.659967 [debug] [Thread-1 (]: SQL status: COMMIT in 0.153 seconds
[0m12:22:46.684197 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_staging"."stg_telegram_messages__dbt_backup"
[0m12:22:46.695183 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m12:22:46.695183 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */
drop view if exists "telegram_db"."raw_staging"."stg_telegram_messages__dbt_backup" cascade
[0m12:22:46.828954 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.135 seconds
[0m12:22:46.828954 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: Close
[0m12:22:46.828954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1c2cb12-e36f-4404-ab54-0d3d8a95e7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001538CBC2A50>]}
[0m12:22:46.844580 [info ] [Thread-1 (]: 2 of 4 OK created sql view model raw_staging.stg_telegram_messages ............. [[32mCREATE VIEW[0m in 0.70s]
[0m12:22:46.844580 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.stg_telegram_messages
[0m12:22:46.844580 [debug] [Thread-1 (]: Began running node model.telegram_dbt.dim_channels
[0m12:22:46.844580 [info ] [Thread-1 (]: 3 of 4 START sql table model raw_analytics.dim_channels ........................ [RUN]
[0m12:22:46.844580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_dbt.stg_telegram_messages, now model.telegram_dbt.dim_channels)
[0m12:22:46.859956 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.dim_channels
[0m12:22:46.870266 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.dim_channels"
[0m12:22:46.873266 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.dim_channels
[0m12:22:46.881512 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.dim_channels"
[0m12:22:46.883769 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m12:22:46.883769 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: BEGIN
[0m12:22:46.883769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:47.105736 [debug] [Thread-1 (]: SQL status: BEGIN in 0.221 seconds
[0m12:22:47.105736 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m12:22:47.105736 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */

  
    

  create  table "telegram_db"."raw_analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_channels.sql

with messages as (
    select * from "telegram_db"."raw_staging"."stg_telegram_messages"
),

dim_channels as (
    select distinct
        channel_name as channel,
        md5(channel_name) as channel_id
    from messages
)

select * from dim_channels
  );
  
[0m12:22:47.167457 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.062 seconds
[0m12:22:47.183107 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m12:22:47.183107 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */
alter table "telegram_db"."raw_analytics"."dim_channels" rename to "dim_channels__dbt_backup"
[0m12:22:47.183107 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:22:47.198751 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m12:22:47.198751 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */
alter table "telegram_db"."raw_analytics"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m12:22:47.198751 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:22:47.198751 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: COMMIT
[0m12:22:47.198751 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m12:22:47.214358 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: COMMIT
[0m12:22:47.323765 [debug] [Thread-1 (]: SQL status: COMMIT in 0.118 seconds
[0m12:22:47.339616 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."dim_channels__dbt_backup"
[0m12:22:47.339616 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m12:22:47.339616 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */
drop table if exists "telegram_db"."raw_analytics"."dim_channels__dbt_backup" cascade
[0m12:22:47.492388 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.146 seconds
[0m12:22:47.496939 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: Close
[0m12:22:47.496939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1c2cb12-e36f-4404-ab54-0d3d8a95e7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001538CA68CB0>]}
[0m12:22:47.496939 [info ] [Thread-1 (]: 3 of 4 OK created sql table model raw_analytics.dim_channels ................... [[32mSELECT 0[0m in 0.65s]
[0m12:22:47.496939 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.dim_channels
[0m12:22:47.496939 [debug] [Thread-1 (]: Began running node model.telegram_dbt.fct_messages
[0m12:22:47.496939 [info ] [Thread-1 (]: 4 of 4 START sql table model raw_analytics.fct_messages ........................ [RUN]
[0m12:22:47.519452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_dbt.dim_channels, now model.telegram_dbt.fct_messages)
[0m12:22:47.521494 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.fct_messages
[0m12:22:47.533560 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.fct_messages"
[0m12:22:47.537671 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.fct_messages
[0m12:22:47.545313 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.fct_messages"
[0m12:22:47.548196 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m12:22:47.551196 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: BEGIN
[0m12:22:47.554199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:47.664016 [debug] [Thread-1 (]: SQL status: BEGIN in 0.124 seconds
[0m12:22:47.680414 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m12:22:47.683418 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */

  
    

  create  table "telegram_db"."raw_analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fct_messages.sql

with messages as (
    select * from "telegram_db"."raw_staging"."stg_telegram_messages"
),

fct as (
    select
        md5(channel_name) as channel_id,
        message_date::date as date_day,
        message_id,
        length(message_text) as message_length,
        has_media,
        media_type
    from messages
)
 
select * from fct
  );
  
[0m12:22:47.800531 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.127 seconds
[0m12:22:47.816015 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m12:22:47.816015 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
alter table "telegram_db"."raw_analytics"."fct_messages" rename to "fct_messages__dbt_backup"
[0m12:22:47.816015 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:22:47.816015 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m12:22:47.816015 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
alter table "telegram_db"."raw_analytics"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m12:22:47.831679 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:22:47.831679 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: COMMIT
[0m12:22:47.831679 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m12:22:47.831679 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: COMMIT
[0m12:22:47.847269 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m12:22:47.847269 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."fct_messages__dbt_backup"
[0m12:22:47.862901 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m12:22:47.862901 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
drop table if exists "telegram_db"."raw_analytics"."fct_messages__dbt_backup" cascade
[0m12:22:47.878515 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m12:22:47.878515 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: Close
[0m12:22:47.878515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1c2cb12-e36f-4404-ab54-0d3d8a95e7d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001538CA691F0>]}
[0m12:22:47.878515 [info ] [Thread-1 (]: 4 of 4 OK created sql table model raw_analytics.fct_messages ................... [[32mSELECT 0[0m in 0.37s]
[0m12:22:47.894147 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.fct_messages
[0m12:22:47.894147 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:47.894147 [debug] [MainThread]: On master: BEGIN
[0m12:22:47.894147 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:22:48.033959 [debug] [MainThread]: SQL status: BEGIN in 0.131 seconds
[0m12:22:48.035958 [debug] [MainThread]: On master: COMMIT
[0m12:22:48.036959 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:48.037958 [debug] [MainThread]: On master: COMMIT
[0m12:22:48.038961 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:22:48.040957 [debug] [MainThread]: On master: Close
[0m12:22:48.041959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:48.043959 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m12:22:48.045881 [debug] [MainThread]: Connection 'list_telegram_db_raw_analytics' was properly closed.
[0m12:22:48.047074 [debug] [MainThread]: Connection 'model.telegram_dbt.fct_messages' was properly closed.
[0m12:22:48.047074 [info ] [MainThread]: 
[0m12:22:48.047074 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 5.49 seconds (5.49s).
[0m12:22:48.047074 [debug] [MainThread]: Command end result
[0m12:22:48.163376 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\manifest.json
[0m12:22:48.167374 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\semantic_manifest.json
[0m12:22:48.179375 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\run_results.json
[0m12:22:48.180375 [info ] [MainThread]: 
[0m12:22:48.181433 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:22:48.181433 [info ] [MainThread]: 
[0m12:22:48.181433 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m12:22:48.181433 [debug] [MainThread]: Command `dbt run` succeeded at 12:22:48.181433 after 11.07 seconds
[0m12:22:48.181433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015387C456A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001538AEFDCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001538C6893D0>]}
[0m12:22:48.181433 [debug] [MainThread]: Flushing usage events
[0m12:22:59.418347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:23:16.278614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025578289790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255754CB260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025577FCE1B0>]}


============================== 12:23:16.292791 | fc101203-648d-4221-bbd9-3e575cb1c190 ==============================
[0m12:23:16.292791 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:23:16.294794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\user\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\user\\Desktop\\ETL-telegram-medical-pipeline\\dbt\\telegram_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select core', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:23:17.403368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc101203-648d-4221-bbd9-3e575cb1c190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002557825D400>]}
[0m12:23:17.731207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc101203-648d-4221-bbd9-3e575cb1c190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025579E20CB0>]}
[0m12:23:17.734383 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:23:18.328018 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:23:19.038545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:23:19.038545 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:23:19.129907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc101203-648d-4221-bbd9-3e575cb1c190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025579DE5910>]}
[0m12:23:19.362040 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\manifest.json
[0m12:23:19.370760 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\semantic_manifest.json
[0m12:23:19.454937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc101203-648d-4221-bbd9-3e575cb1c190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002557A15BD10>]}
[0m12:23:19.456935 [info ] [MainThread]: Found 4 models, 1 source, 433 macros
[0m12:23:19.458934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc101203-648d-4221-bbd9-3e575cb1c190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255785352B0>]}
[0m12:23:19.461938 [warn ] [MainThread]: The selection criterion 'core' does not match any enabled nodes
[0m12:23:19.466938 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:23:19.480561 [debug] [MainThread]: Command end result
[0m12:23:19.642149 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\manifest.json
[0m12:23:19.649148 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\semantic_manifest.json
[0m12:23:19.660788 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\run_results.json
[0m12:23:19.664788 [debug] [MainThread]: Command `dbt run` succeeded at 12:23:19.664788 after 3.74 seconds
[0m12:23:19.665792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025579FDB8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025578729340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025579DE5580>]}
[0m12:23:19.668439 [debug] [MainThread]: Flushing usage events
[0m12:23:29.238239 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:25:02.104396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001897EEB7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018902A2BB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018902A28CB0>]}


============================== 12:25:02.104396 | 9ebdd1ff-3ca3-4eb4-b098-37164d5ae4fb ==============================
[0m12:25:02.104396 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:25:02.120011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\user\\Desktop\\ETL-telegram-medical-pipeline\\dbt\\telegram_dbt\\logs', 'profiles_dir': 'C:\\Users\\user\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ls', 'send_anonymous_usage_stats': 'True'}
[0m12:25:05.621470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ebdd1ff-3ca3-4eb4-b098-37164d5ae4fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018903C77F80>]}
[0m12:25:05.957797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ebdd1ff-3ca3-4eb4-b098-37164d5ae4fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018903FBE1B0>]}
[0m12:25:05.957797 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:25:06.871285 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:25:07.907512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:25:07.907512 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:25:08.043270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ebdd1ff-3ca3-4eb4-b098-37164d5ae4fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018904269EB0>]}
[0m12:25:08.256725 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\manifest.json
[0m12:25:08.324386 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\semantic_manifest.json
[0m12:25:08.417262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ebdd1ff-3ca3-4eb4-b098-37164d5ae4fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018904268560>]}
[0m12:25:08.417262 [info ] [MainThread]: Found 4 models, 1 source, 433 macros
[0m12:25:08.417262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ebdd1ff-3ca3-4eb4-b098-37164d5ae4fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018903BACC80>]}
[0m12:25:08.432889 [info ] [MainThread]: telegram_dbt.marts.dim_channels
[0m12:25:08.438897 [info ] [MainThread]: telegram_dbt.marts.dim_dates
[0m12:25:08.441080 [info ] [MainThread]: telegram_dbt.marts.fct_messages
[0m12:25:08.444085 [info ] [MainThread]: telegram_dbt.staging.stg_telegram_messages
[0m12:25:08.446082 [info ] [MainThread]: source:telegram_dbt.raw.telegram_messages
[0m12:25:08.453630 [debug] [MainThread]: Command `dbt ls` succeeded at 12:25:08.452778 after 6.78 seconds
[0m12:25:08.458170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018902950080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018903BACC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018903C77860>]}
[0m12:25:08.459171 [debug] [MainThread]: Flushing usage events
[0m12:25:19.772622 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:27:25.091281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160BFF49B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160BFD4E1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160BD18B380>]}


============================== 12:27:25.104813 | ce2081ef-e371-431c-a79c-bc4a5e00f1d0 ==============================
[0m12:27:25.104813 [info ] [MainThread]: Running with dbt=1.10.4
[0m12:27:25.106815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\user\\.dbt', 'log_path': 'C:\\Users\\user\\Desktop\\ETL-telegram-medical-pipeline\\dbt\\telegram_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select marts', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:27:26.037715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce2081ef-e371-431c-a79c-bc4a5e00f1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160BF4356A0>]}
[0m12:27:26.246596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce2081ef-e371-431c-a79c-bc4a5e00f1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160BF55F5C0>]}
[0m12:27:26.249542 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:27:27.459341 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m12:27:28.440080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:27:28.489141 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:27:28.716688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce2081ef-e371-431c-a79c-bc4a5e00f1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160C1B6D880>]}
[0m12:27:29.084288 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\manifest.json
[0m12:27:29.091231 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\semantic_manifest.json
[0m12:27:29.259777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce2081ef-e371-431c-a79c-bc4a5e00f1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160C1EAAD20>]}
[0m12:27:29.261766 [info ] [MainThread]: Found 4 models, 1 source, 433 macros
[0m12:27:29.263766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce2081ef-e371-431c-a79c-bc4a5e00f1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160C1B34D70>]}
[0m12:27:29.267789 [info ] [MainThread]: 
[0m12:27:29.269767 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:27:29.273039 [info ] [MainThread]: 
[0m12:27:29.276035 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:27:29.294370 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m12:27:30.553787 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m12:27:30.553787 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m12:27:30.553787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:31.108378 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.541 seconds
[0m12:27:31.110350 [debug] [ThreadPool]: On list_telegram_db: Close
[0m12:27:31.110350 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_raw_staging'
[0m12:27:31.126538 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m12:27:31.126538 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m12:27:31.126538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:31.291991 [debug] [ThreadPool]: SQL status: BEGIN in 0.167 seconds
[0m12:27:31.306067 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m12:27:31.309053 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m12:27:31.396740 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.086 seconds
[0m12:27:31.402414 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m12:27:31.406415 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m12:27:31.408937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db_raw_staging, now list_telegram_db_raw_analytics)
[0m12:27:31.419265 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m12:27:31.423265 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: BEGIN
[0m12:27:31.425264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:31.613124 [debug] [ThreadPool]: SQL status: BEGIN in 0.188 seconds
[0m12:27:31.614786 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m12:27:31.614786 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_analytics'
  
[0m12:27:31.640775 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.016 seconds
[0m12:27:31.644858 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: ROLLBACK
[0m12:27:31.647242 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: Close
[0m12:27:31.664935 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:31.665922 [debug] [MainThread]: On master: BEGIN
[0m12:27:31.667920 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:27:31.789379 [debug] [MainThread]: SQL status: BEGIN in 0.122 seconds
[0m12:27:31.791381 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:31.793381 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:27:31.968408 [debug] [MainThread]: SQL status: SELECT 1 in 0.182 seconds
[0m12:27:31.968408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce2081ef-e371-431c-a79c-bc4a5e00f1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160C1E699D0>]}
[0m12:27:31.968408 [debug] [MainThread]: On master: ROLLBACK
[0m12:27:31.968408 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:31.984035 [debug] [MainThread]: On master: BEGIN
[0m12:27:31.984035 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:27:31.984035 [debug] [MainThread]: On master: COMMIT
[0m12:27:31.984035 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:31.984035 [debug] [MainThread]: On master: COMMIT
[0m12:27:31.999659 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:27:31.999659 [debug] [MainThread]: On master: Close
[0m12:27:32.015290 [debug] [Thread-1 (]: Began running node model.telegram_dbt.dim_channels
[0m12:27:32.015290 [info ] [Thread-1 (]: 1 of 3 START sql table model raw_analytics.dim_channels ........................ [RUN]
[0m12:27:32.015290 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.telegram_dbt.dim_channels'
[0m12:27:32.015290 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.dim_channels
[0m12:27:32.045260 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.dim_channels"
[0m12:27:32.050237 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.dim_channels
[0m12:27:32.196057 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.dim_channels"
[0m12:27:32.200058 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m12:27:32.201842 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: BEGIN
[0m12:27:32.203843 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:27:32.320495 [debug] [Thread-1 (]: SQL status: BEGIN in 0.124 seconds
[0m12:27:32.329510 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m12:27:32.329510 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */

  
    

  create  table "telegram_db"."raw_analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_channels.sql

with messages as (
    select * from "telegram_db"."raw_staging"."stg_telegram_messages"
),

dim_channels as (
    select distinct
        channel_name as channel,
        md5(channel_name) as channel_id
    from messages
)

select * from dim_channels
  );
  
[0m12:27:32.392843 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.063 seconds
[0m12:27:32.408474 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m12:27:32.408474 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */
alter table "telegram_db"."raw_analytics"."dim_channels" rename to "dim_channels__dbt_backup"
[0m12:27:32.553427 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.128 seconds
[0m12:27:32.556584 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m12:27:32.556584 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */
alter table "telegram_db"."raw_analytics"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m12:27:32.568643 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:27:32.618602 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: COMMIT
[0m12:27:32.618602 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m12:27:32.618602 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: COMMIT
[0m12:27:32.702388 [debug] [Thread-1 (]: SQL status: COMMIT in 0.083 seconds
[0m12:27:32.735024 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."dim_channels__dbt_backup"
[0m12:27:32.751811 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m12:27:32.751811 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */
drop table if exists "telegram_db"."raw_analytics"."dim_channels__dbt_backup" cascade
[0m12:27:32.889014 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.126 seconds
[0m12:27:32.900934 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: Close
[0m12:27:32.907010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce2081ef-e371-431c-a79c-bc4a5e00f1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160BD3D58B0>]}
[0m12:27:32.907010 [info ] [Thread-1 (]: 1 of 3 OK created sql table model raw_analytics.dim_channels ................... [[32mSELECT 0[0m in 0.89s]
[0m12:27:32.907010 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.dim_channels
[0m12:27:32.907010 [debug] [Thread-1 (]: Began running node model.telegram_dbt.dim_dates
[0m12:27:32.920949 [info ] [Thread-1 (]: 2 of 3 START sql table model raw_analytics.dim_dates ........................... [RUN]
[0m12:27:32.922945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_dbt.dim_channels, now model.telegram_dbt.dim_dates)
[0m12:27:32.924942 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.dim_dates
[0m12:27:32.934261 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.dim_dates"
[0m12:27:32.938038 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.dim_dates
[0m12:27:32.955417 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.dim_dates"
[0m12:27:32.958418 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m12:27:32.960271 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: BEGIN
[0m12:27:32.968672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:33.079946 [debug] [Thread-1 (]: SQL status: BEGIN in 0.115 seconds
[0m12:27:33.079946 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m12:27:33.079946 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */

  
    

  create  table "telegram_db"."raw_analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql

with dates as (
    select
        generate_series(
            date '2022-01-01',
            current_date,
            interval '1 day'
        )::date as date_day
),

dim_dates as (
    select
        date_day,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day,
        to_char(date_day, 'Day') as weekday
    from dates
)
 
select * from dim_dates
  );
  
[0m12:27:33.280294 [debug] [Thread-1 (]: SQL status: SELECT 1292 in 0.196 seconds
[0m12:27:33.290735 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m12:27:33.290735 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */
alter table "telegram_db"."raw_analytics"."dim_dates" rename to "dim_dates__dbt_backup"
[0m12:27:33.290735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:27:33.306373 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m12:27:33.306373 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */
alter table "telegram_db"."raw_analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m12:27:33.306373 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:27:33.322000 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: COMMIT
[0m12:27:33.322000 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m12:27:33.322000 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: COMMIT
[0m12:27:33.332018 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m12:27:33.348522 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."dim_dates__dbt_backup"
[0m12:27:33.348522 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m12:27:33.348522 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */
drop table if exists "telegram_db"."raw_analytics"."dim_dates__dbt_backup" cascade
[0m12:27:33.364163 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m12:27:33.364163 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: Close
[0m12:27:33.364163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce2081ef-e371-431c-a79c-bc4a5e00f1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160C21C3E60>]}
[0m12:27:33.364163 [info ] [Thread-1 (]: 2 of 3 OK created sql table model raw_analytics.dim_dates ...................... [[32mSELECT 1292[0m in 0.44s]
[0m12:27:33.379788 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.dim_dates
[0m12:27:33.379788 [debug] [Thread-1 (]: Began running node model.telegram_dbt.fct_messages
[0m12:27:33.379788 [info ] [Thread-1 (]: 3 of 3 START sql table model raw_analytics.fct_messages ........................ [RUN]
[0m12:27:33.390736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_dbt.dim_dates, now model.telegram_dbt.fct_messages)
[0m12:27:33.393711 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.fct_messages
[0m12:27:33.406271 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.fct_messages"
[0m12:27:33.409272 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.fct_messages
[0m12:27:33.420263 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.fct_messages"
[0m12:27:33.420263 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m12:27:33.435654 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: BEGIN
[0m12:27:33.435654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:33.533290 [debug] [Thread-1 (]: SQL status: BEGIN in 0.104 seconds
[0m12:27:33.533290 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m12:27:33.533290 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */

  
    

  create  table "telegram_db"."raw_analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fct_messages.sql

with messages as (
    select * from "telegram_db"."raw_staging"."stg_telegram_messages"
),

fct as (
    select
        md5(channel_name) as channel_id,
        message_date::date as date_day,
        message_id,
        length(message_text) as message_length,
        has_media,
        media_type
    from messages
)
 
select * from fct
  );
  
[0m12:27:33.707712 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.173 seconds
[0m12:27:33.732893 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m12:27:33.732893 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
alter table "telegram_db"."raw_analytics"."fct_messages" rename to "fct_messages__dbt_backup"
[0m12:27:33.732893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:27:33.751884 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m12:27:33.751884 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
alter table "telegram_db"."raw_analytics"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m12:27:33.751884 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:27:33.751884 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: COMMIT
[0m12:27:33.767530 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m12:27:33.767530 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: COMMIT
[0m12:27:33.919099 [debug] [Thread-1 (]: SQL status: COMMIT in 0.148 seconds
[0m12:27:33.920180 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."fct_messages__dbt_backup"
[0m12:27:33.920180 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m12:27:33.920180 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
drop table if exists "telegram_db"."raw_analytics"."fct_messages__dbt_backup" cascade
[0m12:27:34.150795 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.221 seconds
[0m12:27:34.150795 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: Close
[0m12:27:34.150795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce2081ef-e371-431c-a79c-bc4a5e00f1d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160C1D80A10>]}
[0m12:27:34.150795 [info ] [Thread-1 (]: 3 of 3 OK created sql table model raw_analytics.fct_messages ................... [[32mSELECT 0[0m in 0.77s]
[0m12:27:34.367345 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.fct_messages
[0m12:27:34.367345 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:34.382948 [debug] [MainThread]: On master: BEGIN
[0m12:27:34.382948 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:27:34.494409 [debug] [MainThread]: SQL status: BEGIN in 0.115 seconds
[0m12:27:34.494409 [debug] [MainThread]: On master: COMMIT
[0m12:27:34.494409 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:34.494409 [debug] [MainThread]: On master: COMMIT
[0m12:27:34.494409 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:27:34.494409 [debug] [MainThread]: On master: Close
[0m12:27:34.510051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:34.510051 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m12:27:34.510051 [debug] [MainThread]: Connection 'list_telegram_db_raw_analytics' was properly closed.
[0m12:27:34.510051 [debug] [MainThread]: Connection 'model.telegram_dbt.fct_messages' was properly closed.
[0m12:27:34.510051 [info ] [MainThread]: 
[0m12:27:34.510051 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m12:27:34.510051 [debug] [MainThread]: Command end result
[0m12:27:34.567500 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\manifest.json
[0m12:27:34.567500 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\semantic_manifest.json
[0m12:27:34.592960 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\user\Desktop\ETL-telegram-medical-pipeline\dbt\telegram_dbt\target\run_results.json
[0m12:27:34.594958 [info ] [MainThread]: 
[0m12:27:34.596959 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:27:34.597958 [info ] [MainThread]: 
[0m12:27:34.599614 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m12:27:34.604057 [debug] [MainThread]: Command `dbt run` succeeded at 12:27:34.604057 after 9.83 seconds
[0m12:27:34.605056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160C01F7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160BFD1EE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160C1EB0680>]}
[0m12:27:34.606054 [debug] [MainThread]: Flushing usage events
[0m12:27:34.612055 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:03:47.893849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f3cd9c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f3bd0e920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f3bd0e980>]}


============================== 10:03:47.920154 | c88ef155-50d3-43c8-816a-14178441d827 ==============================
[0m10:03:47.920154 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:03:47.924574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/app/dbt/telegram_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m10:03:49.046675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c88ef155-50d3-43c8-816a-14178441d827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f3e8244f0>]}
[0m10:03:49.207983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c88ef155-50d3-43c8-816a-14178441d827', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f3c5ae1a0>]}
[0m10:03:49.263512 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:03:49.533851 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m10:03:51.506806 [debug] [MainThread]: Partial parsing enabled: 131 files deleted, 131 files added, 0 files changed.
[0m10:03:51.509559 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/drop.sql
[0m10:03:51.511932 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/materialized_view.sql
[0m10:03:51.514382 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/not_null.sql
[0m10:03:51.516788 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/configs.sql
[0m10:03:51.518981 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/replace.sql
[0m10:03:51.521059 [debug] [MainThread]: Partial parsing: added file: telegram_dbt://models/staging/stg_telegram_messages.sql
[0m10:03:51.523162 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/any_value.sql
[0m10:03:51.525141 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/rename.sql
[0m10:03:51.527318 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/equals.sql
[0m10:03:51.529813 [debug] [MainThread]: Partial parsing: added file: dbt://macros/unit_test_sql/get_fixture_sql.sql
[0m10:03:51.532367 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/length.sql
[0m10:03:51.534750 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/data_types.sql
[0m10:03:51.536879 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/alter.sql
[0m10:03:51.539246 [debug] [MainThread]: Partial parsing: added file: dbt://macros/python_model/python.sql
[0m10:03:51.541533 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/relation.sql
[0m10:03:51.543560 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/helpers.sql
[0m10:03:51.545588 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/rename.sql
[0m10:03:51.547568 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/drop.sql
[0m10:03:51.549856 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/drop.sql
[0m10:03:51.552590 [debug] [MainThread]: Partial parsing: added file: telegram_dbt://models/marts/dim_channels.sql
[0m10:03:51.554774 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/apply_grants.sql
[0m10:03:51.556931 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/on_schema_change.sql
[0m10:03:51.559058 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/drop.sql
[0m10:03:51.561420 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/unit.sql
[0m10:03:51.563455 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/snapshot.sql
[0m10:03:51.565605 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/replace.sql
[0m10:03:51.567647 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_schema.sql
[0m10:03:51.569759 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/replace.sql
[0m10:03:51.571881 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_concat.sql
[0m10:03:51.573868 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_alias.sql
[0m10:03:51.576008 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/cast.sql
[0m10:03:51.578085 [debug] [MainThread]: Partial parsing: added file: dbt://docs/overview.md
[0m10:03:51.580184 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/concat.sql
[0m10:03:51.582177 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create.sql
[0m10:03:51.584607 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date.sql
[0m10:03:51.587093 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/rename.sql
[0m10:03:51.589379 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/strategies.sql
[0m10:03:51.591422 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/where_subquery.sql
[0m10:03:51.593546 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/create.sql
[0m10:03:51.595940 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/last_day.sql
[0m10:03:51.598173 [debug] [MainThread]: Partial parsing: added file: dbt://tests/generic/builtin.sql
[0m10:03:51.600665 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/listagg.sql
[0m10:03:51.602677 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/rename.sql
[0m10:03:51.605420 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/right.sql
[0m10:03:51.607642 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/relationships.sql
[0m10:03:51.609549 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_append.sql
[0m10:03:51.611448 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/test.sql
[0m10:03:51.613527 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/unique.sql
[0m10:03:51.615535 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/bool_or.sql
[0m10:03:51.617448 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/adapters.sql
[0m10:03:51.619555 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/replace.sql
[0m10:03:51.621378 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/rename.sql
[0m10:03:51.623308 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/except.sql
[0m10:03:51.625169 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/listagg.sql
[0m10:03:51.627063 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/seeds/helpers.sql
[0m10:03:51.628927 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/replace.sql
[0m10:03:51.631003 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/schema.sql
[0m10:03:51.632936 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/literal.sql
[0m10:03:51.634987 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/columns_spec_ddl.sql
[0m10:03:51.636819 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/escape_single_quotes.sql
[0m10:03:51.638699 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/validate_sql.sql
[0m10:03:51.640579 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/rename.sql
[0m10:03:51.642589 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/indexes.sql
[0m10:03:51.644704 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/timestamps.sql
[0m10:03:51.646649 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/rename_intermediate.sql
[0m10:03:51.648381 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/view.sql
[0m10:03:51.650171 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/refresh.sql
[0m10:03:51.651900 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/intersect.sql
[0m10:03:51.653757 [debug] [MainThread]: Partial parsing: added file: telegram_dbt://models/marts/fct_messages.sql
[0m10:03:51.655734 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/split_part.sql
[0m10:03:51.658920 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/materializations/snapshot_merge.sql
[0m10:03:51.661098 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/column/columns_spec_ddl.sql
[0m10:03:51.663244 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/drop_backup.sql
[0m10:03:51.665948 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/materializations/incremental_strategies.sql
[0m10:03:51.668256 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/rename.sql
[0m10:03:51.670565 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/seeds/seed.sql
[0m10:03:51.672422 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/incremental.sql
[0m10:03:51.674338 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/clone.sql
[0m10:03:51.676189 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/columns.sql
[0m10:03:51.678081 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/snapshot_merge.sql
[0m10:03:51.680955 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/strategies.sql
[0m10:03:51.683076 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/safe_cast.sql
[0m10:03:51.685019 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/dateadd.sql
[0m10:03:51.686870 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/create_or_replace_clone.sql
[0m10:03:51.688626 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/split_part.sql
[0m10:03:51.690464 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/column_helpers.sql
[0m10:03:51.692293 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/schema.sql
[0m10:03:51.694480 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_construct.sql
[0m10:03:51.696722 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/helpers.sql
[0m10:03:51.698724 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_database.sql
[0m10:03:51.700524 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/create.sql
[0m10:03:51.702398 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/replace.sql
[0m10:03:51.704168 [debug] [MainThread]: Partial parsing: added file: dbt://macros/etc/statement.sql
[0m10:03:51.706075 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/table.sql
[0m10:03:51.707910 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/any_value.sql
[0m10:03:51.709952 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/position.sql
[0m10:03:51.711831 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/drop.sql
[0m10:03:51.713920 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/hooks.sql
[0m10:03:51.715730 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/persist_docs.sql
[0m10:03:51.717519 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/accepted_values.sql
[0m10:03:51.719415 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date_spine.sql
[0m10:03:51.721386 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/alter.sql
[0m10:03:51.723227 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/describe.sql
[0m10:03:51.725089 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/dateadd.sql
[0m10:03:51.726862 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/cast_bool_to_text.sql
[0m10:03:51.728666 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date_trunc.sql
[0m10:03:51.730385 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/drop.sql
[0m10:03:51.732291 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/refresh.sql
[0m10:03:51.734257 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/merge.sql
[0m10:03:51.736196 [debug] [MainThread]: Partial parsing: added file: telegram_dbt://models/raw_sources.yml
[0m10:03:51.738041 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/show.sql
[0m10:03:51.739844 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/datediff.sql
[0m10:03:51.741792 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/drop.sql
[0m10:03:51.743734 [debug] [MainThread]: Partial parsing: added file: dbt://macros/etc/datetime.sql
[0m10:03:51.745646 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/datediff.sql
[0m10:03:51.747685 [debug] [MainThread]: Partial parsing: added file: telegram_dbt://models/marts/dim_dates.sql
[0m10:03:51.749467 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/catalog.sql
[0m10:03:51.751315 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations.sql
[0m10:03:51.753066 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/generate_series.sql
[0m10:03:51.754876 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/hash.sql
[0m10:03:51.756686 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/replace.sql
[0m10:03:51.759044 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create_backup.sql
[0m10:03:51.760851 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create_intermediate.sql
[0m10:03:51.762849 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/timestamps.sql
[0m10:03:51.764790 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/create.sql
[0m10:03:51.766637 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/create.sql
[0m10:03:51.768441 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/is_incremental.sql
[0m10:03:51.770489 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/last_day.sql
[0m10:03:51.772556 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/can_clone_table.sql
[0m10:03:51.774608 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/metadata.sql
[0m10:03:51.776424 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/freshness.sql
[0m10:03:51.778305 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\last_day.sql
[0m10:03:51.780074 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\dateadd.sql
[0m10:03:51.781939 [debug] [MainThread]: Partial parsing: deleted file: telegram_dbt://models\marts\fct_messages.sql
[0m10:03:51.784046 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\refresh.sql
[0m10:03:51.785969 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\describe.sql
[0m10:03:51.787836 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\rename.sql
[0m10:03:51.789837 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\indexes.sql
[0m10:03:51.791641 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\literal.sql
[0m10:03:51.793366 [debug] [MainThread]: Partial parsing: deleted file: dbt://docs\overview.md
[0m10:03:51.795204 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\materializations\snapshot_merge.sql
[0m10:03:51.797300 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\strategies.sql
[0m10:03:51.799028 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\any_value.sql
[0m10:03:51.800803 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\replace.sql
[0m10:03:51.802589 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\listagg.sql
[0m10:03:51.804637 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\columns_spec_ddl.sql
[0m10:03:51.810233 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\refresh.sql
[0m10:03:51.812840 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\validate_sql.sql
[0m10:03:51.815675 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\length.sql
[0m10:03:51.817661 [debug] [MainThread]: Partial parsing: deleted file: telegram_dbt://models\marts\dim_channels.sql
[0m10:03:51.819532 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\replace.sql
[0m10:03:51.821431 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date_spine.sql
[0m10:03:51.823277 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\is_incremental.sql
[0m10:03:51.825160 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\drop.sql
[0m10:03:51.826955 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\snapshot_merge.sql
[0m10:03:51.830670 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\replace.sql
[0m10:03:51.833048 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\metadata.sql
[0m10:03:51.834925 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_database.sql
[0m10:03:51.837085 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create.sql
[0m10:03:51.839134 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\python_model\python.sql
[0m10:03:51.840928 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\split_part.sql
[0m10:03:51.842875 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\seeds\seed.sql
[0m10:03:51.845016 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\catalog.sql
[0m10:03:51.847115 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\hooks.sql
[0m10:03:51.848927 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\incremental.sql
[0m10:03:51.850935 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\relation.sql
[0m10:03:51.852921 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\freshness.sql
[0m10:03:51.855043 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create_backup.sql
[0m10:03:51.857163 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\position.sql
[0m10:03:51.859132 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_alias.sql
[0m10:03:51.861519 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\any_value.sql
[0m10:03:51.863587 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\rename.sql
[0m10:03:51.865558 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\rename.sql
[0m10:03:51.868267 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\columns.sql
[0m10:03:51.870260 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\replace.sql
[0m10:03:51.872148 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\etc\datetime.sql
[0m10:03:51.873847 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\intersect.sql
[0m10:03:51.875678 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\snapshot.sql
[0m10:03:51.877654 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\column_helpers.sql
[0m10:03:51.880246 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\adapters.sql
[0m10:03:51.882394 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\create.sql
[0m10:03:51.884270 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\datediff.sql
[0m10:03:51.886023 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\schema.sql
[0m10:03:51.888585 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\column\columns_spec_ddl.sql
[0m10:03:51.890425 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\show.sql
[0m10:03:51.892202 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\schema.sql
[0m10:03:51.894195 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\materializations\incremental_strategies.sql
[0m10:03:51.896506 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\drop_backup.sql
[0m10:03:51.898381 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\rename.sql
[0m10:03:51.900146 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\create_or_replace_clone.sql
[0m10:03:51.901849 [debug] [MainThread]: Partial parsing: deleted file: dbt://tests\generic\builtin.sql
[0m10:03:51.903755 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\strategies.sql
[0m10:03:51.905646 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\rename_intermediate.sql
[0m10:03:51.907794 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\etc\statement.sql
[0m10:03:51.910076 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\create.sql
[0m10:03:51.911943 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\unit.sql
[0m10:03:51.914029 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\last_day.sql
[0m10:03:51.916502 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\datediff.sql
[0m10:03:51.918938 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\helpers.sql
[0m10:03:51.921343 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\unit_test_sql\get_fixture_sql.sql
[0m10:03:51.923701 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\helpers.sql
[0m10:03:51.925824 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\split_part.sql
[0m10:03:51.928055 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\apply_grants.sql
[0m10:03:51.929789 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\clone.sql
[0m10:03:51.931644 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\merge.sql
[0m10:03:51.933458 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\right.sql
[0m10:03:51.936011 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\cast_bool_to_text.sql
[0m10:03:51.937916 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\timestamps.sql
[0m10:03:51.939770 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\replace.sql
[0m10:03:51.941669 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\replace.sql
[0m10:03:51.943537 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\drop.sql
[0m10:03:51.945445 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date_trunc.sql
[0m10:03:51.947336 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\relationships.sql
[0m10:03:51.949266 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\on_schema_change.sql
[0m10:03:51.951123 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\drop.sql
[0m10:03:51.952935 [debug] [MainThread]: Partial parsing: deleted file: telegram_dbt://models\marts\dim_dates.sql
[0m10:03:51.954738 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\listagg.sql
[0m10:03:51.958407 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\hash.sql
[0m10:03:51.960566 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\view.sql
[0m10:03:51.962528 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\concat.sql
[0m10:03:51.964365 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\escape_single_quotes.sql
[0m10:03:51.966270 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create_intermediate.sql
[0m10:03:51.968063 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\table.sql
[0m10:03:51.969929 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\can_clone_table.sql
[0m10:03:51.971821 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations.sql
[0m10:03:51.973878 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\rename.sql
[0m10:03:51.975670 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\equals.sql
[0m10:03:51.978039 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\create.sql
[0m10:03:51.980451 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\create.sql
[0m10:03:51.982654 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\materialized_view.sql
[0m10:03:51.984810 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_append.sql
[0m10:03:51.987092 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_schema.sql
[0m10:03:51.989066 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_construct.sql
[0m10:03:51.991050 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\configs.sql
[0m10:03:51.992874 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\seeds\helpers.sql
[0m10:03:51.994673 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\not_null.sql
[0m10:03:51.996457 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\drop.sql
[0m10:03:51.998350 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\test.sql
[0m10:03:52.000573 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\persist_docs.sql
[0m10:03:52.002415 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_concat.sql
[0m10:03:52.004604 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date.sql
[0m10:03:52.006404 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\alter.sql
[0m10:03:52.008218 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\drop.sql
[0m10:03:52.010171 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\except.sql
[0m10:03:52.012183 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\bool_or.sql
[0m10:03:52.014110 [debug] [MainThread]: Partial parsing: deleted file: telegram_dbt://models\staging\stg_telegram_messages.sql
[0m10:03:52.016085 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\drop.sql
[0m10:03:52.017834 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\safe_cast.sql
[0m10:03:52.019669 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\rename.sql
[0m10:03:52.021557 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\rename.sql
[0m10:03:52.023686 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\replace.sql
[0m10:03:52.025827 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\drop.sql
[0m10:03:52.027684 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\cast.sql
[0m10:03:52.029558 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\alter.sql
[0m10:03:52.031317 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\timestamps.sql
[0m10:03:52.033199 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\unique.sql
[0m10:03:52.034900 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\accepted_values.sql
[0m10:03:52.036913 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\where_subquery.sql
[0m10:03:52.038741 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\generate_series.sql
[0m10:03:52.040582 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\dateadd.sql
[0m10:03:52.042549 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\data_types.sql
[0m10:03:52.048814 [error] [MainThread]: Encountered an error:
'dbt_postgres://macros/adapters.sql'
[0m10:03:52.052636 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 355, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 371, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 398, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
  File "/usr/local/lib/python3.10/site-packages/dbt/parser/manifest.py", line 2115, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "/usr/local/lib/python3.10/site-packages/dbt/parser/manifest.py", line 315, in get_full_manifest
    manifest = loader.load()
  File "/usr/local/lib/python3.10/site-packages/dbt/parser/manifest.py", line 384, in load
    self.load_and_parse_macros(project_parser_files)
  File "/usr/local/lib/python3.10/site-packages/dbt/parser/manifest.py", line 686, in load_and_parse_macros
    block = FileBlock(self.manifest.files[file_id])
KeyError: 'dbt_postgres://macros/adapters.sql'

[0m10:03:52.067023 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.6052613, "process_in_blocks": "82880", "process_kernel_time": 0.663421, "process_mem_max_rss": "107248", "process_out_blocks": "0", "process_user_time": 5.959158}
[0m10:03:52.069854 [debug] [MainThread]: Command `dbt run` failed at 10:03:52.069468 after 4.61 seconds
[0m10:03:52.072650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f3cd9c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f3bd0e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f3da7bfd0>]}
[0m10:03:52.077423 [debug] [MainThread]: Flushing usage events
[0m10:03:56.091589 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:06:38.545547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4002b7c7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4001ada9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4001adaa10>]}


============================== 10:06:38.551642 | 48276c40-5e39-4433-a712-5ca7cf345fa7 ==============================
[0m10:06:38.551642 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:06:38.555382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/telegram_dbt/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:06:38.932655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48276c40-5e39-4433-a712-5ca7cf345fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40045e8490>]}
[0m10:06:39.072203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48276c40-5e39-4433-a712-5ca7cf345fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f400238c970>]}
[0m10:06:39.075156 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:06:39.423229 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m10:06:40.011891 [debug] [MainThread]: Partial parsing enabled: 131 files deleted, 131 files added, 0 files changed.
[0m10:06:40.017851 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/rename.sql
[0m10:06:40.024950 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/concat.sql
[0m10:06:40.031803 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/freshness.sql
[0m10:06:40.038281 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/rename.sql
[0m10:06:40.044753 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/materialized_view.sql
[0m10:06:40.047698 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/create_or_replace_clone.sql
[0m10:06:40.050354 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/where_subquery.sql
[0m10:06:40.053129 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/split_part.sql
[0m10:06:40.055911 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date.sql
[0m10:06:40.058971 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/timestamps.sql
[0m10:06:40.062125 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/helpers.sql
[0m10:06:40.065159 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/incremental.sql
[0m10:06:40.068165 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/relationships.sql
[0m10:06:40.071358 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/equals.sql
[0m10:06:40.074331 [debug] [MainThread]: Partial parsing: added file: dbt://macros/python_model/python.sql
[0m10:06:40.076893 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/unit.sql
[0m10:06:40.079352 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_alias.sql
[0m10:06:40.081641 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/replace.sql
[0m10:06:40.083933 [debug] [MainThread]: Partial parsing: added file: dbt://macros/unit_test_sql/get_fixture_sql.sql
[0m10:06:40.086408 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/position.sql
[0m10:06:40.088660 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/alter.sql
[0m10:06:40.091091 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/drop.sql
[0m10:06:40.093269 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date_trunc.sql
[0m10:06:40.095729 [debug] [MainThread]: Partial parsing: added file: telegram_dbt://models/raw_sources.yml
[0m10:06:40.097946 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/hash.sql
[0m10:06:40.100815 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/alter.sql
[0m10:06:40.103174 [debug] [MainThread]: Partial parsing: added file: dbt://macros/etc/statement.sql
[0m10:06:40.105620 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/column/columns_spec_ddl.sql
[0m10:06:40.107913 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/data_types.sql
[0m10:06:40.110272 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/configs.sql
[0m10:06:40.112556 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/refresh.sql
[0m10:06:40.114948 [debug] [MainThread]: Partial parsing: added file: telegram_dbt://models/marts/fct_messages.sql
[0m10:06:40.117199 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/columns.sql
[0m10:06:40.119652 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/escape_single_quotes.sql
[0m10:06:40.121905 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/seeds/seed.sql
[0m10:06:40.124350 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/generate_series.sql
[0m10:06:40.126673 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_concat.sql
[0m10:06:40.129090 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/any_value.sql
[0m10:06:40.131825 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/listagg.sql
[0m10:06:40.134190 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/replace.sql
[0m10:06:40.136433 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/drop_backup.sql
[0m10:06:40.138868 [debug] [MainThread]: Partial parsing: added file: telegram_dbt://models/marts/dim_channels.sql
[0m10:06:40.141132 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/drop.sql
[0m10:06:40.143587 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/rename_intermediate.sql
[0m10:06:40.145723 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/right.sql
[0m10:06:40.147874 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/bool_or.sql
[0m10:06:40.150177 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/is_incremental.sql
[0m10:06:40.152459 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/listagg.sql
[0m10:06:40.154595 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/on_schema_change.sql
[0m10:06:40.156844 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/helpers.sql
[0m10:06:40.158971 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/replace.sql
[0m10:06:40.161088 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/last_day.sql
[0m10:06:40.163266 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/not_null.sql
[0m10:06:40.165378 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/rename.sql
[0m10:06:40.167486 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/drop.sql
[0m10:06:40.169723 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/drop.sql
[0m10:06:40.171794 [debug] [MainThread]: Partial parsing: added file: dbt://tests/generic/builtin.sql
[0m10:06:40.174068 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/hooks.sql
[0m10:06:40.176638 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/rename.sql
[0m10:06:40.178814 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/columns_spec_ddl.sql
[0m10:06:40.181151 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/split_part.sql
[0m10:06:40.183691 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/any_value.sql
[0m10:06:40.186223 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/dateadd.sql
[0m10:06:40.188512 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/test.sql
[0m10:06:40.190572 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/literal.sql
[0m10:06:40.192760 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/create.sql
[0m10:06:40.194843 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/replace.sql
[0m10:06:40.197684 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/replace.sql
[0m10:06:40.199868 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/rename.sql
[0m10:06:40.201949 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/catalog.sql
[0m10:06:40.204046 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/validate_sql.sql
[0m10:06:40.206281 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create_backup.sql
[0m10:06:40.208350 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/unique.sql
[0m10:06:40.210540 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/drop.sql
[0m10:06:40.212617 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/schema.sql
[0m10:06:40.214617 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/describe.sql
[0m10:06:40.216622 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/cast_bool_to_text.sql
[0m10:06:40.219072 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/show.sql
[0m10:06:40.221538 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/create.sql
[0m10:06:40.223668 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/create.sql
[0m10:06:40.225746 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/snapshot_merge.sql
[0m10:06:40.227878 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/rename.sql
[0m10:06:40.229962 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/materializations/snapshot_merge.sql
[0m10:06:40.232029 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/indexes.sql
[0m10:06:40.234072 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/last_day.sql
[0m10:06:40.236119 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/timestamps.sql
[0m10:06:40.238101 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/materializations/incremental_strategies.sql
[0m10:06:40.240329 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/column_helpers.sql
[0m10:06:40.242373 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/relation.sql
[0m10:06:40.244442 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/strategies.sql
[0m10:06:40.246458 [debug] [MainThread]: Partial parsing: added file: dbt://docs/overview.md
[0m10:06:40.248588 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations.sql
[0m10:06:40.250580 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/snapshot.sql
[0m10:06:40.252640 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create.sql
[0m10:06:40.254647 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/cast.sql
[0m10:06:40.256620 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/schema.sql
[0m10:06:40.258566 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/dateadd.sql
[0m10:06:40.260592 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/accepted_values.sql
[0m10:06:40.262584 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/clone.sql
[0m10:06:40.265026 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_schema.sql
[0m10:06:40.267250 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/intersect.sql
[0m10:06:40.269208 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/drop.sql
[0m10:06:40.271195 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/metadata.sql
[0m10:06:40.273208 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/safe_cast.sql
[0m10:06:40.275167 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/except.sql
[0m10:06:40.277234 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_database.sql
[0m10:06:40.279251 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/drop.sql
[0m10:06:40.281325 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/seeds/helpers.sql
[0m10:06:40.283332 [debug] [MainThread]: Partial parsing: added file: dbt://macros/etc/datetime.sql
[0m10:06:40.285768 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/refresh.sql
[0m10:06:40.287833 [debug] [MainThread]: Partial parsing: added file: telegram_dbt://models/staging/stg_telegram_messages.sql
[0m10:06:40.289927 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create_intermediate.sql
[0m10:06:40.291945 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/replace.sql
[0m10:06:40.293947 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_append.sql
[0m10:06:40.295918 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/adapters.sql
[0m10:06:40.297906 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/table.sql
[0m10:06:40.300007 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/view.sql
[0m10:06:40.302107 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/can_clone_table.sql
[0m10:06:40.304159 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/rename.sql
[0m10:06:40.306196 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/datediff.sql
[0m10:06:40.308144 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/length.sql
[0m10:06:40.310351 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/persist_docs.sql
[0m10:06:40.312482 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_construct.sql
[0m10:06:40.314544 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/apply_grants.sql
[0m10:06:40.316569 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/replace.sql
[0m10:06:40.318699 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/create.sql
[0m10:06:40.320731 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/strategies.sql
[0m10:06:40.322855 [debug] [MainThread]: Partial parsing: added file: telegram_dbt://models/marts/dim_dates.sql
[0m10:06:40.324851 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/datediff.sql
[0m10:06:40.326931 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/merge.sql
[0m10:06:40.329013 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date_spine.sql
[0m10:06:40.331198 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\snapshot.sql
[0m10:06:40.333873 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\helpers.sql
[0m10:06:40.335721 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_construct.sql
[0m10:06:40.337720 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\drop.sql
[0m10:06:40.339532 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\replace.sql
[0m10:06:40.341827 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\clone.sql
[0m10:06:40.343801 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create.sql
[0m10:06:40.345909 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\equals.sql
[0m10:06:40.347970 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\is_incremental.sql
[0m10:06:40.350083 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\create_or_replace_clone.sql
[0m10:06:40.352095 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\merge.sql
[0m10:06:40.354251 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\schema.sql
[0m10:06:40.356218 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date_spine.sql
[0m10:06:40.358928 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\strategies.sql
[0m10:06:40.360859 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\drop_backup.sql
[0m10:06:40.362946 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\rename.sql
[0m10:06:40.364861 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\rename.sql
[0m10:06:40.366773 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\create.sql
[0m10:06:40.368685 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create_backup.sql
[0m10:06:40.370672 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\rename_intermediate.sql
[0m10:06:40.372539 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\right.sql
[0m10:06:40.374833 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\data_types.sql
[0m10:06:40.376732 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\dateadd.sql
[0m10:06:40.378788 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\timestamps.sql
[0m10:06:40.380884 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_append.sql
[0m10:06:40.383369 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\etc\statement.sql
[0m10:06:40.385401 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\accepted_values.sql
[0m10:06:40.387349 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\refresh.sql
[0m10:06:40.389324 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\cast_bool_to_text.sql
[0m10:06:40.391428 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\rename.sql
[0m10:06:40.393444 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\schema.sql
[0m10:06:40.395502 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\replace.sql
[0m10:06:40.397983 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\drop.sql
[0m10:06:40.400102 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\any_value.sql
[0m10:06:40.402098 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date.sql
[0m10:06:40.404148 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\columns_spec_ddl.sql
[0m10:06:40.406044 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\replace.sql
[0m10:06:40.407973 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\can_clone_table.sql
[0m10:06:40.409883 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_database.sql
[0m10:06:40.411922 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\hooks.sql
[0m10:06:40.414081 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\create.sql
[0m10:06:40.417082 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\column\columns_spec_ddl.sql
[0m10:06:40.419046 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\intersect.sql
[0m10:06:40.421560 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\apply_grants.sql
[0m10:06:40.423584 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\alter.sql
[0m10:06:40.425611 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\generate_series.sql
[0m10:06:40.427606 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\drop.sql
[0m10:06:40.429631 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\rename.sql
[0m10:06:40.431575 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\materializations\snapshot_merge.sql
[0m10:06:40.433948 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\create.sql
[0m10:06:40.435868 [debug] [MainThread]: Partial parsing: deleted file: dbt://docs\overview.md
[0m10:06:40.437957 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\split_part.sql
[0m10:06:40.440486 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\configs.sql
[0m10:06:40.442676 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\unique.sql
[0m10:06:40.445132 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\datediff.sql
[0m10:06:40.447235 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\unit.sql
[0m10:06:40.449308 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\not_null.sql
[0m10:06:40.451429 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\drop.sql
[0m10:06:40.453460 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date_trunc.sql
[0m10:06:40.455510 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\create.sql
[0m10:06:40.458158 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\adapters.sql
[0m10:06:40.460197 [debug] [MainThread]: Partial parsing: deleted file: telegram_dbt://models\marts\dim_channels.sql
[0m10:06:40.462314 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\last_day.sql
[0m10:06:40.464284 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\position.sql
[0m10:06:40.466206 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\test.sql
[0m10:06:40.468168 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_alias.sql
[0m10:06:40.470115 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\hash.sql
[0m10:06:40.472092 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\view.sql
[0m10:06:40.473982 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\python_model\python.sql
[0m10:06:40.476211 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\indexes.sql
[0m10:06:40.478131 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\listagg.sql
[0m10:06:40.480227 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\relationships.sql
[0m10:06:40.482417 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\length.sql
[0m10:06:40.484549 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\rename.sql
[0m10:06:40.486571 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\drop.sql
[0m10:06:40.488585 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\except.sql
[0m10:06:40.490518 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\replace.sql
[0m10:06:40.492563 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\dateadd.sql
[0m10:06:40.494572 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\drop.sql
[0m10:06:40.496593 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\etc\datetime.sql
[0m10:06:40.498557 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\alter.sql
[0m10:06:40.500646 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\metadata.sql
[0m10:06:40.503054 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\show.sql
[0m10:06:40.505265 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\strategies.sql
[0m10:06:40.507068 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\bool_or.sql
[0m10:06:40.509184 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\split_part.sql
[0m10:06:40.511121 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\snapshot_merge.sql
[0m10:06:40.513153 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create_intermediate.sql
[0m10:06:40.515163 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\safe_cast.sql
[0m10:06:40.517176 [debug] [MainThread]: Partial parsing: deleted file: telegram_dbt://models\staging\stg_telegram_messages.sql
[0m10:06:40.519260 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\describe.sql
[0m10:06:40.521221 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\any_value.sql
[0m10:06:40.523157 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\incremental.sql
[0m10:06:40.525233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\materialized_view.sql
[0m10:06:40.527133 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_concat.sql
[0m10:06:40.529223 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\drop.sql
[0m10:06:40.531134 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\concat.sql
[0m10:06:40.533040 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\materializations\incremental_strategies.sql
[0m10:06:40.534892 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\on_schema_change.sql
[0m10:06:40.537021 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\datediff.sql
[0m10:06:40.538992 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\literal.sql
[0m10:06:40.541072 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\listagg.sql
[0m10:06:40.542940 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\where_subquery.sql
[0m10:06:40.545088 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\helpers.sql
[0m10:06:40.546939 [debug] [MainThread]: Partial parsing: deleted file: telegram_dbt://models\marts\fct_messages.sql
[0m10:06:40.548961 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\rename.sql
[0m10:06:40.551110 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\relation.sql
[0m10:06:40.553182 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\column_helpers.sql
[0m10:06:40.555213 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\cast.sql
[0m10:06:40.558848 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\columns.sql
[0m10:06:40.561798 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\replace.sql
[0m10:06:40.564513 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\persist_docs.sql
[0m10:06:40.567081 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\refresh.sql
[0m10:06:40.569519 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\freshness.sql
[0m10:06:40.571690 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\table.sql
[0m10:06:40.573871 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\timestamps.sql
[0m10:06:40.575993 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\rename.sql
[0m10:06:40.577988 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\replace.sql
[0m10:06:40.580049 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\replace.sql
[0m10:06:40.582626 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\catalog.sql
[0m10:06:40.585083 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\seeds\helpers.sql
[0m10:06:40.587158 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\seeds\seed.sql
[0m10:06:40.589183 [debug] [MainThread]: Partial parsing: deleted file: telegram_dbt://models\marts\dim_dates.sql
[0m10:06:40.591172 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\last_day.sql
[0m10:06:40.593123 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\unit_test_sql\get_fixture_sql.sql
[0m10:06:40.595135 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\escape_single_quotes.sql
[0m10:06:40.597162 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations.sql
[0m10:06:40.599228 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\validate_sql.sql
[0m10:06:40.601310 [debug] [MainThread]: Partial parsing: deleted file: dbt://tests\generic\builtin.sql
[0m10:06:40.603208 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_schema.sql
[0m10:06:40.608182 [error] [MainThread]: Encountered an error:
'dbt_postgres://macros/timestamps.sql'
[0m10:06:40.612122 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 355, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 371, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 398, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
  File "/usr/local/lib/python3.10/site-packages/dbt/parser/manifest.py", line 2115, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "/usr/local/lib/python3.10/site-packages/dbt/parser/manifest.py", line 315, in get_full_manifest
    manifest = loader.load()
  File "/usr/local/lib/python3.10/site-packages/dbt/parser/manifest.py", line 384, in load
    self.load_and_parse_macros(project_parser_files)
  File "/usr/local/lib/python3.10/site-packages/dbt/parser/manifest.py", line 686, in load_and_parse_macros
    block = FileBlock(self.manifest.files[file_id])
KeyError: 'dbt_postgres://macros/timestamps.sql'

[0m10:06:40.618282 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.218735, "process_in_blocks": "0", "process_kernel_time": 0.215435, "process_mem_max_rss": "107152", "process_out_blocks": "0", "process_user_time": 3.953246}
[0m10:06:40.621608 [debug] [MainThread]: Command `dbt run` failed at 10:06:40.621156 after 2.22 seconds
[0m10:06:40.631667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4002b7c7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4002dd45e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40005b02b0>]}
[0m10:06:40.634212 [debug] [MainThread]: Flushing usage events
[0m10:06:44.721217 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:08:22.967722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d45b18820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d44a7bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d44a7bf40>]}


============================== 10:08:22.974845 | 10bf9ee4-51ee-4426-a77f-c558d30e271b ==============================
[0m10:08:22.974845 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:08:22.978285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/app/dbt/telegram_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:08:23.220025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10bf9ee4-51ee-4426-a77f-c558d30e271b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d475904c0>]}
[0m10:08:23.503224 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:08:23.510917 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:08:23.515290 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.68668616, "process_in_blocks": "1448", "process_kernel_time": 0.172485, "process_mem_max_rss": "97560", "process_out_blocks": "0", "process_user_time": 2.932253}
[0m10:08:23.521026 [debug] [MainThread]: Command `dbt deps` succeeded at 10:08:23.520618 after 0.69 seconds
[0m10:08:23.523763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d45b18820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d475904c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d449989d0>]}
[0m10:08:23.526100 [debug] [MainThread]: Flushing usage events
[0m10:08:31.814228 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:08:58.316538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd53bb34820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd53aa9e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd53aa9ea10>]}


============================== 10:08:58.324492 | 1f63add1-54b0-4d81-b1e6-956a80fa30d9 ==============================
[0m10:08:58.324492 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:08:58.329009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/telegram_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:08:58.799789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f63add1-54b0-4d81-b1e6-956a80fa30d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd53a4b8e80>]}
[0m10:08:58.949021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f63add1-54b0-4d81-b1e6-956a80fa30d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd53ac2d120>]}
[0m10:08:58.952267 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:08:59.189920 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m10:08:59.196996 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:08:59.201352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1f63add1-54b0-4d81-b1e6-956a80fa30d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd53a1f2500>]}
[0m10:09:02.991150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f63add1-54b0-4d81-b1e6-956a80fa30d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5389d00d0>]}
[0m10:09:03.216894 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m10:09:03.370462 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m10:09:03.442718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f63add1-54b0-4d81-b1e6-956a80fa30d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd538140c10>]}
[0m10:09:03.445532 [info ] [MainThread]: Found 4 models, 1 source, 433 macros
[0m10:09:03.448810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f63add1-54b0-4d81-b1e6-956a80fa30d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd538140c70>]}
[0m10:09:03.455627 [info ] [MainThread]: 
[0m10:09:03.458066 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:09:03.463146 [info ] [MainThread]: 
[0m10:09:03.469507 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:09:03.473646 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m10:09:04.599735 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m10:09:04.603644 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m10:09:04.610343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:09:04.629042 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m10:09:04.633468 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m10:09:04.635748 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m10:09:04.638046 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m10:09:04.641647 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m10:09:04.644558 [debug] [ThreadPool]: On list_telegram_db: No close available on handle
[0m10:09:04.650613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:09:04.653229 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m10:09:04.655760 [info ] [MainThread]: 
[0m10:09:04.660400 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m10:09:04.664745 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m10:09:04.674786 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.539163, "process_in_blocks": "4808", "process_kernel_time": 0.529058, "process_mem_max_rss": "124216", "process_out_blocks": "56", "process_user_time": 7.842514}
[0m10:09:04.679618 [debug] [MainThread]: Command `dbt run` failed at 10:09:04.679028 after 6.54 seconds
[0m10:09:04.698758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd53bb34820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5381417e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5389b8d30>]}
[0m10:09:04.702119 [debug] [MainThread]: Flushing usage events
[0m10:09:11.047300 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:11:54.976715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcda844820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd97929b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd9792a10>]}


============================== 10:11:54.984776 | 05dadfa2-27c6-439b-b19c-8dd794282c6e ==============================
[0m10:11:54.984776 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:11:54.992785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/telegram_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:11:55.676895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05dadfa2-27c6-439b-b19c-8dd794282c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd8f44e80>]}
[0m10:11:55.835536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05dadfa2-27c6-439b-b19c-8dd794282c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd9b1d120>]}
[0m10:11:55.838277 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:11:56.921558 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m10:11:57.927813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:11:57.985541 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:11:58.287752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05dadfa2-27c6-439b-b19c-8dd794282c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd7b20130>]}
[0m10:11:58.555301 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m10:11:58.568869 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m10:11:58.609725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05dadfa2-27c6-439b-b19c-8dd794282c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd7fefb50>]}
[0m10:11:58.612188 [info ] [MainThread]: Found 4 models, 1 source, 433 macros
[0m10:11:58.616362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05dadfa2-27c6-439b-b19c-8dd794282c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd7feea70>]}
[0m10:11:58.621981 [info ] [MainThread]: 
[0m10:11:58.626912 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:11:58.636977 [info ] [MainThread]: 
[0m10:11:58.642686 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:11:58.651153 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m10:11:58.996888 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m10:11:58.999903 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m10:11:59.009601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:59.143979 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m10:11:59.152339 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m10:11:59.156072 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m10:11:59.158768 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m10:11:59.163387 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m10:11:59.168088 [debug] [ThreadPool]: On list_telegram_db: No close available on handle
[0m10:11:59.171771 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:11:59.174296 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m10:11:59.181437 [info ] [MainThread]: 
[0m10:11:59.187842 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m10:11:59.204423 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m10:11:59.209262 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.422475, "process_in_blocks": "0", "process_kernel_time": 0.661756, "process_mem_max_rss": "115112", "process_out_blocks": "0", "process_user_time": 7.371967}
[0m10:11:59.222983 [debug] [MainThread]: Command `dbt run` failed at 10:11:59.222714 after 4.44 seconds
[0m10:11:59.230825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcda844820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd7fef670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd8b09f90>]}
[0m10:11:59.235259 [debug] [MainThread]: Flushing usage events
[0m10:12:07.570944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:15:15.942990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0b7007f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0a64aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0a64aa70>]}


============================== 10:15:15.949854 | 27b6806b-dfd9-4189-881f-540fc8ba5267 ==============================
[0m10:15:15.949854 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:15:15.953771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/telegram_dbt/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:15:16.338243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27b6806b-dfd9-4189-881f-540fc8ba5267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc09d44640>]}
[0m10:15:16.496042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27b6806b-dfd9-4189-881f-540fc8ba5267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0a648ee0>]}
[0m10:15:16.499475 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:15:16.722817 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m10:15:16.956168 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:15:16.961101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '27b6806b-dfd9-4189-881f-540fc8ba5267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0ae76740>]}
[0m10:15:21.632409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27b6806b-dfd9-4189-881f-540fc8ba5267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc078feef0>]}
[0m10:15:21.896758 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m10:15:21.907936 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m10:15:21.943320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27b6806b-dfd9-4189-881f-540fc8ba5267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc079aa590>]}
[0m10:15:21.945817 [info ] [MainThread]: Found 4 models, 1 source, 433 macros
[0m10:15:21.952749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27b6806b-dfd9-4189-881f-540fc8ba5267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc079aa620>]}
[0m10:15:21.957987 [info ] [MainThread]: 
[0m10:15:21.961280 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:15:21.969814 [info ] [MainThread]: 
[0m10:15:21.980451 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:15:21.988157 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m10:15:22.135892 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m10:15:22.138909 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m10:15:22.141426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:22.238879 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.097 seconds
[0m10:15:22.243321 [debug] [ThreadPool]: On list_telegram_db: Close
[0m10:15:22.247024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db, now create_telegram_db_raw_staging)
[0m10:15:22.249615 [debug] [ThreadPool]: Creating schema "database: "telegram_db"
schema: "raw_staging"
"
[0m10:15:22.264260 [debug] [ThreadPool]: Using postgres connection "create_telegram_db_raw_staging"
[0m10:15:22.266345 [debug] [ThreadPool]: On create_telegram_db_raw_staging: BEGIN
[0m10:15:22.268373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:22.283505 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m10:15:22.285616 [debug] [ThreadPool]: Using postgres connection "create_telegram_db_raw_staging"
[0m10:15:22.287293 [debug] [ThreadPool]: On create_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "create_telegram_db_raw_staging"} */
create schema if not exists "raw_staging"
[0m10:15:22.313922 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.025 seconds
[0m10:15:22.317062 [debug] [ThreadPool]: On create_telegram_db_raw_staging: COMMIT
[0m10:15:22.319004 [debug] [ThreadPool]: Using postgres connection "create_telegram_db_raw_staging"
[0m10:15:22.320987 [debug] [ThreadPool]: On create_telegram_db_raw_staging: COMMIT
[0m10:15:22.336459 [debug] [ThreadPool]: SQL status: COMMIT in 0.013 seconds
[0m10:15:22.339005 [debug] [ThreadPool]: On create_telegram_db_raw_staging: Close
[0m10:15:22.353873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_telegram_db_raw_staging, now list_telegram_db_raw_staging)
[0m10:15:22.374144 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m10:15:22.377596 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m10:15:22.380498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:22.397649 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m10:15:22.400782 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m10:15:22.404527 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m10:15:22.434064 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.027 seconds
[0m10:15:22.438149 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m10:15:22.441152 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m10:15:22.445102 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db_raw_staging, now list_telegram_db_raw_analytics)
[0m10:15:22.559658 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m10:15:22.564944 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: BEGIN
[0m10:15:22.568184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:15:22.593503 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m10:15:22.625081 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m10:15:22.641534 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_analytics'
  
[0m10:15:22.658480 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m10:15:22.669602 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: ROLLBACK
[0m10:15:22.674918 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: Close
[0m10:15:22.703106 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:22.705491 [debug] [MainThread]: On master: BEGIN
[0m10:15:22.708931 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:15:22.769890 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m10:15:22.781286 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:22.785069 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:15:22.957903 [debug] [MainThread]: SQL status: SELECT 0 in 0.168 seconds
[0m10:15:22.964577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27b6806b-dfd9-4189-881f-540fc8ba5267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc06c77a30>]}
[0m10:15:22.967202 [debug] [MainThread]: On master: ROLLBACK
[0m10:15:22.969633 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:22.971615 [debug] [MainThread]: On master: BEGIN
[0m10:15:22.974105 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:15:22.976013 [debug] [MainThread]: On master: COMMIT
[0m10:15:22.979229 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:22.981152 [debug] [MainThread]: On master: COMMIT
[0m10:15:22.983217 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:15:22.985223 [debug] [MainThread]: On master: Close
[0m10:15:23.009045 [debug] [Thread-1 (]: Began running node model.telegram_dbt.stg_telegram_messages
[0m10:15:23.013076 [info ] [Thread-1 (]: 1 of 1 START sql view model raw_staging.stg_telegram_messages .................. [RUN]
[0m10:15:23.017158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_db_raw_analytics, now model.telegram_dbt.stg_telegram_messages)
[0m10:15:23.023005 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.stg_telegram_messages
[0m10:15:23.068788 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.stg_telegram_messages"
[0m10:15:23.124596 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.stg_telegram_messages
[0m10:15:23.250649 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.stg_telegram_messages"
[0m10:15:23.280163 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m10:15:23.282826 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: BEGIN
[0m10:15:23.285190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:15:23.299783 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m10:15:23.303261 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m10:15:23.306152 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */

  create view "telegram_db"."raw_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    -- models/staging/stg_telegram_messages.sql

with source as (
    select * from "telegram_db"."raw"."telegram_messages"
),

renamed as (
    select
        id::bigint as message_id,
        channel::text as channel_name,
        date::timestamp as message_date,
        message::text as message_text,
        has_media::boolean,
        media_type::text,
        image_path::text
    from source
)

select * from renamed
  );
[0m10:15:23.356424 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.047 seconds
[0m10:15:23.398807 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m10:15:23.404091 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */
alter table "telegram_db"."raw_staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m10:15:23.430726 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.023 seconds
[0m10:15:23.482668 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: COMMIT
[0m10:15:23.485708 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m10:15:23.487770 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: COMMIT
[0m10:15:23.498515 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m10:15:23.517003 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_staging"."stg_telegram_messages__dbt_backup"
[0m10:15:23.529957 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.stg_telegram_messages"
[0m10:15:23.532698 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.stg_telegram_messages"} */
drop view if exists "telegram_db"."raw_staging"."stg_telegram_messages__dbt_backup" cascade
[0m10:15:23.535879 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:15:23.546661 [debug] [Thread-1 (]: On model.telegram_dbt.stg_telegram_messages: Close
[0m10:15:23.582334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b6806b-dfd9-4189-881f-540fc8ba5267', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0cecca90>]}
[0m10:15:23.589193 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw_staging.stg_telegram_messages ............. [[32mCREATE VIEW[0m in 0.54s]
[0m10:15:23.594089 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.stg_telegram_messages
[0m10:15:23.603807 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:23.606343 [debug] [MainThread]: On master: BEGIN
[0m10:15:23.608510 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:15:23.639783 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m10:15:23.653184 [debug] [MainThread]: On master: COMMIT
[0m10:15:23.656451 [debug] [MainThread]: Using postgres connection "master"
[0m10:15:23.664436 [debug] [MainThread]: On master: COMMIT
[0m10:15:23.667445 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:15:23.670041 [debug] [MainThread]: On master: Close
[0m10:15:23.676289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:23.682085 [debug] [MainThread]: Connection 'model.telegram_dbt.stg_telegram_messages' was properly closed.
[0m10:15:23.704607 [info ] [MainThread]: 
[0m10:15:23.714831 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.73 seconds (1.73s).
[0m10:15:23.721322 [debug] [MainThread]: Command end result
[0m10:15:23.844260 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m10:15:23.862495 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m10:15:23.888315 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/telegram_dbt/target/run_results.json
[0m10:15:23.891121 [info ] [MainThread]: 
[0m10:15:23.897360 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:15:23.900217 [info ] [MainThread]: 
[0m10:15:23.904749 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:15:23.911274 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.131022, "process_in_blocks": "3312", "process_kernel_time": 0.38857, "process_mem_max_rss": "124432", "process_out_blocks": "16", "process_user_time": 9.066645}
[0m10:15:23.918643 [debug] [MainThread]: Command `dbt run` succeeded at 10:15:23.918097 after 8.14 seconds
[0m10:15:23.921435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0b7007f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0b5917b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0851d4e0>]}
[0m10:15:23.924578 [debug] [MainThread]: Flushing usage events
[0m10:15:27.450701 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:18:01.814649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c69b4820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c58fe9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c58fea10>]}


============================== 10:18:01.820620 | 4f879820-f4f5-40d1-a67a-788d31767617 ==============================
[0m10:18:01.820620 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:18:01.824862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/telegram_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select marts', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:18:02.457558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f879820-f4f5-40d1-a67a-788d31767617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c531ce80>]}
[0m10:18:02.955597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f879820-f4f5-40d1-a67a-788d31767617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c5c89120>]}
[0m10:18:02.957910 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:18:03.234588 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m10:18:03.724948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:18:03.732278 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:18:03.854300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f879820-f4f5-40d1-a67a-788d31767617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c3f24130>]}
[0m10:18:04.144633 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m10:18:04.156459 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m10:18:04.219578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f879820-f4f5-40d1-a67a-788d31767617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c43f3b50>]}
[0m10:18:04.226490 [info ] [MainThread]: Found 4 models, 1 source, 433 macros
[0m10:18:04.297810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f879820-f4f5-40d1-a67a-788d31767617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c43f2a70>]}
[0m10:18:04.327685 [info ] [MainThread]: 
[0m10:18:04.358466 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:18:04.364728 [info ] [MainThread]: 
[0m10:18:04.369890 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:18:04.390334 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m10:18:04.568152 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m10:18:04.570420 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m10:18:04.572587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:04.594268 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.022 seconds
[0m10:18:04.598484 [debug] [ThreadPool]: On list_telegram_db: Close
[0m10:18:04.601964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db, now create_telegram_db_raw_analytics)
[0m10:18:04.605484 [debug] [ThreadPool]: Creating schema "database: "telegram_db"
schema: "raw_analytics"
"
[0m10:18:04.618531 [debug] [ThreadPool]: Using postgres connection "create_telegram_db_raw_analytics"
[0m10:18:04.620999 [debug] [ThreadPool]: On create_telegram_db_raw_analytics: BEGIN
[0m10:18:04.623272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:18:04.636930 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m10:18:04.639071 [debug] [ThreadPool]: Using postgres connection "create_telegram_db_raw_analytics"
[0m10:18:04.641167 [debug] [ThreadPool]: On create_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "create_telegram_db_raw_analytics"} */
create schema if not exists "raw_analytics"
[0m10:18:04.644066 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m10:18:04.647291 [debug] [ThreadPool]: On create_telegram_db_raw_analytics: COMMIT
[0m10:18:04.649417 [debug] [ThreadPool]: Using postgres connection "create_telegram_db_raw_analytics"
[0m10:18:04.651602 [debug] [ThreadPool]: On create_telegram_db_raw_analytics: COMMIT
[0m10:18:04.662298 [debug] [ThreadPool]: SQL status: COMMIT in 0.008 seconds
[0m10:18:04.664682 [debug] [ThreadPool]: On create_telegram_db_raw_analytics: Close
[0m10:18:04.670526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_telegram_db_raw_analytics, now list_telegram_db_raw_analytics)
[0m10:18:04.684966 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m10:18:04.687129 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: BEGIN
[0m10:18:04.689580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:18:04.708200 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m10:18:04.710503 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m10:18:04.712733 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_analytics'
  
[0m10:18:04.720685 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m10:18:04.724237 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: ROLLBACK
[0m10:18:04.726788 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: Close
[0m10:18:04.730933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db_raw_analytics, now list_telegram_db_raw_staging)
[0m10:18:04.746657 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m10:18:04.768454 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m10:18:04.790687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:18:04.841108 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m10:18:04.845821 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m10:18:04.848847 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m10:18:04.860667 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m10:18:04.871298 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m10:18:04.874794 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m10:18:04.904098 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:04.905975 [debug] [MainThread]: On master: BEGIN
[0m10:18:04.912134 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:18:04.970649 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m10:18:04.975037 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:04.986333 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:18:05.013385 [debug] [MainThread]: SQL status: SELECT 1 in 0.024 seconds
[0m10:18:05.021955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f879820-f4f5-40d1-a67a-788d31767617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c4f0e8f0>]}
[0m10:18:05.024037 [debug] [MainThread]: On master: ROLLBACK
[0m10:18:05.027855 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:05.032168 [debug] [MainThread]: On master: BEGIN
[0m10:18:05.035861 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:18:05.038122 [debug] [MainThread]: On master: COMMIT
[0m10:18:05.039998 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:05.041885 [debug] [MainThread]: On master: COMMIT
[0m10:18:05.049206 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:18:05.052204 [debug] [MainThread]: On master: Close
[0m10:18:05.058075 [debug] [Thread-1 (]: Began running node model.telegram_dbt.dim_channels
[0m10:18:05.066994 [info ] [Thread-1 (]: 1 of 3 START sql table model raw_analytics.dim_channels ........................ [RUN]
[0m10:18:05.074570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_db_raw_staging, now model.telegram_dbt.dim_channels)
[0m10:18:05.080928 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.dim_channels
[0m10:18:05.117293 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.dim_channels"
[0m10:18:05.147369 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.dim_channels
[0m10:18:05.266152 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.dim_channels"
[0m10:18:05.289736 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m10:18:05.292509 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: BEGIN
[0m10:18:05.295997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:05.322199 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m10:18:05.324870 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m10:18:05.330700 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */

  
    

  create  table "telegram_db"."raw_analytics"."dim_channels__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_channels.sql

with messages as (
    select * from "telegram_db"."raw_staging"."stg_telegram_messages"
),

dim_channels as (
    select distinct
        channel_name as channel,
        md5(channel_name) as channel_id
    from messages
)

select * from dim_channels
  );
  
[0m10:18:05.799139 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.319 seconds
[0m10:18:05.835413 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m10:18:05.837674 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */
alter table "telegram_db"."raw_analytics"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m10:18:05.842806 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:18:05.888194 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: COMMIT
[0m10:18:05.890649 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m10:18:05.895506 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: COMMIT
[0m10:18:05.928446 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m10:18:05.966623 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."dim_channels__dbt_backup"
[0m10:18:05.991324 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_channels"
[0m10:18:05.997041 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_channels"} */
drop table if exists "telegram_db"."raw_analytics"."dim_channels__dbt_backup" cascade
[0m10:18:06.000777 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:18:06.007929 [debug] [Thread-1 (]: On model.telegram_dbt.dim_channels: Close
[0m10:18:06.022707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f879820-f4f5-40d1-a67a-788d31767617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c8180ac0>]}
[0m10:18:06.026044 [info ] [Thread-1 (]: 1 of 3 OK created sql table model raw_analytics.dim_channels ................... [[32mSELECT 5[0m in 0.94s]
[0m10:18:06.036006 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.dim_channels
[0m10:18:06.039068 [debug] [Thread-1 (]: Began running node model.telegram_dbt.dim_dates
[0m10:18:06.047935 [info ] [Thread-1 (]: 2 of 3 START sql table model raw_analytics.dim_dates ........................... [RUN]
[0m10:18:06.052936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_dbt.dim_channels, now model.telegram_dbt.dim_dates)
[0m10:18:06.056840 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.dim_dates
[0m10:18:06.073182 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.dim_dates"
[0m10:18:06.118938 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.dim_dates
[0m10:18:06.139619 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.dim_dates"
[0m10:18:06.159139 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m10:18:06.163510 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: BEGIN
[0m10:18:06.165867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:06.182787 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m10:18:06.185874 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m10:18:06.188522 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */

  
    

  create  table "telegram_db"."raw_analytics"."dim_dates__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/dim_dates.sql

with dates as (
    select
        generate_series(
            date '2022-01-01',
            current_date,
            interval '1 day'
        )::date as date_day
),

dim_dates as (
    select
        date_day,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day,
        to_char(date_day, 'Day') as weekday
    from dates
)
 
select * from dim_dates
  );
  
[0m10:18:06.252733 [debug] [Thread-1 (]: SQL status: SELECT 1292 in 0.061 seconds
[0m10:18:06.264135 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m10:18:06.266998 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */
alter table "telegram_db"."raw_analytics"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m10:18:06.270734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:18:06.276996 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: COMMIT
[0m10:18:06.279401 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m10:18:06.281873 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: COMMIT
[0m10:18:06.297637 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m10:18:06.307395 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."dim_dates__dbt_backup"
[0m10:18:06.312297 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.dim_dates"
[0m10:18:06.315061 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.dim_dates"} */
drop table if exists "telegram_db"."raw_analytics"."dim_dates__dbt_backup" cascade
[0m10:18:06.318346 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:18:06.323522 [debug] [Thread-1 (]: On model.telegram_dbt.dim_dates: Close
[0m10:18:06.329116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f879820-f4f5-40d1-a67a-788d31767617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c1107490>]}
[0m10:18:06.335511 [info ] [Thread-1 (]: 2 of 3 OK created sql table model raw_analytics.dim_dates ...................... [[32mSELECT 1292[0m in 0.28s]
[0m10:18:06.342216 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.dim_dates
[0m10:18:06.345598 [debug] [Thread-1 (]: Began running node model.telegram_dbt.fct_messages
[0m10:18:06.348879 [info ] [Thread-1 (]: 3 of 3 START sql table model raw_analytics.fct_messages ........................ [RUN]
[0m10:18:06.356534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_dbt.dim_dates, now model.telegram_dbt.fct_messages)
[0m10:18:06.361514 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.fct_messages
[0m10:18:06.374189 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.fct_messages"
[0m10:18:06.544978 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.fct_messages
[0m10:18:06.569508 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.fct_messages"
[0m10:18:06.604636 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m10:18:06.608161 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: BEGIN
[0m10:18:06.611575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:06.638528 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m10:18:06.641273 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m10:18:06.644579 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */

  
    

  create  table "telegram_db"."raw_analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fct_messages.sql

with messages as (
    select * from "telegram_db"."raw_staging"."stg_telegram_messages"
),

fct as (
    select
        md5(channel_name) as channel_id,
        message_date::date as date_day,
        message_id,
        length(message_text) as message_length,
        has_media,
        media_type
    from messages
)
 
select * from fct
  );
  
[0m10:18:06.748523 [debug] [Thread-1 (]: SQL status: SELECT 483 in 0.101 seconds
[0m10:18:06.761269 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m10:18:06.765037 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
alter table "telegram_db"."raw_analytics"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m10:18:06.768417 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:18:06.772724 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: COMMIT
[0m10:18:06.780437 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m10:18:06.782589 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: COMMIT
[0m10:18:06.807747 [debug] [Thread-1 (]: SQL status: COMMIT in 0.023 seconds
[0m10:18:06.816853 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."fct_messages__dbt_backup"
[0m10:18:06.820426 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m10:18:06.827416 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
drop table if exists "telegram_db"."raw_analytics"."fct_messages__dbt_backup" cascade
[0m10:18:06.831042 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m10:18:06.837539 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: Close
[0m10:18:06.844914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f879820-f4f5-40d1-a67a-788d31767617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c8180ac0>]}
[0m10:18:06.851176 [info ] [Thread-1 (]: 3 of 3 OK created sql table model raw_analytics.fct_messages ................... [[32mSELECT 483[0m in 0.49s]
[0m10:18:06.856743 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.fct_messages
[0m10:18:06.867026 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:06.877452 [debug] [MainThread]: On master: BEGIN
[0m10:18:06.881068 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:18:06.903139 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m10:18:06.906869 [debug] [MainThread]: On master: COMMIT
[0m10:18:06.914008 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:06.916948 [debug] [MainThread]: On master: COMMIT
[0m10:18:06.919913 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:18:06.922647 [debug] [MainThread]: On master: Close
[0m10:18:06.930119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:18:06.934567 [debug] [MainThread]: Connection 'model.telegram_dbt.fct_messages' was properly closed.
[0m10:18:06.937388 [info ] [MainThread]: 
[0m10:18:06.945619 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.57 seconds (2.57s).
[0m10:18:06.952280 [debug] [MainThread]: Command end result
[0m10:18:07.067061 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m10:18:07.081536 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m10:18:07.106882 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/telegram_dbt/target/run_results.json
[0m10:18:07.111031 [info ] [MainThread]: 
[0m10:18:07.115618 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:18:07.119166 [info ] [MainThread]: 
[0m10:18:07.122325 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m10:18:07.132055 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.470909, "process_in_blocks": "0", "process_kernel_time": 0.424718, "process_mem_max_rss": "118972", "process_out_blocks": "0", "process_user_time": 5.723584}
[0m10:18:07.134738 [debug] [MainThread]: Command `dbt run` succeeded at 10:18:07.134439 after 5.47 seconds
[0m10:18:07.136761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c69b4820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c436b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70c686a800>]}
[0m10:18:07.140279 [debug] [MainThread]: Flushing usage events
[0m10:18:08.206656 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:38:58.534977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f23b44730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f22a86920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f22a86980>]}


============================== 10:38:58.545614 | 2cc7fcce-de9b-42ec-9e69-3a8de525e0d9 ==============================
[0m10:38:58.545614 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:38:58.550289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/app/dbt/telegram_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m10:38:59.522035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cc7fcce-de9b-42ec-9e69-3a8de525e0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f22a92d40>]}
[0m10:38:59.667393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cc7fcce-de9b-42ec-9e69-3a8de525e0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f232db1f0>]}
[0m10:38:59.671341 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:38:59.904798 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m10:39:00.737632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:39:00.740367 [debug] [MainThread]: Partial parsing: added file: telegram_dbt://models/raw_analytics/schema.yml
[0m10:39:01.468236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cc7fcce-de9b-42ec-9e69-3a8de525e0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f21556980>]}
[0m10:39:01.733492 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m10:39:01.833188 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m10:39:02.122289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cc7fcce-de9b-42ec-9e69-3a8de525e0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f20955390>]}
[0m10:39:02.125272 [info ] [MainThread]: Found 4 models, 8 data tests, 1 source, 433 macros
[0m10:39:02.130975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cc7fcce-de9b-42ec-9e69-3a8de525e0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f224d12a0>]}
[0m10:39:02.138829 [info ] [MainThread]: 
[0m10:39:02.143192 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:39:02.146566 [info ] [MainThread]: 
[0m10:39:02.150676 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:39:02.168046 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_raw_analytics'
[0m10:39:02.718108 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m10:39:02.727633 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: BEGIN
[0m10:39:02.735653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:39:03.016758 [debug] [ThreadPool]: SQL status: BEGIN in 0.281 seconds
[0m10:39:03.019114 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m10:39:03.021718 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_analytics'
  
[0m10:39:03.029565 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m10:39:03.033702 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: ROLLBACK
[0m10:39:03.036413 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: Close
[0m10:39:03.039836 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db_raw_analytics, now list_telegram_db_raw_staging)
[0m10:39:03.047294 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m10:39:03.049531 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m10:39:03.051691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:03.260590 [debug] [ThreadPool]: SQL status: BEGIN in 0.208 seconds
[0m10:39:03.270353 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m10:39:03.280473 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m10:39:03.304466 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.015 seconds
[0m10:39:03.312400 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m10:39:03.315745 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m10:39:03.335610 [debug] [MainThread]: Using postgres connection "master"
[0m10:39:03.479404 [debug] [MainThread]: On master: BEGIN
[0m10:39:03.482972 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:39:03.504502 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m10:39:03.506794 [debug] [MainThread]: Using postgres connection "master"
[0m10:39:03.509513 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:39:03.529646 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m10:39:03.533587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cc7fcce-de9b-42ec-9e69-3a8de525e0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f2159b550>]}
[0m10:39:03.536082 [debug] [MainThread]: On master: ROLLBACK
[0m10:39:03.538622 [debug] [MainThread]: Using postgres connection "master"
[0m10:39:03.540922 [debug] [MainThread]: On master: BEGIN
[0m10:39:03.544150 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:39:03.546683 [debug] [MainThread]: On master: COMMIT
[0m10:39:03.549070 [debug] [MainThread]: Using postgres connection "master"
[0m10:39:03.551276 [debug] [MainThread]: On master: COMMIT
[0m10:39:03.553777 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:39:03.556115 [debug] [MainThread]: On master: Close
[0m10:39:03.577203 [debug] [Thread-1 (]: Began running node test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b
[0m10:39:03.579780 [info ] [Thread-1 (]: 1 of 8 START test not_null_dim_channels_channel_id ............................. [RUN]
[0m10:39:03.584366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_db_raw_staging, now test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b)
[0m10:39:03.586757 [debug] [Thread-1 (]: Began compiling node test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b
[0m10:39:03.628094 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b"
[0m10:39:03.672126 [debug] [Thread-1 (]: Began executing node test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b
[0m10:39:03.713416 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b"
[0m10:39:03.760791 [debug] [Thread-1 (]: Using postgres connection "test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b"
[0m10:39:03.762994 [debug] [Thread-1 (]: On test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b: BEGIN
[0m10:39:03.765223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:03.779969 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m10:39:03.782213 [debug] [Thread-1 (]: Using postgres connection "test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b"
[0m10:39:03.784378 [debug] [Thread-1 (]: On test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_id
from "telegram_db"."raw_analytics"."dim_channels"
where channel_id is null



  
  
      
    ) dbt_internal_test
[0m10:39:03.816958 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.030 seconds
[0m10:39:03.826763 [debug] [Thread-1 (]: On test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b: ROLLBACK
[0m10:39:03.829624 [debug] [Thread-1 (]: On test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b: Close
[0m10:39:03.832863 [info ] [Thread-1 (]: 1 of 8 PASS not_null_dim_channels_channel_id ................................... [[32mPASS[0m in 0.25s]
[0m10:39:03.837224 [debug] [Thread-1 (]: Finished running node test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b
[0m10:39:03.839284 [debug] [Thread-1 (]: Began running node test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb
[0m10:39:03.841493 [info ] [Thread-1 (]: 2 of 8 START test not_null_dim_dates_date_day .................................. [RUN]
[0m10:39:03.845288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b, now test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb)
[0m10:39:03.851968 [debug] [Thread-1 (]: Began compiling node test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb
[0m10:39:03.863482 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m10:39:03.913398 [debug] [Thread-1 (]: Began executing node test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb
[0m10:39:03.927681 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m10:39:03.947101 [debug] [Thread-1 (]: Using postgres connection "test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m10:39:03.949319 [debug] [Thread-1 (]: On test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb: BEGIN
[0m10:39:03.952980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:03.982164 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m10:39:03.984557 [debug] [Thread-1 (]: Using postgres connection "test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m10:39:03.987095 [debug] [Thread-1 (]: On test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_day
from "telegram_db"."raw_analytics"."dim_dates"
where date_day is null



  
  
      
    ) dbt_internal_test
[0m10:39:03.990613 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:39:03.994564 [debug] [Thread-1 (]: On test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb: ROLLBACK
[0m10:39:03.997134 [debug] [Thread-1 (]: On test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb: Close
[0m10:39:04.000275 [info ] [Thread-1 (]: 2 of 8 PASS not_null_dim_dates_date_day ........................................ [[32mPASS[0m in 0.16s]
[0m10:39:04.004351 [debug] [Thread-1 (]: Finished running node test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb
[0m10:39:04.007928 [debug] [Thread-1 (]: Began running node test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff
[0m10:39:04.010831 [info ] [Thread-1 (]: 3 of 8 START test not_null_fct_messages_channel_id ............................. [RUN]
[0m10:39:04.014484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb, now test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff)
[0m10:39:04.017927 [debug] [Thread-1 (]: Began compiling node test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff
[0m10:39:04.028994 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff"
[0m10:39:04.080234 [debug] [Thread-1 (]: Began executing node test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff
[0m10:39:04.090617 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff"
[0m10:39:04.115869 [debug] [Thread-1 (]: Using postgres connection "test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff"
[0m10:39:04.119401 [debug] [Thread-1 (]: On test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff: BEGIN
[0m10:39:04.121692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:04.137133 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m10:39:04.139581 [debug] [Thread-1 (]: Using postgres connection "test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff"
[0m10:39:04.142150 [debug] [Thread-1 (]: On test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_id
from "telegram_db"."raw_analytics"."fct_messages"
where channel_id is null



  
  
      
    ) dbt_internal_test
[0m10:39:04.145693 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:39:04.150542 [debug] [Thread-1 (]: On test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff: ROLLBACK
[0m10:39:04.153163 [debug] [Thread-1 (]: On test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff: Close
[0m10:39:04.156361 [info ] [Thread-1 (]: 3 of 8 PASS not_null_fct_messages_channel_id ................................... [[32mPASS[0m in 0.14s]
[0m10:39:04.160469 [debug] [Thread-1 (]: Finished running node test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff
[0m10:39:04.163468 [debug] [Thread-1 (]: Began running node test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b
[0m10:39:04.167190 [info ] [Thread-1 (]: 4 of 8 START test not_null_fct_messages_date_day ............................... [RUN]
[0m10:39:04.171375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff, now test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b)
[0m10:39:04.173992 [debug] [Thread-1 (]: Began compiling node test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b
[0m10:39:04.188147 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b"
[0m10:39:04.210472 [debug] [Thread-1 (]: Began executing node test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b
[0m10:39:04.220281 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b"
[0m10:39:04.241063 [debug] [Thread-1 (]: Using postgres connection "test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b"
[0m10:39:04.243375 [debug] [Thread-1 (]: On test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b: BEGIN
[0m10:39:04.246009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:04.259989 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m10:39:04.262121 [debug] [Thread-1 (]: Using postgres connection "test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b"
[0m10:39:04.264358 [debug] [Thread-1 (]: On test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_day
from "telegram_db"."raw_analytics"."fct_messages"
where date_day is null



  
  
      
    ) dbt_internal_test
[0m10:39:04.267588 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:39:04.271808 [debug] [Thread-1 (]: On test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b: ROLLBACK
[0m10:39:04.274366 [debug] [Thread-1 (]: On test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b: Close
[0m10:39:04.296484 [info ] [Thread-1 (]: 4 of 8 PASS not_null_fct_messages_date_day ..................................... [[32mPASS[0m in 0.13s]
[0m10:39:04.301758 [debug] [Thread-1 (]: Finished running node test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b
[0m10:39:04.305460 [debug] [Thread-1 (]: Began running node test.telegram_dbt.not_null_fct_messages_message_id.de346706b5
[0m10:39:04.308328 [info ] [Thread-1 (]: 5 of 8 START test not_null_fct_messages_message_id ............................. [RUN]
[0m10:39:04.312537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b, now test.telegram_dbt.not_null_fct_messages_message_id.de346706b5)
[0m10:39:04.320007 [debug] [Thread-1 (]: Began compiling node test.telegram_dbt.not_null_fct_messages_message_id.de346706b5
[0m10:39:04.331257 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_dbt.not_null_fct_messages_message_id.de346706b5"
[0m10:39:04.382815 [debug] [Thread-1 (]: Began executing node test.telegram_dbt.not_null_fct_messages_message_id.de346706b5
[0m10:39:04.393451 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_dbt.not_null_fct_messages_message_id.de346706b5"
[0m10:39:04.416651 [debug] [Thread-1 (]: Using postgres connection "test.telegram_dbt.not_null_fct_messages_message_id.de346706b5"
[0m10:39:04.419266 [debug] [Thread-1 (]: On test.telegram_dbt.not_null_fct_messages_message_id.de346706b5: BEGIN
[0m10:39:04.421550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:04.439566 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m10:39:04.441943 [debug] [Thread-1 (]: Using postgres connection "test.telegram_dbt.not_null_fct_messages_message_id.de346706b5"
[0m10:39:04.444556 [debug] [Thread-1 (]: On test.telegram_dbt.not_null_fct_messages_message_id.de346706b5: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "test.telegram_dbt.not_null_fct_messages_message_id.de346706b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "telegram_db"."raw_analytics"."fct_messages"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m10:39:04.448154 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:39:04.452369 [debug] [Thread-1 (]: On test.telegram_dbt.not_null_fct_messages_message_id.de346706b5: ROLLBACK
[0m10:39:04.455006 [debug] [Thread-1 (]: On test.telegram_dbt.not_null_fct_messages_message_id.de346706b5: Close
[0m10:39:04.488108 [info ] [Thread-1 (]: 5 of 8 PASS not_null_fct_messages_message_id ................................... [[32mPASS[0m in 0.18s]
[0m10:39:04.492695 [debug] [Thread-1 (]: Finished running node test.telegram_dbt.not_null_fct_messages_message_id.de346706b5
[0m10:39:04.497226 [debug] [Thread-1 (]: Began running node test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec
[0m10:39:04.504789 [info ] [Thread-1 (]: 6 of 8 START test unique_dim_channels_channel_id ............................... [RUN]
[0m10:39:04.508645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_dbt.not_null_fct_messages_message_id.de346706b5, now test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec)
[0m10:39:04.513312 [debug] [Thread-1 (]: Began compiling node test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec
[0m10:39:04.537002 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec"
[0m10:39:04.577127 [debug] [Thread-1 (]: Began executing node test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec
[0m10:39:04.590500 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec"
[0m10:39:04.609838 [debug] [Thread-1 (]: Using postgres connection "test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec"
[0m10:39:04.612278 [debug] [Thread-1 (]: On test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec: BEGIN
[0m10:39:04.614811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:04.627559 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m10:39:04.630319 [debug] [Thread-1 (]: Using postgres connection "test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec"
[0m10:39:04.633104 [debug] [Thread-1 (]: On test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_id as unique_field,
    count(*) as n_records

from "telegram_db"."raw_analytics"."dim_channels"
where channel_id is not null
group by channel_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:39:04.637476 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:39:04.642510 [debug] [Thread-1 (]: On test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec: ROLLBACK
[0m10:39:04.645297 [debug] [Thread-1 (]: On test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec: Close
[0m10:39:04.648008 [info ] [Thread-1 (]: 6 of 8 PASS unique_dim_channels_channel_id ..................................... [[32mPASS[0m in 0.14s]
[0m10:39:04.652250 [debug] [Thread-1 (]: Finished running node test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec
[0m10:39:04.655633 [debug] [Thread-1 (]: Began running node test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m10:39:04.658183 [info ] [Thread-1 (]: 7 of 8 START test unique_dim_dates_date_day .................................... [RUN]
[0m10:39:04.662807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec, now test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7)
[0m10:39:04.665406 [debug] [Thread-1 (]: Began compiling node test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m10:39:04.678596 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m10:39:04.700512 [debug] [Thread-1 (]: Began executing node test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m10:39:04.713672 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m10:39:04.735689 [debug] [Thread-1 (]: Using postgres connection "test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m10:39:04.740813 [debug] [Thread-1 (]: On test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7: BEGIN
[0m10:39:04.743796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:04.765874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m10:39:04.768752 [debug] [Thread-1 (]: Using postgres connection "test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m10:39:04.771438 [debug] [Thread-1 (]: On test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_day as unique_field,
    count(*) as n_records

from "telegram_db"."raw_analytics"."dim_dates"
where date_day is not null
group by date_day
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:39:04.776287 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:39:04.781493 [debug] [Thread-1 (]: On test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7: ROLLBACK
[0m10:39:04.784237 [debug] [Thread-1 (]: On test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7: Close
[0m10:39:04.787763 [info ] [Thread-1 (]: 7 of 8 PASS unique_dim_dates_date_day .......................................... [[32mPASS[0m in 0.13s]
[0m10:39:04.792681 [debug] [Thread-1 (]: Finished running node test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m10:39:04.795621 [debug] [Thread-1 (]: Began running node test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d
[0m10:39:04.798463 [info ] [Thread-1 (]: 8 of 8 START test unique_fct_messages_message_id ............................... [RUN]
[0m10:39:04.807820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7, now test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d)
[0m10:39:04.811989 [debug] [Thread-1 (]: Began compiling node test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d
[0m10:39:04.826579 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d"
[0m10:39:04.849128 [debug] [Thread-1 (]: Began executing node test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d
[0m10:39:04.861737 [debug] [Thread-1 (]: Writing runtime sql for node "test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d"
[0m10:39:04.880110 [debug] [Thread-1 (]: Using postgres connection "test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d"
[0m10:39:04.882483 [debug] [Thread-1 (]: On test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d: BEGIN
[0m10:39:04.885335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:39:04.928694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m10:39:04.931025 [debug] [Thread-1 (]: Using postgres connection "test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d"
[0m10:39:04.933749 [debug] [Thread-1 (]: On test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_id as unique_field,
    count(*) as n_records

from "telegram_db"."raw_analytics"."fct_messages"
where message_id is not null
group by message_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:39:04.938025 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:39:04.943309 [debug] [Thread-1 (]: On test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d: ROLLBACK
[0m10:39:04.946180 [debug] [Thread-1 (]: On test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d: Close
[0m10:39:04.949687 [info ] [Thread-1 (]: 8 of 8 PASS unique_fct_messages_message_id ..................................... [[32mPASS[0m in 0.14s]
[0m10:39:04.974760 [debug] [Thread-1 (]: Finished running node test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d
[0m10:39:04.980172 [debug] [MainThread]: Using postgres connection "master"
[0m10:39:04.982065 [debug] [MainThread]: On master: BEGIN
[0m10:39:04.984876 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:39:05.023140 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m10:39:05.034981 [debug] [MainThread]: On master: COMMIT
[0m10:39:05.037777 [debug] [MainThread]: Using postgres connection "master"
[0m10:39:05.040439 [debug] [MainThread]: On master: COMMIT
[0m10:39:05.044429 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:39:05.047460 [debug] [MainThread]: On master: Close
[0m10:39:05.054181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:39:05.073363 [debug] [MainThread]: Connection 'test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d' was properly closed.
[0m10:39:05.078705 [info ] [MainThread]: 
[0m10:39:05.082705 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 2.93 seconds (2.93s).
[0m10:39:05.094012 [debug] [MainThread]: Command end result
[0m10:39:05.431088 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m10:39:05.487002 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m10:39:05.578722 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/telegram_dbt/target/run_results.json
[0m10:39:05.585103 [info ] [MainThread]: 
[0m10:39:05.590623 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:39:05.597356 [info ] [MainThread]: 
[0m10:39:05.601341 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m10:39:05.624227 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.2696824, "process_in_blocks": "89312", "process_kernel_time": 0.673119, "process_mem_max_rss": "121352", "process_out_blocks": "0", "process_user_time": 7.112959}
[0m10:39:05.668394 [debug] [MainThread]: Command `dbt test` succeeded at 10:39:05.667920 after 7.31 seconds
[0m10:39:05.674214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f23b44730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f22a92d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f239fa950>]}
[0m10:39:05.684228 [debug] [MainThread]: Flushing usage events
[0m10:39:19.322149 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:39:28.400980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f0dac820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75efd168f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75efd16950>]}


============================== 10:39:28.418382 | 6cfffb90-2493-4e88-a7a7-2b96f70dfcec ==============================
[0m10:39:28.418382 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:39:28.424952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/telegram_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:39:29.165284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cfffb90-2493-4e88-a7a7-2b96f70dfcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f28244c0>]}
[0m10:39:29.457315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cfffb90-2493-4e88-a7a7-2b96f70dfcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75efea5120>]}
[0m10:39:29.460146 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:39:29.791447 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m10:39:30.691769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:39:30.700269 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:39:30.960396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cfffb90-2493-4e88-a7a7-2b96f70dfcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ee378130>]}
[0m10:39:31.097793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cfffb90-2493-4e88-a7a7-2b96f70dfcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ee3064a0>]}
[0m10:39:31.146240 [info ] [MainThread]: Found 4 models, 8 data tests, 1 source, 433 macros
[0m10:39:31.161214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cfffb90-2493-4e88-a7a7-2b96f70dfcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ee307040>]}
[0m10:39:31.179047 [info ] [MainThread]: 
[0m10:39:31.197605 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:39:31.206629 [info ] [MainThread]: 
[0m10:39:31.225597 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:39:31.267333 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_raw_staging'
[0m10:39:31.822656 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m10:39:31.834376 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m10:39:31.839250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:39:31.985866 [debug] [ThreadPool]: SQL status: BEGIN in 0.147 seconds
[0m10:39:31.988342 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m10:39:31.990762 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m10:39:32.001144 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m10:39:32.007559 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m10:39:32.011956 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m10:39:32.020802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db_raw_staging, now list_telegram_db_raw_analytics)
[0m10:39:32.116026 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m10:39:32.118271 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: BEGIN
[0m10:39:32.120064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:39:32.135883 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m10:39:32.138198 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m10:39:32.143778 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_analytics'
  
[0m10:39:32.151592 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m10:39:32.157620 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: ROLLBACK
[0m10:39:32.163498 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: Close
[0m10:39:32.182903 [debug] [MainThread]: Using postgres connection "master"
[0m10:39:32.187987 [debug] [MainThread]: On master: BEGIN
[0m10:39:32.190321 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:39:32.218582 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m10:39:32.221726 [debug] [MainThread]: Using postgres connection "master"
[0m10:39:32.229249 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:39:32.283742 [debug] [MainThread]: SQL status: SELECT 1 in 0.044 seconds
[0m10:39:32.289048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cfffb90-2493-4e88-a7a7-2b96f70dfcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f22fbf10>]}
[0m10:39:32.294714 [debug] [MainThread]: On master: ROLLBACK
[0m10:39:32.299339 [debug] [MainThread]: On master: Close
[0m10:39:32.307827 [debug] [Thread-1 (]: Began running node model.telegram_dbt.dim_dates
[0m10:39:32.312608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_db_raw_analytics, now model.telegram_dbt.dim_dates)
[0m10:39:32.315513 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.dim_dates
[0m10:39:32.340561 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.dim_dates"
[0m10:39:32.354060 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.dim_dates
[0m10:39:32.356895 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.dim_dates
[0m10:39:32.360786 [debug] [Thread-1 (]: Began running node model.telegram_dbt.stg_telegram_messages
[0m10:39:32.363382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_dbt.dim_dates, now model.telegram_dbt.stg_telegram_messages)
[0m10:39:32.365551 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.stg_telegram_messages
[0m10:39:32.373218 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.stg_telegram_messages"
[0m10:39:32.388242 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.stg_telegram_messages
[0m10:39:32.392087 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.stg_telegram_messages
[0m10:39:32.394657 [debug] [Thread-1 (]: Began running node test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb
[0m10:39:32.396927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_dbt.stg_telegram_messages, now test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb)
[0m10:39:32.398954 [debug] [Thread-1 (]: Began compiling node test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb
[0m10:39:32.429441 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb"
[0m10:39:32.480946 [debug] [Thread-1 (]: Began executing node test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb
[0m10:39:32.484547 [debug] [Thread-1 (]: Finished running node test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb
[0m10:39:32.487351 [debug] [Thread-1 (]: Began running node test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m10:39:32.490027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_dbt.not_null_dim_dates_date_day.1717af99fb, now test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7)
[0m10:39:32.494634 [debug] [Thread-1 (]: Began compiling node test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m10:39:32.512758 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7"
[0m10:39:32.534187 [debug] [Thread-1 (]: Began executing node test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m10:39:32.537431 [debug] [Thread-1 (]: Finished running node test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7
[0m10:39:32.540021 [debug] [Thread-1 (]: Began running node model.telegram_dbt.dim_channels
[0m10:39:32.543157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_dbt.unique_dim_dates_date_day.5e9dfa95c7, now model.telegram_dbt.dim_channels)
[0m10:39:32.546032 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.dim_channels
[0m10:39:32.555860 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.dim_channels"
[0m10:39:32.577752 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.dim_channels
[0m10:39:32.581155 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.dim_channels
[0m10:39:32.583666 [debug] [Thread-1 (]: Began running node model.telegram_dbt.fct_messages
[0m10:39:32.586468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_dbt.dim_channels, now model.telegram_dbt.fct_messages)
[0m10:39:32.589214 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.fct_messages
[0m10:39:32.601183 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.fct_messages"
[0m10:39:32.618084 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.fct_messages
[0m10:39:32.621305 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.fct_messages
[0m10:39:32.624213 [debug] [Thread-1 (]: Began running node test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b
[0m10:39:32.627009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.telegram_dbt.fct_messages, now test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b)
[0m10:39:32.629278 [debug] [Thread-1 (]: Began compiling node test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b
[0m10:39:32.640732 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b"
[0m10:39:32.662963 [debug] [Thread-1 (]: Began executing node test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b
[0m10:39:32.668455 [debug] [Thread-1 (]: Finished running node test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b
[0m10:39:32.670962 [debug] [Thread-1 (]: Began running node test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec
[0m10:39:32.673420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_dbt.not_null_dim_channels_channel_id.93e5e4b23b, now test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec)
[0m10:39:32.676123 [debug] [Thread-1 (]: Began compiling node test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec
[0m10:39:32.689155 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec"
[0m10:39:32.707025 [debug] [Thread-1 (]: Began executing node test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec
[0m10:39:32.710398 [debug] [Thread-1 (]: Finished running node test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec
[0m10:39:32.712643 [debug] [Thread-1 (]: Began running node test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff
[0m10:39:32.715329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_dbt.unique_dim_channels_channel_id.d14657a1ec, now test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff)
[0m10:39:32.717730 [debug] [Thread-1 (]: Began compiling node test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff
[0m10:39:32.728469 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff"
[0m10:39:32.743770 [debug] [Thread-1 (]: Began executing node test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff
[0m10:39:32.747721 [debug] [Thread-1 (]: Finished running node test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff
[0m10:39:32.750263 [debug] [Thread-1 (]: Began running node test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b
[0m10:39:32.753063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_dbt.not_null_fct_messages_channel_id.6c644bffff, now test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b)
[0m10:39:32.755820 [debug] [Thread-1 (]: Began compiling node test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b
[0m10:39:32.770438 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b"
[0m10:39:32.784086 [debug] [Thread-1 (]: Began executing node test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b
[0m10:39:32.786939 [debug] [Thread-1 (]: Finished running node test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b
[0m10:39:32.789147 [debug] [Thread-1 (]: Began running node test.telegram_dbt.not_null_fct_messages_message_id.de346706b5
[0m10:39:32.791317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_dbt.not_null_fct_messages_date_day.a9378d227b, now test.telegram_dbt.not_null_fct_messages_message_id.de346706b5)
[0m10:39:32.793200 [debug] [Thread-1 (]: Began compiling node test.telegram_dbt.not_null_fct_messages_message_id.de346706b5
[0m10:39:32.805220 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_dbt.not_null_fct_messages_message_id.de346706b5"
[0m10:39:32.818449 [debug] [Thread-1 (]: Began executing node test.telegram_dbt.not_null_fct_messages_message_id.de346706b5
[0m10:39:32.821548 [debug] [Thread-1 (]: Finished running node test.telegram_dbt.not_null_fct_messages_message_id.de346706b5
[0m10:39:32.823922 [debug] [Thread-1 (]: Began running node test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d
[0m10:39:32.826020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.telegram_dbt.not_null_fct_messages_message_id.de346706b5, now test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d)
[0m10:39:32.828282 [debug] [Thread-1 (]: Began compiling node test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d
[0m10:39:32.840282 [debug] [Thread-1 (]: Writing injected SQL for node "test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d"
[0m10:39:32.853745 [debug] [Thread-1 (]: Began executing node test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d
[0m10:39:32.857005 [debug] [Thread-1 (]: Finished running node test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d
[0m10:39:32.860515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:39:32.862306 [debug] [MainThread]: Connection 'test.telegram_dbt.unique_fct_messages_message_id.655aa1a48d' was properly closed.
[0m10:39:32.867723 [debug] [MainThread]: Command end result
[0m10:39:33.254736 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m10:39:33.272834 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m10:39:33.316571 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/telegram_dbt/target/run_results.json
[0m10:39:33.515719 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m10:39:33.517717 [info ] [MainThread]: Building catalog
[0m10:39:33.549845 [debug] [ThreadPool]: Acquiring new postgres connection 'telegram_db.information_schema'
[0m10:39:33.588836 [debug] [ThreadPool]: Using postgres connection "telegram_db.information_schema"
[0m10:39:33.598619 [debug] [ThreadPool]: On telegram_db.information_schema: BEGIN
[0m10:39:33.601419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:39:33.635706 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m10:39:33.638688 [debug] [ThreadPool]: Using postgres connection "telegram_db.information_schema"
[0m10:39:33.648774 [debug] [ThreadPool]: On telegram_db.information_schema: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "telegram_db.information_schema"} */

    
    

    select
        'telegram_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('raw_analytics') and
           upper(tbl.relname) = upper('dim_channels')) or (upper(sch.nspname) = upper('raw_staging') and
           upper(tbl.relname) = upper('stg_telegram_messages')) or (upper(sch.nspname) = upper('raw') and
           upper(tbl.relname) = upper('telegram_messages')) or (upper(sch.nspname) = upper('raw_analytics') and
           upper(tbl.relname) = upper('fct_messages')) or (upper(sch.nspname) = upper('raw_analytics') and
           upper(tbl.relname) = upper('dim_dates')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m10:39:33.834260 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.181 seconds
[0m10:39:34.086191 [debug] [ThreadPool]: On telegram_db.information_schema: ROLLBACK
[0m10:39:34.159954 [debug] [ThreadPool]: On telegram_db.information_schema: Close
[0m10:39:34.268255 [debug] [MainThread]: Wrote artifact CatalogArtifact to /app/dbt/telegram_dbt/target/catalog.json
[0m10:39:34.391216 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m10:39:34.404734 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m10:39:34.407940 [info ] [MainThread]: Catalog written to /app/dbt/telegram_dbt/target/catalog.json
[0m10:39:34.569110 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.594415, "process_in_blocks": "3392", "process_kernel_time": 0.711777, "process_mem_max_rss": "118408", "process_out_blocks": "0", "process_user_time": 8.048562}
[0m10:39:34.631641 [debug] [MainThread]: Command `dbt docs generate` succeeded at 10:39:34.631207 after 6.81 seconds
[0m10:39:34.640049 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m10:39:34.671917 [debug] [MainThread]: Connection 'telegram_db.information_schema' was properly closed.
[0m10:39:34.676282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f0dac820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ecd54b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f0c416c0>]}
[0m10:39:34.679621 [debug] [MainThread]: Flushing usage events
[0m10:39:35.912694 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:41:35.177145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91568b4730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915581aa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915581aaa0>]}


============================== 10:41:35.182989 | 14197d57-d0c8-4eb2-8498-f5632f420989 ==============================
[0m10:41:35.182989 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:41:35.186599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/app/dbt/telegram_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:41:35.636758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14197d57-d0c8-4eb2-8498-f5632f420989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9158334220>]}
[0m10:41:35.776543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14197d57-d0c8-4eb2-8498-f5632f420989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91559ad030>]}
[0m10:54:16.877690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe4d40a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe3ca7190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe3ca71f0>]}


============================== 10:54:16.897167 | 4acbf4a3-ba06-4b44-b569-375936377927 ==============================
[0m10:54:16.897167 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:54:16.905248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/app/dbt/telegram_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:54:17.790051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4acbf4a3-ba06-4b44-b569-375936377927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe6804130>]}
[0m10:54:17.949658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4acbf4a3-ba06-4b44-b569-375936377927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe4c17a90>]}
[0m10:55:29.899841 [error] [MainThread]: Encountered an error:

[0m10:55:30.087018 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
  File "/usr/local/lib/python3.10/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m10:55:30.098685 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 73.51893, "process_in_blocks": "86024", "process_kernel_time": 0.538515, "process_mem_max_rss": "104404", "process_out_blocks": "1152", "process_user_time": 4.178482}
[0m10:55:30.102003 [debug] [MainThread]: Command `dbt docs serve` failed at 10:55:30.101624 after 73.52 seconds
[0m10:55:30.104367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe4d40a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe45330a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe33ed7e0>]}
[0m10:55:30.109412 [debug] [MainThread]: Flushing usage events
[0m10:55:34.796624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:55:42.265205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3dd4a07c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3dc3e6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3dc3e69b0>]}


============================== 10:55:42.273249 | 93c09158-b444-4880-ae94-7c470be6becc ==============================
[0m10:55:42.273249 [info ] [MainThread]: Running with dbt=1.10.4
[0m10:55:42.277111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/telegram_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs serve --port 8080 --host 0.0.0.0', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:55:42.689401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93c09158-b444-4880-ae94-7c470be6becc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3def05f90>]}
[0m10:55:43.384189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93c09158-b444-4880-ae94-7c470be6becc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3dc3a92d0>]}
[0m11:08:47.127241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedcaec8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc9e1b160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc9e1b1c0>]}


============================== 11:08:47.149911 | e6816c15-6da4-4258-adbc-7b3713bf2eda ==============================
[0m11:08:47.149911 [info ] [MainThread]: Running with dbt=1.10.4
[0m11:08:47.154742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/telegram_dbt/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m11:08:48.075228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6816c15-6da4-4258-adbc-7b3713bf2eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedcb1b80d0>]}
[0m11:08:48.251505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6816c15-6da4-4258-adbc-7b3713bf2eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedcad987f0>]}
[0m11:15:29.426310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b730d0a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b72063f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b72063f10>]}


============================== 11:15:29.560618 | 4a808f44-ea39-41a7-b53a-4ab4fa94979f ==============================
[0m11:15:29.560618 [info ] [MainThread]: Running with dbt=1.10.4
[0m11:15:29.570094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/telegram_dbt/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs serve --port 8080 --host 0.0.0.0', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:15:30.483044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a808f44-ea39-41a7-b53a-4ab4fa94979f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7201e4a0>]}
[0m11:15:30.786035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a808f44-ea39-41a7-b53a-4ab4fa94979f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b72faa830>]}
[0m14:45:33.891036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf68909d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf5802830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf5802890>]}


============================== 14:45:33.907933 | 1c48ccb1-3218-4b33-8c9b-b00117fca212 ==============================
[0m14:45:33.907933 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:45:33.913073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/app/dbt/telegram_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select fct_image_detections', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:45:34.519931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c48ccb1-3218-4b33-8c9b-b00117fca212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf4b13f10>]}
[0m14:45:34.645754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c48ccb1-3218-4b33-8c9b-b00117fca212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf60a3820>]}
[0m14:45:34.649919 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:45:34.921230 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:45:36.171250 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:45:36.173915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1c48ccb1-3218-4b33-8c9b-b00117fca212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf6077ac0>]}
[0m14:45:40.091480 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.telegram_dbt.fct_image_detections' (models/marts/fct_image_detections.sql) depends on a source named 'raw.image_detections' which was not found
[0m14:45:40.228640 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.5907335, "process_in_blocks": "86800", "process_kernel_time": 0.367785, "process_mem_max_rss": "115864", "process_out_blocks": "424", "process_user_time": 6.808997}
[0m14:45:40.249701 [debug] [MainThread]: Command `dbt run` failed at 14:45:40.248620 after 6.61 seconds
[0m14:45:40.255828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf68909d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf3bb4d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf3756140>]}
[0m14:45:40.260210 [debug] [MainThread]: Flushing usage events
[0m14:45:41.560950 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:29.981822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc74c04850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc73b4ae60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc73b4aec0>]}


============================== 14:50:30.016617 | cdd9341e-b69e-4b91-8617-d9426bbabebc ==============================
[0m14:50:30.016617 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:50:30.027066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/dbt/telegram_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select fct_image_detections', 'send_anonymous_usage_stats': 'True'}
[0m14:50:30.935340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdd9341e-b69e-4b91-8617-d9426bbabebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc73b1bfd0>]}
[0m14:50:31.067765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdd9341e-b69e-4b91-8617-d9426bbabebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc743f09a0>]}
[0m14:50:31.079590 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:50:31.620600 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:50:31.929403 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:50:31.933235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cdd9341e-b69e-4b91-8617-d9426bbabebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc7437b880>]}
[0m14:50:36.678151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdd9341e-b69e-4b91-8617-d9426bbabebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc70de8130>]}
[0m14:50:37.078639 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m14:50:37.096524 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m14:50:37.211084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdd9341e-b69e-4b91-8617-d9426bbabebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc70de1fc0>]}
[0m14:50:37.214663 [info ] [MainThread]: Found 5 models, 8 data tests, 2 sources, 434 macros
[0m14:50:37.220573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdd9341e-b69e-4b91-8617-d9426bbabebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc75718a30>]}
[0m14:50:37.229494 [info ] [MainThread]: 
[0m14:50:37.233663 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:50:37.259969 [info ] [MainThread]: 
[0m14:50:37.268713 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:50:37.275296 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m14:50:38.564685 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m14:50:38.568755 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m14:50:38.570795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:38.714999 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.144 seconds
[0m14:50:38.721766 [debug] [ThreadPool]: On list_telegram_db: Close
[0m14:50:38.736231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db, now list_telegram_db_raw_staging)
[0m14:50:38.749913 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m14:50:38.752216 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m14:50:38.754444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:39.173198 [debug] [ThreadPool]: SQL status: BEGIN in 0.422 seconds
[0m14:50:39.182562 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m14:50:39.186131 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m14:50:39.499952 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.310 seconds
[0m14:50:39.511972 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m14:50:39.519720 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m14:50:39.527945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db_raw_staging, now list_telegram_db_raw_analytics)
[0m14:50:39.538640 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m14:50:39.542229 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: BEGIN
[0m14:50:39.545340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:39.561773 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m14:50:39.563545 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m14:50:39.565435 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_analytics'
  
[0m14:50:39.571105 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m14:50:39.574539 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: ROLLBACK
[0m14:50:39.576704 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: Close
[0m14:50:39.839273 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:39.846650 [debug] [MainThread]: On master: BEGIN
[0m14:50:39.849582 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:39.863118 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m14:50:39.865759 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:39.868239 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:50:40.268083 [debug] [MainThread]: SQL status: SELECT 1 in 0.397 seconds
[0m14:50:40.272915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdd9341e-b69e-4b91-8617-d9426bbabebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc76487f10>]}
[0m14:50:40.275741 [debug] [MainThread]: On master: ROLLBACK
[0m14:50:40.278842 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:40.281890 [debug] [MainThread]: On master: BEGIN
[0m14:50:40.285596 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:50:40.287969 [debug] [MainThread]: On master: COMMIT
[0m14:50:40.290364 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:40.292937 [debug] [MainThread]: On master: COMMIT
[0m14:50:40.296129 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:50:40.298538 [debug] [MainThread]: On master: Close
[0m14:50:40.558002 [debug] [Thread-1 (]: Began running node model.telegram_dbt.fct_image_detections
[0m14:50:40.560878 [info ] [Thread-1 (]: 1 of 1 START sql incremental model raw_analytics.fct_image_detections .......... [RUN]
[0m14:50:40.563689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_db_raw_analytics, now model.telegram_dbt.fct_image_detections)
[0m14:50:40.565870 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.fct_image_detections
[0m14:50:40.590588 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.fct_image_detections"
[0m14:50:40.607644 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.fct_image_detections
[0m14:50:40.736291 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.fct_image_detections"
[0m14:50:40.876118 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m14:50:40.881004 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: BEGIN
[0m14:50:40.886223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:40.909521 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m14:50:40.911939 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m14:50:40.914463 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_image_detections"} */

      
  
    

  create  table "telegram_db"."raw_analytics"."fct_image_detections"
  
  
    as
  
  (
    

SELECT
    d.id AS detection_id,
    d.message_id,
    m.channel,
    m.date,
    d.object_class,
    d.confidence
FROM "telegram_db"."raw"."image_detections" d
LEFT JOIN "telegram_db"."raw_analytics"."fct_messages" m
    ON d.message_id = m.id


  );
  
  
[0m14:50:40.924803 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column m.id does not exist
LINE 24:     ON d.message_id = m.id
                               ^
HINT:  Perhaps you meant to reference the column "d.id".

[0m14:50:40.927262 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: ROLLBACK
[0m14:50:40.930118 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: Close
[0m14:50:40.956569 [debug] [Thread-1 (]: Database Error in model fct_image_detections (models/marts/fct_image_detections.sql)
  column m.id does not exist
  LINE 24:     ON d.message_id = m.id
                                 ^
  HINT:  Perhaps you meant to reference the column "d.id".
  compiled code at target/run/telegram_dbt/models/marts/fct_image_detections.sql
[0m14:50:40.963504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdd9341e-b69e-4b91-8617-d9426bbabebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc71739f00>]}
[0m14:50:40.966189 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model raw_analytics.fct_image_detections . [[31mERROR[0m in 0.40s]
[0m14:50:40.970230 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.fct_image_detections
[0m14:50:40.974843 [debug] [Thread-4 (]: Marking all children of 'model.telegram_dbt.fct_image_detections' to be skipped because of status 'error'.  Reason: Database Error in model fct_image_detections (models/marts/fct_image_detections.sql)
  column m.id does not exist
  LINE 24:     ON d.message_id = m.id
                                 ^
  HINT:  Perhaps you meant to reference the column "d.id".
  compiled code at target/run/telegram_dbt/models/marts/fct_image_detections.sql.
[0m14:50:40.984161 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:40.987010 [debug] [MainThread]: On master: BEGIN
[0m14:50:40.989580 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:41.005095 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m14:50:41.007907 [debug] [MainThread]: On master: COMMIT
[0m14:50:41.009963 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:41.012615 [debug] [MainThread]: On master: COMMIT
[0m14:50:41.014968 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:50:41.017311 [debug] [MainThread]: On master: Close
[0m14:50:41.243708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:41.254297 [debug] [MainThread]: Connection 'model.telegram_dbt.fct_image_detections' was properly closed.
[0m14:50:41.262157 [info ] [MainThread]: 
[0m14:50:41.272787 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m14:50:41.286406 [debug] [MainThread]: Command end result
[0m14:50:41.663101 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m14:50:41.673208 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m14:50:41.720408 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/telegram_dbt/target/run_results.json
[0m14:50:41.722811 [info ] [MainThread]: 
[0m14:50:41.727400 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:50:41.733817 [info ] [MainThread]: 
[0m14:50:41.739105 [error] [MainThread]: [31mFailure in model fct_image_detections (models/marts/fct_image_detections.sql)[0m
[0m14:50:41.743437 [error] [MainThread]:   Database Error in model fct_image_detections (models/marts/fct_image_detections.sql)
  column m.id does not exist
  LINE 24:     ON d.message_id = m.id
                                 ^
  HINT:  Perhaps you meant to reference the column "d.id".
  compiled code at target/run/telegram_dbt/models/marts/fct_image_detections.sql
[0m14:50:41.750463 [info ] [MainThread]: 
[0m14:50:41.754444 [info ] [MainThread]:   compiled code at target/compiled/telegram_dbt/models/marts/fct_image_detections.sql
[0m14:50:41.758817 [info ] [MainThread]: 
[0m14:50:41.765380 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:50:41.775881 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.090656, "process_in_blocks": "91008", "process_kernel_time": 0.6779, "process_mem_max_rss": "126260", "process_out_blocks": "16", "process_user_time": 10.349285}
[0m14:50:41.781001 [debug] [MainThread]: Command `dbt run` failed at 14:50:41.780626 after 12.10 seconds
[0m14:50:41.783160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc74c04850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc70dc5450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc71792cb0>]}
[0m14:50:41.785394 [debug] [MainThread]: Flushing usage events
[0m14:50:43.115340 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:51:03.131885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208333c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20822aae60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20822aaec0>]}


============================== 14:51:03.139227 | 7b91bad3-a305-4f73-908c-f0c358ff1889 ==============================
[0m14:51:03.139227 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:51:03.142910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/app/dbt/telegram_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select fct_image_detections', 'send_anonymous_usage_stats': 'True'}
[0m14:51:03.550877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b91bad3-a305-4f73-908c-f0c358ff1889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20822aae30>]}
[0m14:51:03.677391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b91bad3-a305-4f73-908c-f0c358ff1889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2082435180>]}
[0m14:51:03.680244 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:51:03.877108 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:51:04.435785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:51:04.466601 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:51:04.747129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b91bad3-a305-4f73-908c-f0c358ff1889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208096c130>]}
[0m14:51:04.994655 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m14:51:05.006086 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m14:51:05.040562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b91bad3-a305-4f73-908c-f0c358ff1889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2080deee60>]}
[0m14:51:05.043275 [info ] [MainThread]: Found 5 models, 8 data tests, 2 sources, 434 macros
[0m14:51:05.046353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b91bad3-a305-4f73-908c-f0c358ff1889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2080dee770>]}
[0m14:51:05.051734 [info ] [MainThread]: 
[0m14:51:05.056969 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:51:05.069535 [info ] [MainThread]: 
[0m14:51:05.075202 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:51:05.086282 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m14:51:05.231021 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m14:51:05.233198 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m14:51:05.235619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:05.315858 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.080 seconds
[0m14:51:05.321904 [debug] [ThreadPool]: On list_telegram_db: Close
[0m14:51:05.509913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db, now list_telegram_db_raw_staging)
[0m14:51:05.537488 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m14:51:05.540160 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m14:51:05.542835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:05.557297 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m14:51:05.559357 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m14:51:05.561328 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m14:51:05.567994 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m14:51:05.571744 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m14:51:05.574060 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m14:51:05.628268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db_raw_staging, now list_telegram_db_raw_analytics)
[0m14:51:05.642791 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m14:51:05.645402 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: BEGIN
[0m14:51:05.648077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:05.670407 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m14:51:05.673847 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m14:51:05.676640 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_analytics'
  
[0m14:51:05.684428 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m14:51:05.688587 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: ROLLBACK
[0m14:51:05.691546 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: Close
[0m14:51:05.878972 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:05.884917 [debug] [MainThread]: On master: BEGIN
[0m14:51:05.890308 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:05.924875 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m14:51:05.928688 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:05.933184 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:51:05.957211 [debug] [MainThread]: SQL status: SELECT 1 in 0.020 seconds
[0m14:51:05.961032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b91bad3-a305-4f73-908c-f0c358ff1889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2080919ff0>]}
[0m14:51:06.087391 [debug] [MainThread]: On master: ROLLBACK
[0m14:51:06.095519 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:06.103450 [debug] [MainThread]: On master: BEGIN
[0m14:51:06.113506 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:51:06.119822 [debug] [MainThread]: On master: COMMIT
[0m14:51:06.124342 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:06.129009 [debug] [MainThread]: On master: COMMIT
[0m14:51:06.134192 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:51:06.138844 [debug] [MainThread]: On master: Close
[0m14:51:06.265298 [debug] [Thread-1 (]: Began running node model.telegram_dbt.fct_image_detections
[0m14:51:06.274466 [info ] [Thread-1 (]: 1 of 1 START sql incremental model raw_analytics.fct_image_detections .......... [RUN]
[0m14:51:06.292841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_db_raw_analytics, now model.telegram_dbt.fct_image_detections)
[0m14:51:06.298281 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.fct_image_detections
[0m14:51:06.344586 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.fct_image_detections"
[0m14:51:06.361348 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.fct_image_detections
[0m14:51:06.481734 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.fct_image_detections"
[0m14:51:06.497625 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m14:51:06.499893 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: BEGIN
[0m14:51:06.502358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:06.515799 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m14:51:06.518431 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m14:51:06.521422 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_image_detections"} */

      
  
    

  create  table "telegram_db"."raw_analytics"."fct_image_detections"
  
  
    as
  
  (
    

SELECT
    d.id AS detection_id,
    d.message_id,
    m.channel,
    m.date,
    d.object_class,
    d.confidence
FROM "telegram_db"."raw"."image_detections" d
LEFT JOIN "telegram_db"."raw_analytics"."fct_messages" m
    ON d.message_id = m.id


  );
  
  
[0m14:51:06.525855 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column m.id does not exist
LINE 24:     ON d.message_id = m.id
                               ^
HINT:  Perhaps you meant to reference the column "d.id".

[0m14:51:06.528750 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: ROLLBACK
[0m14:51:06.531750 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: Close
[0m14:51:06.538733 [debug] [Thread-1 (]: Database Error in model fct_image_detections (models/marts/fct_image_detections.sql)
  column m.id does not exist
  LINE 24:     ON d.message_id = m.id
                                 ^
  HINT:  Perhaps you meant to reference the column "d.id".
  compiled code at target/run/telegram_dbt/models/marts/fct_image_detections.sql
[0m14:51:06.544871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b91bad3-a305-4f73-908c-f0c358ff1889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20836275e0>]}
[0m14:51:06.548440 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model raw_analytics.fct_image_detections . [[31mERROR[0m in 0.25s]
[0m14:51:06.552465 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.fct_image_detections
[0m14:51:06.555668 [debug] [Thread-4 (]: Marking all children of 'model.telegram_dbt.fct_image_detections' to be skipped because of status 'error'.  Reason: Database Error in model fct_image_detections (models/marts/fct_image_detections.sql)
  column m.id does not exist
  LINE 24:     ON d.message_id = m.id
                                 ^
  HINT:  Perhaps you meant to reference the column "d.id".
  compiled code at target/run/telegram_dbt/models/marts/fct_image_detections.sql.
[0m14:51:06.561442 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:06.563898 [debug] [MainThread]: On master: BEGIN
[0m14:51:06.566028 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:06.579280 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m14:51:06.583046 [debug] [MainThread]: On master: COMMIT
[0m14:51:06.588118 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:06.590718 [debug] [MainThread]: On master: COMMIT
[0m14:51:06.595701 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:06.598517 [debug] [MainThread]: On master: Close
[0m14:51:06.601854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:06.604927 [debug] [MainThread]: Connection 'model.telegram_dbt.fct_image_detections' was properly closed.
[0m14:51:06.608482 [info ] [MainThread]: 
[0m14:51:06.613513 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.53 seconds (1.53s).
[0m14:51:06.618303 [debug] [MainThread]: Command end result
[0m14:51:06.717976 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m14:51:06.728432 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m14:51:06.747640 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/telegram_dbt/target/run_results.json
[0m14:51:06.749719 [info ] [MainThread]: 
[0m14:51:06.752323 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:51:06.755373 [info ] [MainThread]: 
[0m14:51:06.759106 [error] [MainThread]: [31mFailure in model fct_image_detections (models/marts/fct_image_detections.sql)[0m
[0m14:51:06.771327 [error] [MainThread]:   Database Error in model fct_image_detections (models/marts/fct_image_detections.sql)
  column m.id does not exist
  LINE 24:     ON d.message_id = m.id
                                 ^
  HINT:  Perhaps you meant to reference the column "d.id".
  compiled code at target/run/telegram_dbt/models/marts/fct_image_detections.sql
[0m14:51:06.775400 [info ] [MainThread]: 
[0m14:51:06.780791 [info ] [MainThread]:   compiled code at target/compiled/telegram_dbt/models/marts/fct_image_detections.sql
[0m14:51:06.787971 [info ] [MainThread]: 
[0m14:51:06.794157 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:51:06.799410 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.8074584, "process_in_blocks": "0", "process_kernel_time": 0.345417, "process_mem_max_rss": "118144", "process_out_blocks": "0", "process_user_time": 5.073326}
[0m14:51:06.801778 [debug] [MainThread]: Command `dbt run` failed at 14:51:06.801476 after 3.81 seconds
[0m14:51:06.803686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f208333c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20831ccbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20809bab90>]}
[0m14:51:06.805967 [debug] [MainThread]: Flushing usage events
[0m14:51:07.910081 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:54:02.518762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea990c8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea8862e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea8862ec0>]}


============================== 14:54:02.528533 | a6044885-4802-4630-9a00-e10d864c7afc ==============================
[0m14:54:02.528533 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:54:02.532558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/app/dbt/telegram_dbt/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select fct_image_detections', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:54:02.892731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6044885-4802-4630-9a00-e10d864c7afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea7f583a0>]}
[0m14:54:03.017853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6044885-4802-4630-9a00-e10d864c7afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea89f11b0>]}
[0m14:54:03.020603 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:54:03.222343 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:54:04.011639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:54:04.014108 [debug] [MainThread]: Partial parsing: updated file: telegram_dbt://models/marts/fct_image_detections.sql
[0m14:54:04.663479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6044885-4802-4630-9a00-e10d864c7afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea90a3e80>]}
[0m14:54:04.923978 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m14:54:04.941830 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m14:54:04.976563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6044885-4802-4630-9a00-e10d864c7afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea90c5390>]}
[0m14:54:04.978921 [info ] [MainThread]: Found 5 models, 8 data tests, 2 sources, 434 macros
[0m14:54:04.982044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6044885-4802-4630-9a00-e10d864c7afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea7b1ec50>]}
[0m14:54:04.987879 [info ] [MainThread]: 
[0m14:54:04.990666 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:54:04.994372 [info ] [MainThread]: 
[0m14:54:04.999486 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:54:05.003209 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m14:54:05.078470 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m14:54:05.080675 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m14:54:05.082734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:05.109016 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.026 seconds
[0m14:54:05.113613 [debug] [ThreadPool]: On list_telegram_db: Close
[0m14:54:05.131230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db, now list_telegram_db_raw_staging)
[0m14:54:05.148630 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m14:54:05.152037 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m14:54:05.154203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:05.169393 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m14:54:05.171485 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m14:54:05.173616 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m14:54:05.179989 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m14:54:05.183462 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m14:54:05.185792 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m14:54:05.188484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db_raw_staging, now list_telegram_db_raw_analytics)
[0m14:54:05.194991 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m14:54:05.305757 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: BEGIN
[0m14:54:05.312168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:05.356494 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m14:54:05.362081 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m14:54:05.368740 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_analytics'
  
[0m14:54:05.387314 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.012 seconds
[0m14:54:05.398247 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: ROLLBACK
[0m14:54:05.403654 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: Close
[0m14:54:05.426326 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:05.430036 [debug] [MainThread]: On master: BEGIN
[0m14:54:05.433563 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:05.528123 [debug] [MainThread]: SQL status: BEGIN in 0.094 seconds
[0m14:54:05.533701 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:05.538332 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:54:05.570273 [debug] [MainThread]: SQL status: SELECT 1 in 0.027 seconds
[0m14:54:05.574048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6044885-4802-4630-9a00-e10d864c7afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea733ee60>]}
[0m14:54:05.576484 [debug] [MainThread]: On master: ROLLBACK
[0m14:54:05.579357 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:05.581744 [debug] [MainThread]: On master: BEGIN
[0m14:54:05.585105 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:54:05.587509 [debug] [MainThread]: On master: COMMIT
[0m14:54:05.589683 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:05.591750 [debug] [MainThread]: On master: COMMIT
[0m14:54:05.594373 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:54:05.596578 [debug] [MainThread]: On master: Close
[0m14:54:05.694069 [debug] [Thread-1 (]: Began running node model.telegram_dbt.fct_image_detections
[0m14:54:05.701885 [info ] [Thread-1 (]: 1 of 1 START sql incremental model raw_analytics.fct_image_detections .......... [RUN]
[0m14:54:05.712480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_db_raw_analytics, now model.telegram_dbt.fct_image_detections)
[0m14:54:05.716794 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.fct_image_detections
[0m14:54:05.751268 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.fct_image_detections"
[0m14:54:05.767852 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.fct_image_detections
[0m14:54:05.894622 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.fct_image_detections"
[0m14:54:05.910651 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m14:54:05.913548 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: BEGIN
[0m14:54:05.916291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:05.929975 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m14:54:05.932400 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m14:54:05.934985 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_image_detections"} */

      
  
    

  create  table "telegram_db"."raw_analytics"."fct_image_detections"
  
  
    as
  
  (
    

SELECT
    d.id AS detection_id,
    d.message_id,
    m.channel,
    m.date,
    d.object_class,
    d.confidence
FROM "telegram_db"."raw"."image_detections" d
LEFT JOIN "telegram_db"."raw_analytics"."fct_messages" m
    ON d.message_id = m.message_id


  );
  
  
[0m14:54:06.094001 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column m.channel does not exist
LINE 18:     m.channel,
             ^
HINT:  Perhaps you meant to reference the column "m.channel_id".

[0m14:54:06.105027 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: ROLLBACK
[0m14:54:06.114826 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: Close
[0m14:54:06.132387 [debug] [Thread-1 (]: Database Error in model fct_image_detections (models/marts/fct_image_detections.sql)
  column m.channel does not exist
  LINE 18:     m.channel,
               ^
  HINT:  Perhaps you meant to reference the column "m.channel_id".
  compiled code at target/run/telegram_dbt/models/marts/fct_image_detections.sql
[0m14:54:06.146644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6044885-4802-4630-9a00-e10d864c7afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea7b77280>]}
[0m14:54:06.152598 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model raw_analytics.fct_image_detections . [[31mERROR[0m in 0.42s]
[0m14:54:06.156993 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.fct_image_detections
[0m14:54:06.159713 [debug] [Thread-4 (]: Marking all children of 'model.telegram_dbt.fct_image_detections' to be skipped because of status 'error'.  Reason: Database Error in model fct_image_detections (models/marts/fct_image_detections.sql)
  column m.channel does not exist
  LINE 18:     m.channel,
               ^
  HINT:  Perhaps you meant to reference the column "m.channel_id".
  compiled code at target/run/telegram_dbt/models/marts/fct_image_detections.sql.
[0m14:54:06.165200 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:06.167378 [debug] [MainThread]: On master: BEGIN
[0m14:54:06.169514 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:54:06.185240 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m14:54:06.187411 [debug] [MainThread]: On master: COMMIT
[0m14:54:06.189407 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:06.191653 [debug] [MainThread]: On master: COMMIT
[0m14:54:06.194748 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:54:06.197609 [debug] [MainThread]: On master: Close
[0m14:54:06.327810 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:06.335261 [debug] [MainThread]: Connection 'model.telegram_dbt.fct_image_detections' was properly closed.
[0m14:54:06.346813 [info ] [MainThread]: 
[0m14:54:06.363111 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m14:54:06.375411 [debug] [MainThread]: Command end result
[0m14:54:06.469840 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m14:54:06.480875 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m14:54:06.533622 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/telegram_dbt/target/run_results.json
[0m14:54:06.536219 [info ] [MainThread]: 
[0m14:54:06.541464 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:54:06.547298 [info ] [MainThread]: 
[0m14:54:06.551160 [error] [MainThread]: [31mFailure in model fct_image_detections (models/marts/fct_image_detections.sql)[0m
[0m14:54:06.554608 [error] [MainThread]:   Database Error in model fct_image_detections (models/marts/fct_image_detections.sql)
  column m.channel does not exist
  LINE 18:     m.channel,
               ^
  HINT:  Perhaps you meant to reference the column "m.channel_id".
  compiled code at target/run/telegram_dbt/models/marts/fct_image_detections.sql
[0m14:54:06.557863 [info ] [MainThread]: 
[0m14:54:06.564124 [info ] [MainThread]:   compiled code at target/compiled/telegram_dbt/models/marts/fct_image_detections.sql
[0m14:54:06.567100 [info ] [MainThread]: 
[0m14:54:06.570999 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:54:06.577964 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.2087555, "process_in_blocks": "0", "process_kernel_time": 0.296811, "process_mem_max_rss": "122884", "process_out_blocks": "0", "process_user_time": 5.194201}
[0m14:54:06.581732 [debug] [MainThread]: Command `dbt run` failed at 14:54:06.581379 after 4.21 seconds
[0m14:54:06.584337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea990c8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea90c4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea90a3e80>]}
[0m14:54:06.586606 [debug] [MainThread]: Flushing usage events
[0m14:54:10.591434 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:56:31.546921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8259e0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff82492ae60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff82492aec0>]}


============================== 14:56:31.552857 | 5c4f197c-5a98-470b-ab43-4dcad4f2ab2f ==============================
[0m14:56:31.552857 [info ] [MainThread]: Running with dbt=1.10.4
[0m14:56:31.557039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/telegram_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select fct_image_detections', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:56:31.896856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c4f197c-5a98-470b-ab43-4dcad4f2ab2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8248f4940>]}
[0m14:56:32.031365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c4f197c-5a98-470b-ab43-4dcad4f2ab2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8251ce1a0>]}
[0m14:56:32.037297 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:56:32.260723 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m14:56:33.488004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:56:33.683971 [debug] [MainThread]: Partial parsing: updated file: telegram_dbt://models/marts/fct_messages.sql
[0m14:56:34.689386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c4f197c-5a98-470b-ab43-4dcad4f2ab2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff822428130>]}
[0m14:56:34.935129 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m14:56:34.947269 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m14:56:34.969346 [error] [MainThread]: Encountered an error:
Found a cycle: model.telegram_dbt.fct_messages
[0m14:56:35.058536 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 355, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/requires.py", line 372, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/cli/main.py", line 586, in run
    results = task.run()
  File "/usr/local/lib/python3.10/site-packages/dbt/task/runnable.py", line 583, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.10/site-packages/dbt/task/compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.10/site-packages/dbt/task/runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "/usr/local/lib/python3.10/site-packages/dbt/task/base.py", line 135, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
  File "/usr/local/lib/python3.10/site-packages/dbt/compilation.py", line 662, in compile
    linker.link_graph(manifest)
  File "/usr/local/lib/python3.10/site-packages/dbt/compilation.py", line 206, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.telegram_dbt.fct_messages

[0m14:56:35.063489 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.6517472, "process_in_blocks": "152", "process_kernel_time": 0.199755, "process_mem_max_rss": "112860", "process_out_blocks": "0", "process_user_time": 4.61435}
[0m14:56:35.068644 [debug] [MainThread]: Command `dbt run` failed at 14:56:35.068132 after 3.66 seconds
[0m14:56:35.071742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8259e0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff822428310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff82242b430>]}
[0m14:56:35.076221 [debug] [MainThread]: Flushing usage events
[0m14:56:36.209061 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:01.143127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c4dc4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c3d1ae60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c3d1aec0>]}


============================== 15:01:01.149593 | 6033cc16-c5cf-4655-a242-add5f64cda5d ==============================
[0m15:01:01.149593 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:01:01.153546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/dbt/telegram_dbt/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select fct_image_detections', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:01:01.524662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6033cc16-c5cf-4655-a242-add5f64cda5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c3d1ae30>]}
[0m15:01:01.650672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6033cc16-c5cf-4655-a242-add5f64cda5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c3ea9180>]}
[0m15:01:01.653692 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:01:01.851311 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:01:02.344326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:01:02.346860 [debug] [MainThread]: Partial parsing: updated file: telegram_dbt://models/marts/fct_image_detections.sql
[0m15:01:02.349439 [debug] [MainThread]: Partial parsing: updated file: telegram_dbt://models/marts/fct_messages.sql
[0m15:01:03.368647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6033cc16-c5cf-4655-a242-add5f64cda5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c3375810>]}
[0m15:01:03.635636 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m15:01:03.646482 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m15:01:03.679887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6033cc16-c5cf-4655-a242-add5f64cda5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c1f5b970>]}
[0m15:01:03.682291 [info ] [MainThread]: Found 5 models, 8 data tests, 2 sources, 434 macros
[0m15:01:03.685248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6033cc16-c5cf-4655-a242-add5f64cda5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c2b7a710>]}
[0m15:01:03.690870 [info ] [MainThread]: 
[0m15:01:03.693653 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:01:03.697347 [info ] [MainThread]: 
[0m15:01:03.701565 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:01:03.705326 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m15:01:03.795233 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m15:01:03.797446 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m15:01:03.799719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:03.814584 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.015 seconds
[0m15:01:03.818293 [debug] [ThreadPool]: On list_telegram_db: Close
[0m15:01:03.830048 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db, now list_telegram_db_raw_analytics)
[0m15:01:03.844502 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m15:01:03.846570 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: BEGIN
[0m15:01:03.848622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:03.862556 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m15:01:03.864625 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m15:01:03.866618 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_analytics'
  
[0m15:01:03.872297 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m15:01:03.875901 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: ROLLBACK
[0m15:01:03.878046 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: Close
[0m15:01:04.481032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db_raw_analytics, now list_telegram_db_raw_staging)
[0m15:01:04.518346 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m15:01:04.524615 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m15:01:04.528769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:04.549377 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m15:01:04.551644 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m15:01:04.554471 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m15:01:04.560614 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m15:01:04.564665 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m15:01:04.567220 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m15:01:04.590433 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:04.594293 [debug] [MainThread]: On master: BEGIN
[0m15:01:04.601603 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:01:04.620699 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m15:01:04.623480 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:04.626320 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:01:04.646653 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m15:01:04.649841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6033cc16-c5cf-4655-a242-add5f64cda5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c23a4190>]}
[0m15:01:04.651819 [debug] [MainThread]: On master: ROLLBACK
[0m15:01:04.654159 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:04.656558 [debug] [MainThread]: On master: BEGIN
[0m15:01:04.659555 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:01:04.661520 [debug] [MainThread]: On master: COMMIT
[0m15:01:04.663455 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:04.665147 [debug] [MainThread]: On master: COMMIT
[0m15:01:04.667201 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:01:04.668915 [debug] [MainThread]: On master: Close
[0m15:01:04.674508 [debug] [Thread-1 (]: Began running node model.telegram_dbt.fct_image_detections
[0m15:01:04.676698 [info ] [Thread-1 (]: 1 of 1 START sql incremental model raw_analytics.fct_image_detections .......... [RUN]
[0m15:01:04.679608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_db_raw_staging, now model.telegram_dbt.fct_image_detections)
[0m15:01:04.682199 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.fct_image_detections
[0m15:01:04.703390 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.fct_image_detections"
[0m15:01:04.717092 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.fct_image_detections
[0m15:01:04.846003 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.fct_image_detections"
[0m15:01:04.858533 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m15:01:04.860604 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: BEGIN
[0m15:01:04.862700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:04.890805 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m15:01:04.893219 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m15:01:04.895629 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_image_detections"} */

      
  
    

  create  table "telegram_db"."raw_analytics"."fct_image_detections"
  
  
    as
  
  (
    

SELECT
    d.id AS detection_id,
    d.message_id,
    m.channel_id,
    m.date_day AS date,
    d.object_class,
    d.confidence
FROM "telegram_db"."raw"."image_detections" d
LEFT JOIN "telegram_db"."raw_analytics"."fct_messages" m
    ON d.message_id = m.message_id


  );
  
  
[0m15:01:04.952667 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.054 seconds
[0m15:01:04.992348 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: COMMIT
[0m15:01:05.001833 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m15:01:05.004280 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: COMMIT
[0m15:01:05.019467 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m15:01:05.025200 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: Close
[0m15:01:05.030395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6033cc16-c5cf-4655-a242-add5f64cda5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c1b5efe0>]}
[0m15:01:05.037867 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model raw_analytics.fct_image_detections ..... [[32mSELECT 0[0m in 0.35s]
[0m15:01:05.042008 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.fct_image_detections
[0m15:01:05.046711 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:05.049220 [debug] [MainThread]: On master: BEGIN
[0m15:01:05.051734 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:01:05.065724 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m15:01:05.067762 [debug] [MainThread]: On master: COMMIT
[0m15:01:05.071155 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:05.074315 [debug] [MainThread]: On master: COMMIT
[0m15:01:05.077692 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:01:05.079781 [debug] [MainThread]: On master: Close
[0m15:01:05.082074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:05.084052 [debug] [MainThread]: Connection 'model.telegram_dbt.fct_image_detections' was properly closed.
[0m15:01:05.086377 [info ] [MainThread]: 
[0m15:01:05.090255 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m15:01:05.094738 [debug] [MainThread]: Command end result
[0m15:01:05.188135 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m15:01:05.198941 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m15:01:05.221167 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/telegram_dbt/target/run_results.json
[0m15:01:05.223125 [info ] [MainThread]: 
[0m15:01:05.231936 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:01:05.235046 [info ] [MainThread]: 
[0m15:01:05.239895 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:01:05.246080 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.3081064, "process_in_blocks": "0", "process_kernel_time": 0.320936, "process_mem_max_rss": "126572", "process_out_blocks": "0", "process_user_time": 5.787917}
[0m15:01:05.251210 [debug] [MainThread]: Command `dbt run` succeeded at 15:01:05.250874 after 4.31 seconds
[0m15:01:05.253915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c4dc4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c1b7d030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52c3d1ae30>]}
[0m15:01:05.257562 [debug] [MainThread]: Flushing usage events
[0m15:01:06.328999 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:13:04.650462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd194d0970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd18425810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd184257b0>]}


============================== 15:13:04.660996 | 63c29aaa-d63e-4042-8e4e-3d0b9e2cbe11 ==============================
[0m15:13:04.660996 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:13:04.665477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/telegram_dbt/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select fct_image_detections --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:13:05.756996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63c29aaa-d63e-4042-8e4e-3d0b9e2cbe11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd17b4edd0>]}
[0m15:13:05.912768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63c29aaa-d63e-4042-8e4e-3d0b9e2cbe11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd18cc0d30>]}
[0m15:13:05.917922 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:13:06.300158 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:13:07.130290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:13:07.132498 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:13:07.268080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63c29aaa-d63e-4042-8e4e-3d0b9e2cbe11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd16764130>]}
[0m15:13:07.548748 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m15:13:07.565237 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m15:13:07.675410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63c29aaa-d63e-4042-8e4e-3d0b9e2cbe11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd16766230>]}
[0m15:13:07.677961 [info ] [MainThread]: Found 5 models, 8 data tests, 2 sources, 434 macros
[0m15:13:07.682757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63c29aaa-d63e-4042-8e4e-3d0b9e2cbe11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd167661a0>]}
[0m15:13:07.690739 [info ] [MainThread]: 
[0m15:13:07.695168 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:13:07.706488 [info ] [MainThread]: 
[0m15:13:07.711140 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:13:07.716364 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m15:13:08.829004 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m15:13:08.831768 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m15:13:08.834422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:08.891601 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.057 seconds
[0m15:13:08.896456 [debug] [ThreadPool]: On list_telegram_db: Close
[0m15:13:08.911933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db, now list_telegram_db_raw_analytics)
[0m15:13:08.928366 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m15:13:08.930850 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: BEGIN
[0m15:13:08.933253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:08.947871 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m15:13:08.950131 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m15:13:08.952452 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_analytics'
  
[0m15:13:09.262740 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.304 seconds
[0m15:13:09.277061 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: ROLLBACK
[0m15:13:09.283434 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: Close
[0m15:13:09.291546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db_raw_analytics, now list_telegram_db_raw_staging)
[0m15:13:09.306889 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m15:13:09.309918 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m15:13:09.312690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:09.331141 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m15:13:09.333617 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m15:13:09.336174 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m15:13:09.344816 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m15:13:09.349745 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m15:13:09.352642 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m15:13:09.370743 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:09.373704 [debug] [MainThread]: On master: BEGIN
[0m15:13:09.376663 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:13:09.395248 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m15:13:09.397942 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:09.400447 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:13:09.419501 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m15:13:09.424783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63c29aaa-d63e-4042-8e4e-3d0b9e2cbe11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd16be7730>]}
[0m15:13:09.431546 [debug] [MainThread]: On master: ROLLBACK
[0m15:13:09.435197 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:09.437719 [debug] [MainThread]: On master: BEGIN
[0m15:13:09.440890 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:13:09.443081 [debug] [MainThread]: On master: COMMIT
[0m15:13:09.445403 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:09.447422 [debug] [MainThread]: On master: COMMIT
[0m15:13:09.449777 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:13:09.452116 [debug] [MainThread]: On master: Close
[0m15:13:09.541315 [debug] [Thread-1 (]: Began running node model.telegram_dbt.fct_image_detections
[0m15:13:09.544966 [info ] [Thread-1 (]: 1 of 1 START sql incremental model raw_analytics.fct_image_detections .......... [RUN]
[0m15:13:09.548601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_db_raw_staging, now model.telegram_dbt.fct_image_detections)
[0m15:13:09.551643 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.fct_image_detections
[0m15:13:09.596892 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.fct_image_detections"
[0m15:13:09.614667 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.fct_image_detections
[0m15:13:09.737960 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.fct_image_detections"
[0m15:13:09.758516 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m15:13:09.761809 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: BEGIN
[0m15:13:09.764793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:09.786946 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m15:13:09.789610 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m15:13:09.792607 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_image_detections"} */

      
  
    

  create  table "telegram_db"."raw_analytics"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    d.id AS detection_id,
    d.message_id,
    m.channel_id,
    m.date_day AS date,
    d.object_class,
    d.confidence
FROM "telegram_db"."raw"."image_detections" d
LEFT JOIN "telegram_db"."raw_analytics"."fct_messages" m
    ON d.message_id = m.message_id


  );
  
  
[0m15:13:10.079795 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.284 seconds
[0m15:13:10.134939 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m15:13:10.137501 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_image_detections"} */
alter table "telegram_db"."raw_analytics"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m15:13:10.140705 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:13:10.148607 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m15:13:10.150944 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_image_detections"} */
alter table "telegram_db"."raw_analytics"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m15:13:10.154020 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:13:10.190889 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: COMMIT
[0m15:13:10.193261 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m15:13:10.195406 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: COMMIT
[0m15:13:10.250413 [debug] [Thread-1 (]: SQL status: COMMIT in 0.053 seconds
[0m15:13:10.265627 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."fct_image_detections__dbt_backup"
[0m15:13:10.275886 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m15:13:10.278229 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_image_detections"} */
drop table if exists "telegram_db"."raw_analytics"."fct_image_detections__dbt_backup" cascade
[0m15:13:10.417955 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.137 seconds
[0m15:13:10.423996 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: Close
[0m15:13:10.611157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c29aaa-d63e-4042-8e4e-3d0b9e2cbe11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd15585840>]}
[0m15:13:10.614188 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model raw_analytics.fct_image_detections ..... [[32mSELECT 0[0m in 1.06s]
[0m15:13:10.620224 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.fct_image_detections
[0m15:13:10.626731 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:10.629231 [debug] [MainThread]: On master: BEGIN
[0m15:13:10.631349 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:13:10.647896 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m15:13:10.650475 [debug] [MainThread]: On master: COMMIT
[0m15:13:10.653019 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:10.658481 [debug] [MainThread]: On master: COMMIT
[0m15:13:10.661067 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:13:10.662876 [debug] [MainThread]: On master: Close
[0m15:13:10.781207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:10.784436 [debug] [MainThread]: Connection 'model.telegram_dbt.fct_image_detections' was properly closed.
[0m15:13:10.787126 [info ] [MainThread]: 
[0m15:13:10.792195 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.08 seconds (3.08s).
[0m15:13:10.800559 [debug] [MainThread]: Command end result
[0m15:13:10.949443 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m15:13:10.964943 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m15:13:11.001713 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/telegram_dbt/target/run_results.json
[0m15:13:11.004701 [info ] [MainThread]: 
[0m15:13:11.009093 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:11.013532 [info ] [MainThread]: 
[0m15:13:11.017721 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:13:11.174427 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.7390146, "process_in_blocks": "88568", "process_kernel_time": 0.492488, "process_mem_max_rss": "121400", "process_out_blocks": "0", "process_user_time": 6.070459}
[0m15:13:11.176823 [debug] [MainThread]: Command `dbt run` succeeded at 15:13:11.176530 after 6.74 seconds
[0m15:13:11.178969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd194d0970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd1af36b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd177d5b10>]}
[0m15:13:11.181113 [debug] [MainThread]: Flushing usage events
[0m15:13:12.320458 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:30:16.733219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7f7b78880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7f6aeae60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7f6aeaec0>]}


============================== 16:30:16.968559 | ff70fcd3-fd6f-4982-b665-0a5c3659e164 ==============================
[0m16:30:16.968559 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:30:16.976373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/app/dbt/telegram_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_image_detections', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:30:18.668514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff70fcd3-fd6f-4982-b665-0a5c3659e164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7f6aeae30>]}
[0m16:30:19.336677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff70fcd3-fd6f-4982-b665-0a5c3659e164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7f6e69180>]}
[0m16:30:19.400269 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:30:20.462165 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:30:21.263406 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:30:21.269810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ff70fcd3-fd6f-4982-b665-0a5c3659e164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7f73127d0>]}
[0m16:30:26.130639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff70fcd3-fd6f-4982-b665-0a5c3659e164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7f41effa0>]}
[0m16:30:26.497186 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m16:30:26.509824 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m16:30:26.581435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff70fcd3-fd6f-4982-b665-0a5c3659e164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7efb13520>]}
[0m16:30:26.584106 [info ] [MainThread]: Found 5 models, 8 data tests, 2 sources, 434 macros
[0m16:30:26.587353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff70fcd3-fd6f-4982-b665-0a5c3659e164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7efb134c0>]}
[0m16:30:26.593359 [info ] [MainThread]: 
[0m16:30:26.596703 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:30:26.599738 [info ] [MainThread]: 
[0m16:30:26.611110 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:30:26.620422 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m16:30:27.078509 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m16:30:27.081124 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m16:30:27.083398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:27.159442 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.076 seconds
[0m16:30:27.164665 [debug] [ThreadPool]: On list_telegram_db: Close
[0m16:30:27.185646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db, now list_telegram_db_raw_staging)
[0m16:30:27.213191 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m16:30:27.215542 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m16:30:27.217785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:27.235063 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m16:30:27.237438 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m16:30:27.239599 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m16:30:27.277587 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.035 seconds
[0m16:30:27.282720 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m16:30:27.287899 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m16:30:27.290469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db_raw_staging, now list_telegram_db_raw_analytics)
[0m16:30:27.298591 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m16:30:27.300424 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: BEGIN
[0m16:30:27.302064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:27.314807 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m16:30:27.316658 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m16:30:27.318568 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_analytics'
  
[0m16:30:27.324900 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m16:30:27.328385 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: ROLLBACK
[0m16:30:27.330261 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: Close
[0m16:30:27.343857 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:27.345670 [debug] [MainThread]: On master: BEGIN
[0m16:30:27.347706 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:30:27.365035 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m16:30:27.370677 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:27.374493 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:30:27.452142 [debug] [MainThread]: SQL status: SELECT 1 in 0.074 seconds
[0m16:30:27.456330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff70fcd3-fd6f-4982-b665-0a5c3659e164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7efb13b80>]}
[0m16:30:27.458904 [debug] [MainThread]: On master: ROLLBACK
[0m16:30:27.461635 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:27.464092 [debug] [MainThread]: On master: BEGIN
[0m16:30:27.467331 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:30:27.469486 [debug] [MainThread]: On master: COMMIT
[0m16:30:27.471657 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:27.473880 [debug] [MainThread]: On master: COMMIT
[0m16:30:27.476298 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:30:27.478404 [debug] [MainThread]: On master: Close
[0m16:30:27.502010 [debug] [Thread-1 (]: Began running node model.telegram_dbt.fct_image_detections
[0m16:30:27.505897 [info ] [Thread-1 (]: 1 of 1 START sql incremental model raw_analytics.fct_image_detections .......... [RUN]
[0m16:30:27.510932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_db_raw_analytics, now model.telegram_dbt.fct_image_detections)
[0m16:30:27.516154 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.fct_image_detections
[0m16:30:27.558250 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.fct_image_detections"
[0m16:30:27.647427 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.fct_image_detections
[0m16:30:27.839416 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m16:30:27.841813 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_image_detections"} */

    
  
    

  create temporary table "fct_image_detections__dbt_tmp163027770356"
  
  
    as
  
  (
    

SELECT
    d.id AS detection_id,
    d.message_id,
    m.channel_id,
    m.date_day AS date,
    d.object_class,
    d.confidence
FROM "telegram_db"."raw"."image_detections" d
LEFT JOIN "telegram_db"."raw_analytics"."fct_messages" m
    ON d.message_id = m.message_id


WHERE d.id > (SELECT MAX(detection_id) FROM "telegram_db"."raw_analytics"."fct_image_detections")

  );
  
  
[0m16:30:27.843898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:27.909225 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.065 seconds
[0m16:30:27.956544 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m16:30:27.959272 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: BEGIN
[0m16:30:27.962790 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m16:30:27.965583 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m16:30:27.968772 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_image_detections"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_image_detections__dbt_tmp163027770356'
        
      order by ordinal_position

  
[0m16:30:28.022124 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.051 seconds
[0m16:30:28.035750 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m16:30:28.038272 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_image_detections"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "telegram_db".INFORMATION_SCHEMA.columns
      where table_name = 'fct_image_detections'
        
        and table_schema = 'raw_analytics'
        
      order by ordinal_position

  
[0m16:30:28.045625 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.005 seconds
[0m16:30:28.064567 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m16:30:28.066614 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_image_detections"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "telegram_db".INFORMATION_SCHEMA.columns
      where table_name = 'fct_image_detections'
        
        and table_schema = 'raw_analytics'
        
      order by ordinal_position

  
[0m16:30:28.072171 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m16:30:28.108608 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.fct_image_detections"
[0m16:30:28.121278 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m16:30:28.124288 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_image_detections"} */

      
        
        
        delete from "telegram_db"."raw_analytics"."fct_image_detections" as DBT_INTERNAL_DEST
        where (detection_id) in (
            select distinct detection_id
            from "fct_image_detections__dbt_tmp163027770356" as DBT_INTERNAL_SOURCE
        );

    

    insert into "telegram_db"."raw_analytics"."fct_image_detections" ("detection_id", "message_id", "channel_id", "date", "object_class", "confidence")
    (
        select "detection_id", "message_id", "channel_id", "date", "object_class", "confidence"
        from "fct_image_detections__dbt_tmp163027770356"
    )
  
[0m16:30:28.128803 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m16:30:28.219876 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: COMMIT
[0m16:30:28.356954 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m16:30:28.359383 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: COMMIT
[0m16:30:28.367940 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m16:30:28.373944 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: Close
[0m16:30:28.509133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff70fcd3-fd6f-4982-b665-0a5c3659e164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7f935cb20>]}
[0m16:30:28.513348 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model raw_analytics.fct_image_detections ..... [[32mINSERT 0 0[0m in 0.87s]
[0m16:30:28.520489 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.fct_image_detections
[0m16:30:28.527690 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:28.530499 [debug] [MainThread]: On master: BEGIN
[0m16:30:28.533173 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:30:28.552137 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m16:30:28.559509 [debug] [MainThread]: On master: COMMIT
[0m16:30:28.561738 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:28.564226 [debug] [MainThread]: On master: COMMIT
[0m16:30:28.567097 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:30:28.569551 [debug] [MainThread]: On master: Close
[0m16:30:28.573893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:30:28.575991 [debug] [MainThread]: Connection 'model.telegram_dbt.fct_image_detections' was properly closed.
[0m16:30:28.578410 [info ] [MainThread]: 
[0m16:30:28.582528 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m16:30:28.587411 [debug] [MainThread]: Command end result
[0m16:30:28.691852 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m16:30:28.702157 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m16:30:29.031824 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/telegram_dbt/target/run_results.json
[0m16:30:29.035526 [info ] [MainThread]: 
[0m16:30:29.039929 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:30:29.046033 [info ] [MainThread]: 
[0m16:30:29.050738 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:30:29.355217 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.31053, "process_in_blocks": "40968", "process_kernel_time": 0.919732, "process_mem_max_rss": "130072", "process_out_blocks": "0", "process_user_time": 12.246434}
[0m16:30:29.360734 [debug] [MainThread]: Command `dbt run` succeeded at 16:30:29.360269 after 13.32 seconds
[0m16:30:29.363995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7f7b78880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7f7a0cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7f41d0ee0>]}
[0m16:30:29.367286 [debug] [MainThread]: Flushing usage events
[0m16:30:30.657032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:42:00.774650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e285d88b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e2753ee60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e2753eec0>]}


============================== 16:42:00.788531 | 7f3ab508-ceed-4a27-aa43-e5ddbd57b602 ==============================
[0m16:42:00.788531 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:42:00.792855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/dbt/telegram_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select fct_image_detections --full-refresh', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:42:01.764423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f3ab508-ceed-4a27-aa43-e5ddbd57b602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e2753ee30>]}
[0m16:42:01.898520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f3ab508-ceed-4a27-aa43-e5ddbd57b602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e27d6eda0>]}
[0m16:42:02.069602 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:42:02.589712 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:42:03.538953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:42:03.541285 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:42:03.690795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f3ab508-ceed-4a27-aa43-e5ddbd57b602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e25584130>]}
[0m16:42:03.986186 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m16:42:03.998725 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m16:42:04.104925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f3ab508-ceed-4a27-aa43-e5ddbd57b602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e255041c0>]}
[0m16:42:04.108068 [info ] [MainThread]: Found 5 models, 8 data tests, 2 sources, 434 macros
[0m16:42:04.111480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f3ab508-ceed-4a27-aa43-e5ddbd57b602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e25507970>]}
[0m16:42:04.118864 [info ] [MainThread]: 
[0m16:42:04.122956 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:42:04.129365 [info ] [MainThread]: 
[0m16:42:04.138915 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:42:04.143039 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m16:42:04.421035 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m16:42:04.423625 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m16:42:04.426090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:04.486612 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.061 seconds
[0m16:42:04.491405 [debug] [ThreadPool]: On list_telegram_db: Close
[0m16:42:04.504834 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db, now list_telegram_db_raw_staging)
[0m16:42:04.520313 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m16:42:04.522796 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m16:42:04.525043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:04.542489 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m16:42:04.545003 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m16:42:04.547464 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m16:42:04.679425 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.129 seconds
[0m16:42:04.685599 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m16:42:04.689953 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m16:42:04.694403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db_raw_staging, now list_telegram_db_raw_analytics)
[0m16:42:04.702225 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m16:42:04.704302 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: BEGIN
[0m16:42:04.706289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:04.721295 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m16:42:04.723388 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m16:42:04.725399 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_analytics'
  
[0m16:42:04.736548 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m16:42:04.740211 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: ROLLBACK
[0m16:42:04.742726 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: Close
[0m16:42:04.756589 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:04.758987 [debug] [MainThread]: On master: BEGIN
[0m16:42:04.822352 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:42:04.869553 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m16:42:04.874408 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:04.877493 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:42:04.905960 [debug] [MainThread]: SQL status: SELECT 1 in 0.025 seconds
[0m16:42:04.909793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f3ab508-ceed-4a27-aa43-e5ddbd57b602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e25533970>]}
[0m16:42:04.912289 [debug] [MainThread]: On master: ROLLBACK
[0m16:42:04.915093 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:04.917333 [debug] [MainThread]: On master: BEGIN
[0m16:42:04.920368 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:42:04.922602 [debug] [MainThread]: On master: COMMIT
[0m16:42:04.924967 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:04.927250 [debug] [MainThread]: On master: COMMIT
[0m16:42:04.929853 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:42:04.931985 [debug] [MainThread]: On master: Close
[0m16:42:04.945113 [debug] [Thread-1 (]: Began running node model.telegram_dbt.fct_image_detections
[0m16:42:04.947584 [info ] [Thread-1 (]: 1 of 1 START sql incremental model raw_analytics.fct_image_detections .......... [RUN]
[0m16:42:04.956009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_db_raw_analytics, now model.telegram_dbt.fct_image_detections)
[0m16:42:04.959600 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.fct_image_detections
[0m16:42:05.012896 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.fct_image_detections"
[0m16:42:05.032293 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.fct_image_detections
[0m16:42:05.190155 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.fct_image_detections"
[0m16:42:05.201251 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m16:42:05.203167 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: BEGIN
[0m16:42:05.205052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:05.218386 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:42:05.220147 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m16:42:05.221973 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_image_detections"} */

      
  
    

  create  table "telegram_db"."raw_analytics"."fct_image_detections__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    d.id AS detection_id,
    d.message_id,
    m.channel_id,
    m.date_day AS date,
    d.object_class,
    d.confidence
FROM "telegram_db"."raw"."image_detections" d
LEFT JOIN "telegram_db"."raw_analytics"."fct_messages" m
    ON d.message_id = m.message_id


  );
  
  
[0m16:42:05.302636 [debug] [Thread-1 (]: SQL status: SELECT 1235 in 0.078 seconds
[0m16:42:05.330361 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m16:42:05.332965 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_image_detections"} */
alter table "telegram_db"."raw_analytics"."fct_image_detections" rename to "fct_image_detections__dbt_backup"
[0m16:42:05.337714 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:42:05.345437 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m16:42:05.347561 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_image_detections"} */
alter table "telegram_db"."raw_analytics"."fct_image_detections__dbt_tmp" rename to "fct_image_detections"
[0m16:42:05.349958 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:42:05.398442 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: COMMIT
[0m16:42:05.400654 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m16:42:05.402911 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: COMMIT
[0m16:42:05.414776 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m16:42:05.429415 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."fct_image_detections__dbt_backup"
[0m16:42:05.439782 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_image_detections"
[0m16:42:05.441783 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_image_detections"} */
drop table if exists "telegram_db"."raw_analytics"."fct_image_detections__dbt_backup" cascade
[0m16:42:05.603550 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.160 seconds
[0m16:42:05.610212 [debug] [Thread-1 (]: On model.telegram_dbt.fct_image_detections: Close
[0m16:42:05.619627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f3ab508-ceed-4a27-aa43-e5ddbd57b602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e246a5ba0>]}
[0m16:42:05.622838 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model raw_analytics.fct_image_detections ..... [[32mSELECT 1235[0m in 0.66s]
[0m16:42:05.630641 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.fct_image_detections
[0m16:42:05.635557 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:05.637891 [debug] [MainThread]: On master: BEGIN
[0m16:42:05.640372 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:42:05.656647 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m16:42:05.658885 [debug] [MainThread]: On master: COMMIT
[0m16:42:05.663967 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:05.666689 [debug] [MainThread]: On master: COMMIT
[0m16:42:05.669977 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:42:05.672303 [debug] [MainThread]: On master: Close
[0m16:42:05.675595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:05.678426 [debug] [MainThread]: Connection 'model.telegram_dbt.fct_image_detections' was properly closed.
[0m16:42:05.681522 [info ] [MainThread]: 
[0m16:42:05.684554 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m16:42:05.689798 [debug] [MainThread]: Command end result
[0m16:42:05.853098 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m16:42:05.863592 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m16:42:05.886244 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/telegram_dbt/target/run_results.json
[0m16:42:05.888420 [info ] [MainThread]: 
[0m16:42:05.893660 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:42:05.897263 [info ] [MainThread]: 
[0m16:42:05.900706 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:42:06.024684 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.4587326, "process_in_blocks": "71888", "process_kernel_time": 0.824283, "process_mem_max_rss": "119164", "process_out_blocks": "0", "process_user_time": 6.037878}
[0m16:42:06.033876 [debug] [MainThread]: Command `dbt run` succeeded at 16:42:06.033075 after 5.47 seconds
[0m16:42:06.039132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e285d88b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e25587d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e28470ac0>]}
[0m16:42:06.043002 [debug] [MainThread]: Flushing usage events
[0m16:42:07.148097 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:10:48.365367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d3420b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d2397d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d2397fa0>]}


============================== 19:10:48.448264 | 36e2a983-7334-4e6c-993e-d36a555326e6 ==============================
[0m19:10:48.448264 [info ] [MainThread]: Running with dbt=1.10.4
[0m19:10:48.454005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/telegram_dbt/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select fct_messages --full-refresh', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:10:50.759961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36e2a983-7334-4e6c-993e-d36a555326e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d4e90670>]}
[0m19:10:51.480698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36e2a983-7334-4e6c-993e-d36a555326e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d32cad10>]}
[0m19:10:51.484779 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:10:52.828386 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m19:10:55.634219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:10:55.636822 [debug] [MainThread]: Partial parsing: updated file: telegram_dbt://models/marts/fct_messages.sql
[0m19:11:04.264909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36e2a983-7334-4e6c-993e-d36a555326e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cfea8100>]}
[0m19:11:05.962583 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m19:11:06.054706 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m19:11:06.279650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36e2a983-7334-4e6c-993e-d36a555326e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cf565390>]}
[0m19:11:06.298233 [info ] [MainThread]: Found 5 models, 8 data tests, 2 sources, 434 macros
[0m19:11:06.302060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36e2a983-7334-4e6c-993e-d36a555326e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71cf5653f0>]}
[0m19:11:06.311198 [info ] [MainThread]: 
[0m19:11:06.314958 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:11:06.322833 [info ] [MainThread]: 
[0m19:11:06.328852 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:11:06.425643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m19:11:07.409431 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m19:11:07.414672 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m19:11:07.418284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:11:07.522407 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.104 seconds
[0m19:11:07.530439 [debug] [ThreadPool]: On list_telegram_db: Close
[0m19:11:07.569161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db, now list_telegram_db_raw_staging)
[0m19:11:07.607684 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m19:11:07.610513 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m19:11:07.613458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:11:07.756134 [debug] [ThreadPool]: SQL status: BEGIN in 0.143 seconds
[0m19:11:07.758975 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m19:11:07.762702 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m19:11:07.842412 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.072 seconds
[0m19:11:07.846479 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m19:11:07.849281 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m19:11:07.852729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db_raw_staging, now list_telegram_db_raw_analytics)
[0m19:11:07.862297 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m19:11:07.864865 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: BEGIN
[0m19:11:07.867372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:11:07.888304 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m19:11:07.890418 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m19:11:07.892967 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_analytics'
  
[0m19:11:07.914827 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.018 seconds
[0m19:11:07.918767 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: ROLLBACK
[0m19:11:07.921166 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: Close
[0m19:11:07.940138 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:07.942563 [debug] [MainThread]: On master: BEGIN
[0m19:11:07.945138 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:11:07.960528 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m19:11:07.963232 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:07.966113 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:11:08.133266 [debug] [MainThread]: SQL status: SELECT 1 in 0.164 seconds
[0m19:11:08.138910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36e2a983-7334-4e6c-993e-d36a555326e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d4cb0d90>]}
[0m19:11:08.141853 [debug] [MainThread]: On master: ROLLBACK
[0m19:11:08.144683 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:08.163021 [debug] [MainThread]: On master: BEGIN
[0m19:11:08.170728 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:11:08.173418 [debug] [MainThread]: On master: COMMIT
[0m19:11:08.176035 [debug] [MainThread]: Using postgres connection "master"
[0m19:11:08.179737 [debug] [MainThread]: On master: COMMIT
[0m19:11:08.183219 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:11:08.186726 [debug] [MainThread]: On master: Close
[0m19:11:08.300599 [debug] [Thread-1 (]: Began running node model.telegram_dbt.fct_messages
[0m19:11:08.308569 [info ] [Thread-1 (]: 1 of 1 START sql table model raw_analytics.fct_messages ........................ [RUN]
[0m19:11:08.319193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_db_raw_analytics, now model.telegram_dbt.fct_messages)
[0m19:11:08.323083 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.fct_messages
[0m19:11:08.396503 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.fct_messages"
[0m19:11:08.485711 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.fct_messages
[0m19:11:08.797072 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.fct_messages"
[0m19:11:08.915145 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m19:11:08.919174 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: BEGIN
[0m19:11:08.921586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:11:08.959104 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m19:11:08.964838 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m19:11:08.972956 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */

  
    

  create  table "telegram_db"."raw_analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fct_messages.sql

with messages as (
    select * from "telegram_db"."raw_staging"."stg_telegram_messages"
),

fct as (
    select
        md5(channel_name) as channel_id,
        message_date::date as date_day,
        message_id,
        message_text,
        length(message_text) as message_length,
        has_media,
        media_type
    from messages
)
 
select * from fct
  );
  
[0m19:11:10.433757 [debug] [Thread-1 (]: SQL status: SELECT 483 in 1.458 seconds
[0m19:11:10.490203 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m19:11:10.493369 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
alter table "telegram_db"."raw_analytics"."fct_messages" rename to "fct_messages__dbt_backup"
[0m19:16:52.269954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c1f2788b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c1e1c9720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c1e1c96c0>]}


============================== 19:16:52.288144 | 5fa60168-f55d-4fa5-8581-99a003bf0bd6 ==============================
[0m19:16:52.288144 [info ] [MainThread]: Running with dbt=1.10.4
[0m19:16:52.292282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/app/dbt/telegram_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_messages --full-refresh', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:16:59.559652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fa60168-f55d-4fa5-8581-99a003bf0bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c20cd8580>]}
[0m19:17:00.468334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fa60168-f55d-4fa5-8581-99a003bf0bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c1e18f340>]}
[0m19:17:00.471987 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:17:01.726128 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m19:17:05.053247 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:17:05.058733 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:17:05.680185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fa60168-f55d-4fa5-8581-99a003bf0bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c1c5bc130>]}
[0m19:17:09.260713 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m19:17:09.392465 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m19:17:09.932096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fa60168-f55d-4fa5-8581-99a003bf0bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c1c9f1780>]}
[0m19:17:09.934909 [info ] [MainThread]: Found 5 models, 8 data tests, 2 sources, 434 macros
[0m19:17:09.942055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fa60168-f55d-4fa5-8581-99a003bf0bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c1c9f17b0>]}
[0m19:17:09.959167 [info ] [MainThread]: 
[0m19:17:09.967849 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:17:09.972604 [info ] [MainThread]: 
[0m19:17:09.979086 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:17:10.012761 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m19:17:13.725936 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m19:17:13.731527 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m19:17:13.743290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:15.894611 [debug] [ThreadPool]: SQL status: SELECT 11 in 2.151 seconds
[0m19:17:15.912944 [debug] [ThreadPool]: On list_telegram_db: Close
[0m19:17:15.950531 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db, now list_telegram_db_raw_staging)
[0m19:17:16.321560 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m19:17:16.326631 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m19:17:16.332236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:17:16.838890 [debug] [ThreadPool]: SQL status: BEGIN in 0.507 seconds
[0m19:17:16.842429 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m19:17:16.846418 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m19:17:17.137376 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.288 seconds
[0m19:17:17.143142 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m19:17:17.145834 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m19:17:17.152084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db_raw_staging, now list_telegram_db_raw_analytics)
[0m19:17:17.166267 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m19:17:17.168859 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: BEGIN
[0m19:17:17.171075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:17:17.719180 [debug] [ThreadPool]: SQL status: BEGIN in 0.548 seconds
[0m19:17:17.724353 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m19:17:17.735621 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_analytics'
  
[0m19:17:17.748797 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m19:17:17.753754 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: ROLLBACK
[0m19:17:17.756389 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: Close
[0m19:17:17.922517 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:17.924922 [debug] [MainThread]: On master: BEGIN
[0m19:17:17.927805 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:17:18.352419 [debug] [MainThread]: SQL status: BEGIN in 0.424 seconds
[0m19:17:18.356574 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:18.365827 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:17:20.775083 [debug] [MainThread]: SQL status: SELECT 1 in 2.401 seconds
[0m19:17:20.788701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fa60168-f55d-4fa5-8581-99a003bf0bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c20af7f10>]}
[0m19:17:20.823614 [debug] [MainThread]: On master: ROLLBACK
[0m19:17:20.827251 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:20.830098 [debug] [MainThread]: On master: BEGIN
[0m19:17:20.860347 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:17:20.899042 [debug] [MainThread]: On master: COMMIT
[0m19:17:20.921612 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:20.928135 [debug] [MainThread]: On master: COMMIT
[0m19:17:20.933857 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:17:20.939285 [debug] [MainThread]: On master: Close
[0m19:17:21.156332 [debug] [Thread-1 (]: Began running node model.telegram_dbt.fct_messages
[0m19:17:21.159964 [info ] [Thread-1 (]: 1 of 1 START sql table model raw_analytics.fct_messages ........................ [RUN]
[0m19:17:21.163311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_db_raw_analytics, now model.telegram_dbt.fct_messages)
[0m19:17:21.165875 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.fct_messages
[0m19:17:21.242490 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.fct_messages"
[0m19:17:21.270910 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.fct_messages
[0m19:17:21.676901 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.fct_messages"
[0m19:17:21.715311 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m19:17:21.718320 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: BEGIN
[0m19:17:21.721274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:21.978709 [debug] [Thread-1 (]: SQL status: BEGIN in 0.257 seconds
[0m19:17:21.981120 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m19:17:21.984255 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */

  
    

  create  table "telegram_db"."raw_analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fct_messages.sql

with messages as (
    select * from "telegram_db"."raw_staging"."stg_telegram_messages"
),

fct as (
    select
        md5(channel_name) as channel_id,
        message_date::date as date_day,
        message_id,
        message_text,
        length(message_text) as message_length,
        has_media,
        media_type
    from messages
)
 
select * from fct
  );
  
[0m19:23:00.255805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 709.858 seconds
[0m19:23:00.655214 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m19:23:00.672883 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
alter table "telegram_db"."raw_analytics"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m19:23:00.690605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:23:01.088533 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: COMMIT
[0m19:23:01.302834 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m19:23:01.368231 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: COMMIT
[0m19:23:01.778791 [debug] [Thread-1 (]: SQL status: COMMIT in 0.344 seconds
[0m19:23:02.066481 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."fct_messages__dbt_backup"
[0m19:23:02.138065 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m19:23:02.179941 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
drop table if exists "telegram_db"."raw_analytics"."fct_messages__dbt_backup" cascade
[0m19:23:03.264732 [debug] [Thread-1 (]: SQL status: SELECT 483 in 341.328 seconds
[0m19:23:03.366377 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m19:23:03.369702 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
alter table "telegram_db"."raw_analytics"."fct_messages" rename to "fct_messages__dbt_backup"
[0m19:23:03.448037 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.073 seconds
[0m19:23:03.475313 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m19:23:03.478003 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
alter table "telegram_db"."raw_analytics"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m19:23:03.481242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:23:03.467056 [debug] [Thread-1 (]: SQL status: DROP TABLE in 1.248 seconds
[0m19:23:03.501193 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: Close
[0m19:23:03.676346 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: COMMIT
[0m19:23:03.681577 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m19:23:03.694491 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: COMMIT
[0m19:23:03.696564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36e2a983-7334-4e6c-993e-d36a555326e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71ce9559c0>]}
[0m19:23:03.713094 [info ] [Thread-1 (]: 1 of 1 OK created sql table model raw_analytics.fct_messages ................... [[32mSELECT 483[0m in 715.37s]
[0m19:23:03.717899 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.fct_messages
[0m19:23:03.727721 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:03.730330 [debug] [MainThread]: On master: BEGIN
[0m19:23:03.730883 [debug] [Thread-1 (]: SQL status: COMMIT in 0.033 seconds
[0m19:23:03.743336 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:23:03.808555 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."fct_messages__dbt_backup"
[0m19:23:03.964877 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m19:23:03.981943 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
drop table if exists "telegram_db"."raw_analytics"."fct_messages__dbt_backup" cascade
[0m19:23:04.343886 [debug] [MainThread]: SQL status: BEGIN in 0.601 seconds
[0m19:23:04.360023 [debug] [MainThread]: On master: COMMIT
[0m19:23:04.385772 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:04.388461 [debug] [MainThread]: On master: COMMIT
[0m19:23:04.393767 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:23:04.409671 [debug] [MainThread]: On master: Close
[0m19:23:04.692260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:04.697225 [debug] [MainThread]: Connection 'model.telegram_dbt.fct_messages' was properly closed.
[0m19:23:04.700655 [info ] [MainThread]: 
[0m19:23:04.704329 [info ] [MainThread]: Finished running 1 table model in 0 hours 11 minutes and 58.37 seconds (718.37s).
[0m19:23:04.710791 [debug] [MainThread]: Command end result
[0m19:23:05.316410 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m19:23:05.359475 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m19:23:05.492933 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/telegram_dbt/target/run_results.json
[0m19:23:05.497540 [info ] [MainThread]: 
[0m19:23:05.524913 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:23:05.538903 [info ] [MainThread]: 
[0m19:23:05.585896 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:23:05.637079 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 737.99664, "process_in_blocks": "4728", "process_kernel_time": 21.221909, "process_mem_max_rss": "128188", "process_out_blocks": "864", "process_user_time": 23.767311}
[0m19:23:05.644439 [debug] [MainThread]: Command `dbt run` succeeded at 19:23:05.644067 after 738.00 seconds
[0m19:23:05.653000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d3420b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d40e3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d07d6dd0>]}
[0m19:23:05.659647 [debug] [MainThread]: Flushing usage events
[0m19:23:07.146511 [debug] [Thread-1 (]: SQL status: DROP TABLE in 3.131 seconds
[0m19:23:07.203113 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: Close
[0m19:23:07.266703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fa60168-f55d-4fa5-8581-99a003bf0bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c20a38b50>]}
[0m19:23:08.445302 [info ] [Thread-1 (]: 1 of 1 OK created sql table model raw_analytics.fct_messages ................... [[32mSELECT 483[0m in 346.10s]
[0m19:23:08.658957 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.fct_messages
[0m19:23:09.220799 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:09.577876 [debug] [MainThread]: On master: BEGIN
[0m19:23:10.112556 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:23:10.432179 [debug] [MainThread]: SQL status: BEGIN in 0.320 seconds
[0m19:23:10.739600 [debug] [MainThread]: On master: COMMIT
[0m19:23:11.017113 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:11.422762 [debug] [MainThread]: On master: COMMIT
[0m19:23:11.444467 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:23:11.448923 [debug] [MainThread]: On master: Close
[0m19:23:11.466428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:11.486840 [debug] [MainThread]: Connection 'model.telegram_dbt.fct_messages' was properly closed.
[0m19:23:11.490271 [info ] [MainThread]: 
[0m19:23:11.510133 [info ] [MainThread]: Finished running 1 table model in 0 hours 6 minutes and 1.51 seconds (361.51s).
[0m19:23:11.622594 [debug] [MainThread]: Command end result
[0m19:23:11.830453 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:23:12.813916 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m19:23:12.862601 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m19:23:13.208526 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/telegram_dbt/target/run_results.json
[0m19:23:13.258166 [info ] [MainThread]: 
[0m19:23:13.271812 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:23:13.306605 [info ] [MainThread]: 
[0m19:23:13.386989 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:23:13.408868 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 383.57697, "process_in_blocks": "3968", "process_kernel_time": 23.674023, "process_mem_max_rss": "120864", "process_out_blocks": "0", "process_user_time": 28.26308}
[0m19:23:13.423166 [debug] [MainThread]: Command `dbt run` succeeded at 19:23:13.422726 after 383.59 seconds
[0m19:23:13.429326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c1f2788b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c20cd8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c1f108ac0>]}
[0m19:23:13.439273 [debug] [MainThread]: Flushing usage events
[0m19:23:17.268385 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:50:53.044573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f792c4dcc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f792b46fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f792b46fd90>]}


============================== 19:50:53.074732 | d626ecba-8daf-41cf-9e56-9a23ee2ba7f9 ==============================
[0m19:50:53.074732 [info ] [MainThread]: Running with dbt=1.10.4
[0m19:50:53.082492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt/telegram_dbt/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_messages --full-refresh', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:50:56.004995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd626ecba-8daf-41cf-9e56-9a23ee2ba7f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f792a735de0>]}
[0m19:50:56.406477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd626ecba-8daf-41cf-9e56-9a23ee2ba7f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f792b46dab0>]}
[0m19:50:56.524290 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:50:57.123128 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m19:51:00.672516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:51:00.682984 [debug] [MainThread]: Partial parsing: updated file: telegram_dbt://models/marts/fct_messages.sql
[0m19:51:07.301904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd626ecba-8daf-41cf-9e56-9a23ee2ba7f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7928fd0070>]}
[0m19:51:08.540554 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m19:51:08.607577 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m19:51:09.186370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd626ecba-8daf-41cf-9e56-9a23ee2ba7f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79286913c0>]}
[0m19:51:09.193357 [info ] [MainThread]: Found 5 models, 8 data tests, 2 sources, 434 macros
[0m19:51:09.196228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd626ecba-8daf-41cf-9e56-9a23ee2ba7f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7928691420>]}
[0m19:51:09.206466 [info ] [MainThread]: 
[0m19:51:09.212308 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:51:09.216743 [info ] [MainThread]: 
[0m19:51:09.220982 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:51:09.233482 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db'
[0m19:51:13.852607 [debug] [ThreadPool]: Using postgres connection "list_telegram_db"
[0m19:51:13.855196 [debug] [ThreadPool]: On list_telegram_db: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db"} */

    select distinct nspname from pg_namespace
  
[0m19:51:13.857858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:13.955067 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.097 seconds
[0m19:51:13.961036 [debug] [ThreadPool]: On list_telegram_db: Close
[0m19:51:14.055809 [debug] [ThreadPool]: Acquiring new postgres connection 'list_telegram_db_raw_staging'
[0m19:51:14.167477 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m19:51:14.180919 [debug] [ThreadPool]: On list_telegram_db_raw_staging: BEGIN
[0m19:51:14.183811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:14.329793 [debug] [ThreadPool]: SQL status: BEGIN in 0.146 seconds
[0m19:51:14.338935 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_staging"
[0m19:51:14.344395 [debug] [ThreadPool]: On list_telegram_db_raw_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_staging"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m19:51:14.721497 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.372 seconds
[0m19:51:14.731304 [debug] [ThreadPool]: On list_telegram_db_raw_staging: ROLLBACK
[0m19:51:14.734745 [debug] [ThreadPool]: On list_telegram_db_raw_staging: Close
[0m19:51:14.747345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_telegram_db_raw_staging, now list_telegram_db_raw_analytics)
[0m19:51:14.766118 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m19:51:14.770606 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: BEGIN
[0m19:51:14.778916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:14.854567 [debug] [ThreadPool]: SQL status: BEGIN in 0.081 seconds
[0m19:51:14.892973 [debug] [ThreadPool]: Using postgres connection "list_telegram_db_raw_analytics"
[0m19:51:14.897974 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "list_telegram_db_raw_analytics"} */
select
      'telegram_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_analytics'
    union all
    select
      'telegram_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_analytics'
  
[0m19:51:14.910360 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m19:51:14.920007 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: ROLLBACK
[0m19:51:14.924673 [debug] [ThreadPool]: On list_telegram_db_raw_analytics: Close
[0m19:51:14.962733 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:14.987370 [debug] [MainThread]: On master: BEGIN
[0m19:51:14.991508 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:51:15.041052 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m19:51:15.044661 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:15.056141 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:51:15.390649 [debug] [MainThread]: SQL status: SELECT 1 in 0.331 seconds
[0m19:51:15.397980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd626ecba-8daf-41cf-9e56-9a23ee2ba7f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f792b403970>]}
[0m19:51:15.403420 [debug] [MainThread]: On master: ROLLBACK
[0m19:51:15.440734 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:15.479767 [debug] [MainThread]: On master: BEGIN
[0m19:51:15.516766 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:51:15.521403 [debug] [MainThread]: On master: COMMIT
[0m19:51:15.524152 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:15.526505 [debug] [MainThread]: On master: COMMIT
[0m19:51:15.532807 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:51:15.535227 [debug] [MainThread]: On master: Close
[0m19:51:15.660866 [debug] [Thread-1 (]: Began running node model.telegram_dbt.fct_messages
[0m19:51:15.665635 [info ] [Thread-1 (]: 1 of 1 START sql table model raw_analytics.fct_messages ........................ [RUN]
[0m19:51:15.674331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_telegram_db_raw_analytics, now model.telegram_dbt.fct_messages)
[0m19:51:15.680222 [debug] [Thread-1 (]: Began compiling node model.telegram_dbt.fct_messages
[0m19:51:15.761533 [debug] [Thread-1 (]: Writing injected SQL for node "model.telegram_dbt.fct_messages"
[0m19:51:15.868887 [debug] [Thread-1 (]: Began executing node model.telegram_dbt.fct_messages
[0m19:51:16.300578 [debug] [Thread-1 (]: Writing runtime sql for node "model.telegram_dbt.fct_messages"
[0m19:51:16.501853 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m19:51:16.504749 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: BEGIN
[0m19:51:16.507644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:17.000124 [debug] [Thread-1 (]: SQL status: BEGIN in 0.493 seconds
[0m19:51:17.073055 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m19:51:17.115819 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */

  
    

  create  table "telegram_db"."raw_analytics"."fct_messages__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/fct_messages.sql

with messages as (
    select * from "telegram_db"."raw_staging"."stg_telegram_messages"
),

fct as (
    select
        channel_name,
        md5(channel_name) as channel_id,
        message_date::date as date_day,
        message_id,
        message_text,
        length(message_text) as message_length,
        has_media,
        media_type
    from messages
)
 
select * from fct
  );
  
[0m19:51:18.360016 [debug] [Thread-1 (]: SQL status: SELECT 483 in 1.242 seconds
[0m19:51:18.432149 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m19:51:18.436280 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
alter table "telegram_db"."raw_analytics"."fct_messages" rename to "fct_messages__dbt_backup"
[0m19:51:18.449452 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m19:51:18.477991 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m19:51:18.485861 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
alter table "telegram_db"."raw_analytics"."fct_messages__dbt_tmp" rename to "fct_messages"
[0m19:51:18.492017 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:51:18.688217 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: COMMIT
[0m19:51:18.705380 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m19:51:18.723479 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: COMMIT
[0m19:51:18.791198 [debug] [Thread-1 (]: SQL status: COMMIT in 0.050 seconds
[0m19:51:18.845180 [debug] [Thread-1 (]: Applying DROP to: "telegram_db"."raw_analytics"."fct_messages__dbt_backup"
[0m19:51:18.950670 [debug] [Thread-1 (]: Using postgres connection "model.telegram_dbt.fct_messages"
[0m19:51:19.000441 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "telegram_dbt", "target_name": "dev", "node_id": "model.telegram_dbt.fct_messages"} */
drop table if exists "telegram_db"."raw_analytics"."fct_messages__dbt_backup" cascade
[0m19:51:19.178007 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.151 seconds
[0m19:51:19.199054 [debug] [Thread-1 (]: On model.telegram_dbt.fct_messages: Close
[0m19:51:19.209281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd626ecba-8daf-41cf-9e56-9a23ee2ba7f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7928255ab0>]}
[0m19:51:19.229455 [info ] [Thread-1 (]: 1 of 1 OK created sql table model raw_analytics.fct_messages ................... [[32mSELECT 483[0m in 3.53s]
[0m19:51:19.235649 [debug] [Thread-1 (]: Finished running node model.telegram_dbt.fct_messages
[0m19:51:19.241807 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:19.245258 [debug] [MainThread]: On master: BEGIN
[0m19:51:19.248311 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:51:19.368925 [debug] [MainThread]: SQL status: BEGIN in 0.121 seconds
[0m19:51:19.372276 [debug] [MainThread]: On master: COMMIT
[0m19:51:19.376056 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:19.382015 [debug] [MainThread]: On master: COMMIT
[0m19:51:19.391039 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:51:19.404909 [debug] [MainThread]: On master: Close
[0m19:51:19.408308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:19.411757 [debug] [MainThread]: Connection 'list_telegram_db' was properly closed.
[0m19:51:19.439453 [debug] [MainThread]: Connection 'model.telegram_dbt.fct_messages' was properly closed.
[0m19:51:19.443603 [info ] [MainThread]: 
[0m19:51:19.455056 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.22 seconds (10.22s).
[0m19:51:19.462098 [debug] [MainThread]: Command end result
[0m19:51:20.100254 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt/telegram_dbt/target/manifest.json
[0m19:51:20.117821 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt/telegram_dbt/target/semantic_manifest.json
[0m19:51:20.171772 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt/telegram_dbt/target/run_results.json
[0m19:51:20.174408 [info ] [MainThread]: 
[0m19:51:20.178833 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:51:20.182565 [info ] [MainThread]: 
[0m19:51:20.189859 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:51:20.199819 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 27.647232, "process_in_blocks": "0", "process_kernel_time": 13.196818, "process_mem_max_rss": "124040", "process_out_blocks": "864", "process_user_time": 28.98501}
[0m19:51:20.203469 [debug] [MainThread]: Command `dbt run` succeeded at 19:51:20.203026 after 27.65 seconds
[0m19:51:20.206101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f792c4dcc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79297bafb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f792a736a10>]}
[0m19:51:20.208931 [debug] [MainThread]: Flushing usage events
[0m19:51:22.986449 [debug] [MainThread]: An error was encountered while trying to flush usage events
